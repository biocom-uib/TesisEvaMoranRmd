y=function(x){N+2*zz -2*L.b*x-sum(sqrt(n^2+2*n*beta*q*x+x^2))}
C1=rootSolve::multiroot(y,start=-100,maxiter=1000,rtol = 1e-8, atol = 1e-10, ctol = 1e-10)$root
C2=rootSolve::multiroot(y,start=100,maxiter=1000,rtol = 1e-8, atol = 1e-10, ctol = 1e-10)$root
IC=L.b-zz/c(C2,C1)
Res=rbind(c(p.val,IC))
colnames(Res)=c("p-valor","IC-inferior","IC-superior")
return(Res)
}
#Test para cociente de RR
RR.RR=function(M,conf.level=0.95){
e=M[1,]
n=colSums(M)
p=e/n
RR1=p[1]/p[2]
RR2=p[3]/p[4]
se.lnRR1=sqrt(1/e[1]+1/e[2]-1/n[1]-1/n[2])
se.lnRR2=sqrt(1/e[3]+1/e[4]-1/n[3]-1/n[4])
RRR=RR1/RR2
se.lnRRR=sqrt(se.lnRR1^2+se.lnRR2^2)
IC.1=exp(log(RRR)-se.lnRRR*qnorm((1+conf.level)/2))
IC.2=exp(log(RRR)+se.lnRRR*qnorm((1+conf.level)/2))
p.val=2-2*pnorm(abs(log(RRR))/se.lnRRR)
Res=rbind(c(RRR,p.val,IC.1,IC.2))
colnames(Res)=c("RRR", "p-valor","IC-inferior","IC-superior")
return(Res)
}
# Test para comparar OR
OR.OR=function(M,conf.level=0.95){
M1=M[,1:2]
M2=M[,3:4]
LOR1=log(fisher.test(M1)$estimate)
LOR2=log(fisher.test(M2)$estimate)
Z=abs(LOR1-LOR2)/sqrt(sum(1/M))
p.val=2*(1-pnorm(Z))
IC=exp(LOR1-LOR2+qnorm((1+conf.level)/2)*sqrt(sum(1/M))*c(-1,1))
Res=rbind(c(p.val,IC))
colnames(Res)=c("p-valor","IC-inferior","IC-superior")
return(Res)
}
# Test de tendencia
Prop.trend.test=function(x,X){
chisq.test(rbind(x,X))$p.value
}
#Tabla de RA y RR
Riesgos=function(M){
e=M[1,]
n=colSums(M)
p=e/n
RA=round(c(p[1]-p[2],p[3]-p[4]),4)
RR=round(c(p[1]/p[2],p[3]/p[4]),4)
Res=cbind(RA,RR)
rownames(Res)=c("1a ola", "2a ola")
return(Res)
}
# Tablas 2d Descripción casos-controles
Tabla.DMG=function(I,NI,L1,L2){
NA_I=length(I[is.na(I)])
NA_NI=length(NI[is.na(NI)])
EEExt=rbind(c(as.vector(table(I)),NA_I),
round(100*c(as.vector(table(I)),NA_I)/n_I,1),
c(as.vector(table(NI)),NA_NI),
round(100*c(as.vector(table(NI)),NA_NI)/n_NI,1))
colnames(EEExt)=c(L1, L2,"Pérdidas")
rownames(EEExt)=c("Infectadas (N)", "Infectadas (%)","No infectadas (N)", "No infectadas (%)")
t(EEExt) %>%
kbl() %>%
kable_styling() %>%
scroll_box(width="100%", box_css="border: 0px;")
}
Tabla.DMG1=function(I,NI,L1,L2){
NA_I=length(I[is.na(I)])
NA_NI=length(NI[is.na(NI)])
EEExt=rbind(c(as.vector(table(I))[2:1],NA_I),
round(100*c(as.vector(table(I))[2:1],NA_I)/n_I1,1),
c(as.vector(table(NI))[2:1],NA_NI),
round(100*c(as.vector(table(NI))[2:1],NA_NI)/n_NI1,1))
colnames(EEExt)=c(L1, L2,"Pérdidas")
rownames(EEExt)=c("Infectadas (N)", "Infectadas (%)","No infectadas (N)", "No infectadas (%)")
t(EEExt) %>%
kbl() %>%
kable_styling() %>%
scroll_box(width="100%", box_css="border: 0px;")
}
Tabla.DMG2=function(I,NI,L1,L2){
NA_I=length(I[is.na(I)])
NA_NI=length(NI[is.na(NI)])
EEExt=rbind(c(as.vector(table(I))[2:1],NA_I),
round(100*c(as.vector(table(I))[2:1],NA_I)/n_I2,1),
c(as.vector(table(NI))[2:1],NA_NI),
round(100*c(as.vector(table(NI))[2:1],NA_NI)/n_NI2,1))
colnames(EEExt)=c(L1, L2,"Pérdidas")
rownames(EEExt)=c("Infectadas (N)", "Infectadas (%)","No infectadas (N)", "No infectadas (%)")
t(EEExt) %>%
kbl() %>%
kable_styling() %>%
scroll_box(width="100%", box_css="border: 0px;")
}
# Tablas 2d Descripción sintomatología
Tabla.DGS=function(I,L1,L2){
DF=data.frame(Factor=I,Síntomas=Sint)
taula=table(DF)[c(2,1) ,1:3]
proptaula=round(100*prop.table(taula,margin=2),2)
EEExt=cbind(c(as.vector(taula[,1]),n_AS-sum(as.vector(taula[,1]))),
round(100*c(as.vector(taula[,1]),n_AS-sum(as.vector(taula[,1])))/n_AS,2),
c(as.vector(taula[,2]),n_SL-sum(as.vector(taula[,2]))),
round(100*c(as.vector(taula[,2]),n_SL-sum(as.vector(taula[,2])))/n_SL,2),
c(as.vector(taula[,3]),n_NE-sum(as.vector(taula[,3]))),
round(100*c(as.vector(taula[,3]),n_NE-sum(as.vector(taula[,3])))/n_NE,2)
)
EEExt=rbind(EEExt,c(n_AS,100,n_SL,100,n_NE,100))
rownames(EEExt)=c(L1,L2,"Pérdidas","Total")
colnames(EEExt)=Columnes.Sint
EEExt %>%
kbl() %>%
kable_styling() %>%
scroll_box(width="100%", box_css="border: 0px;")
}
Tabla.DGSW=function(I,L1,L2){
DF=data.frame(Factor=I,Síntomas=Sint)
taula=table(DF)[c(2,1) ,]
proptaula=round(100*prop.table(taula,margin=2),2)
EEExt=cbind(as.vector(taula[,1]),
as.vector(proptaula[,1]),
as.vector(taula[,2]),
as.vector(proptaula[,2]),
as.vector(taula[,3]),
as.vector(proptaula[,3])
)
rownames(EEExt)=c(L1,L2)
colnames(EEExt)=Columnes.Sint
EEExt %>%
kbl() %>%
kable_styling()
}
# Barplots descripción global sintomatología
Barplot.DGS=function(I,L1,L2){
taula=table(data.frame(Factor=I,Síntomas=Sint))[c(2,1) ,1:3]
Síntomas=ordered(rep(c("Asintomática", "Leve", "Grave"), each=2),levels=c("Asintomática", "Leve", "Grave"))
Grupo=ordered(rep(c(L1, L2) , 3),levels=c(L1, L2))
valor=as.vector(prop.table(taula, margin=1))
data <- data.frame(Grupo,Síntomas,valor)
ggplot(data, aes(fill=Síntomas, y=valor, x=Grupo)) +
geom_bar(position="dodge", stat="identity")+
ylab("")+
xlab("")+
scale_fill_brewer(palette = "Dark2")
}
Barplot.DGSW=function(I,L1,L2){
taula=table(data.frame(Factor=I,Síntomas=Sint))[c(2,1),]
Síntomas=ordered(rep(c("Asintomática", "Leve", "Grave"), each=2),levels=c("Asintomática", "Leve", "Grave"))
Grupo=ordered(rep(c(L1,L2) , 3),levels=c(L1,L2))
valor=as.vector(prop.table(taula, margin=1))
data <- data.frame(Grupo,Síntomas,valor)
ggplot(data, aes(fill=Síntomas, y=valor, x=Grupo)) +
geom_bar(position="dodge", stat="identity")+
ylab("")+
xlab("")+
scale_fill_brewer(palette = "Dark2")
}
# Tabla de comparación entre olas: Casos y controles
ComparOlasCC=function(I1,I2,NI1,NI2,L1,L2){
NA_I1=length(I1[is.na(I1)])
NA_NI1=length(NI1[is.na(NI1)])
NA_I2=length(I2[is.na(I2)])
NA_NI2=length(NI2[is.na(NI2)])
EEExt=cbind(c(as.vector(table(I1))[2:1],NA_I1),
round(100*c(as.vector(table(I1))[2:1],NA_I1)/n_I1,1),
c(as.vector(table(NI1))[2:1],NA_NI1),
round(100*c(as.vector(table(NI1))[2:1],NA_NI1)/n_NI1,1),
c(as.vector(table(I2))[2:1],NA_I2),
round(100*c(as.vector(table(I2))[2:1],NA_I2)/n_I2,1),
c(as.vector(table(NI2))[2:1],NA_NI2),
round(100*c(as.vector(table(NI2))[2:1],NA_NI2)/n_NI2,1)
)
colnames(EEExt)=ColumnesExt
rownames(EEExt)=c(L1, L2,"Pérdidas")
EEExt %>%
kbl() %>%
kable_styling() %>%
scroll_box(width="100%", box_css="border: 0px;")
}
GrComparOlasCC=function(I1,I2,NI1,NI2,L1){
base=c("1a ola","2a ola")
df=data.frame(
Factor=c(rep("Infectadas 1a ola",length(I1)), rep("No infectadas 1a ola",length(NI1)),rep("Infectadas 2a ola",length(I2)), rep("No infectadas 2a ola",length(NI2))),
Grupo=c(I1,NI1,I2,NI2 )
)
Grupo=ordered(rep(c("Infectadas","No infectadas"), 2),levels=c("Infectadas","No infectadas"))
Ola=ordered(rep(base , each=2),levels=base)
valor=as.vector(100*prop.table(table(df)[c(1,3,2,4),2:1], margin=1))[1:4]
data=data.frame(Grupo,Ola,valor)
data %>%
ggplot(aes(fill=Grupo, y=valor, x=Ola)) +
geom_bar(position="dodge", stat="identity")+
xlab("")+
ylab(paste(L1,"(%)"))+
scale_fill_hue(c=100)+labs(fill="")}
# Tabla de comparación entre olas: Global
ComparOlasGl=function(Tot1w,Tot2w,L1,L2){
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
n_1=length(Tot1w)
n_2=length(Tot2w)
NA_1=length(Tot1w[is.na(Tot1w)])
NA_2=length(Tot2w[is.na(Tot2w)])
EEExt=cbind(c(as.vector(table(Tot1w))[2:1],NA_1),
round(100*c(as.vector(table(Tot1w))[2:1],NA_1)/n_1,1),
c(as.vector(table(Tot2w))[2:1],NA_2),
round(100*c(as.vector(table(Tot2w))[2:1],NA_2)/n_2,1)
)
colnames(EEExt)=ColumnesOnes
rownames(EEExt)=c(L1,L2,"Pérdidas")
EEExt %>%
kbl() %>%
kable_styling() %>%
scroll_box(width="100%", box_css="border: 0px;")
}
# Tabla de comparación Anteparto-Periparto
TablaAntePeri=function(I,NI,L1,L2){
I.AP=I[Casos$PreP==1]
I.PP=I[Casos$PreP==0]
NA_IAP=length(I.AP[is.na(I.AP)])
NA_IPP=length(I.PP[is.na(I.PP)])
NA_NI=length(NI[is.na(NI)])
EEExt=rbind(c(as.vector(table(I.AP))[2:1],NA_IAP),
round(100*c(as.vector(table(I.AP))[2:1],NA_IAP)/n_IAP,1),
c(as.vector(table(I.PP))[2:1],NA_IPP),
round(100*c(as.vector(table(I.PP))[2:1],NA_IPP)/n_IPP,1),
c(as.vector(table(NI))[2:1],NA_NI),
round(100*c(as.vector(table(NI))[2:1],NA_NI)/n_NI,1))
rownames(EEExt)=ColumnesP
colnames(EEExt)=c(L1,L2,"Pérdidas")
t(EEExt) %>%
kbl() %>%
kable_styling()
}
# Tablas 2d Robson
TablaRobsonGlobal=function(TR1,TR2,x,y=x){
EE1=t(TR1)[2:1,2:11]
EE2=t(TR2)[2:1,2:11]
OR=rep(0,10)
pp=rep(0,10)
for (i in 1:10){
FT=fisher.test(cbind(EE1[,i],EE2[,i]))
OR[i]=FT$estimate
pp[i]=FT$p.value       }
dt=data.frame(1:10,colSums(EE1),EE1[1,],round(100*prop.table(EE1,margin=2)[1,],2),colSums(EE2),EE2[1,],round(100*prop.table(EE2,margin=2)[1,],2),round(OR,2),round(pp,3))
names(dt)=c("Grupo Robson", paste("Casos",x), "Cesáreas", "Porcentaje",  paste("Controles",y), "Cesáreas", "Porcentaje","OR","p-valor test de Fisher")
dt %>%
kbl() %>%
kable_styling()%>%
scroll_box(width="100%", box_css="border: 0px;")}
I1=Casos1w$Feto.muerto.intraútero
I1[I1=="Sí"]="Muerto"
I1[I1=="No"]="Vivo"
I2=Casos1wGM$Feto.vivo
I2[I2=="Sí"]="Vivo"
I2[I2=="No"]="Muerto"
I=c(I1,I2)
SintN1=Casos1w$SINTOMAS_DIAGNOSTICO
SintN2=Casos1wGM$SINTOMAS_DIAGNOSTICO
SintN=c(SintN1,SintN2)
DF=data.frame(Factor=I,Síntomas=SintN)
taula=table(DF)[c(1,2),]
proptaula=round(100*prop.table(taula,margin=2),2)
EEExt=cbind(as.vector(taula[,1]),
as.vector(proptaula[,1]),
as.vector(taula[,2]),
as.vector(proptaula[,2]),
as.vector(taula[,3]),
as.vector(proptaula[,3])
)
rownames(EEExt)=c("Feto muerto anteparto", "Feto vivo")
colnames(EEExt)=Columnes.Sint
EEExt %>%
kbl() %>%
kable_styling()
pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power
chisq.test(taula)
taula
6/19
6/11
95/(95+217)
I=Casos1w$Hemorragia.postparto
I.sino=I
I.sino[!is.na(I.sino)& I.sino!="No"]="Sí"
I=ordered(I,levels=names(table(I))[c(4,2,3,1)])
NI=Controls1w$Hemorragia.postparto
NI.sino=NI
NI.sino[!is.na(NI.sino)& NI.sino!="No"]="Sí"
NI=ordered(NI,levels=names(table(NI))[c(4,2,3,1)])
Tabla.DMG1(I.sino,NI.sino,"HPP", "No HPP")
NA_I=length(I[is.na(I)])
NA_NI=length(NI[is.na(NI)])
EE=rbind(as.vector(table(I)),
as.vector(table(NI)))
EEExt=rbind(c(as.vector(table(I)),NA_I),
round(100*c(as.vector(table(I)),NA_I)/n_I1,1),
c(as.vector(table(NI)),NA_NI),
round(100*c(as.vector(table(NI)),NA_NI)/n_NI1,1))
colnames(EEExt)=c(names(table(I)), "Pérdidas")
rownames(EEExt)=Columnes
t(EEExt) %>%
kbl() %>%
kable_styling()
EE=rbind(as.vector(table(I))[2:4],
as.vector(table(NI))[2:4])
EEExt=rbind(as.vector(table(I))[2:4],
round(100*prop.table(table(I)[2:4]),1),
as.vector(table(NI))[2:4],
round(100*prop.table(table(NI)[2:4]),1))
colnames(EEExt)=names(table(I))[2:4]
rownames(EEExt)=Columnes
t(EEExt) %>%
kbl() %>%
kable_styling()
df =data.frame(
Factor=c( rep("Infectadas",length(I[I!="No"])), rep("No infectadas",length(NI[NI!="No"]))),
Hemos=ordered(c( I[I!="No"],NI[NI!="No"] ),levels=names(table(I))[-4])
)
base=ordered(rep(c("Tto. médico", "Tto. Qx conservador", "Histerectomía"), each=2),levels=c("Tto. médico", "Tto. Qx conservador", "Histerectomía"))
Grupo=rep(c("Infectada","No infectada") , 3)
valor=as.vector(prop.table(table(df), margin=1))
data <- data.frame(base,Grupo,valor)
ggplot(data, aes(fill=Grupo, y=valor, x=base)) +
geom_bar(position="dodge", stat="identity")+
xlab("Tratamientos de hemorragia postparto")+
ylab("")
EE=rbind(as.vector(table(I)),
as.vector(table(NI)))
EEExt=rbind(c(as.vector(table(I)),NA_I),
round(100*c(as.vector(table(I)),NA_I)/n_I1,1),
c(as.vector(table(NI)),NA_NI),
round(100*c(as.vector(table(NI)),NA_NI)/n_NI1,1))
colnames(EEExt)=c(names(table(I)), "Pérdidas")
rownames(EEExt)=Columnes
t(EEExt) %>%
kbl() %>%
kable_styling()
EE=rbind(as.vector(table(I))[2:4],
as.vector(table(NI))[2:4])
EEExt=rbind(as.vector(table(I))[2:4],
round(100*prop.table(table(I)[2:4]),1),
as.vector(table(NI))[2:4],
round(100*prop.table(table(NI)[2:4]),1))
colnames(EEExt)=names(table(I))[2:4]
rownames(EEExt)=Columnes
t(EEExt) %>%
kbl() %>%
kable_styling()
valor=as.vector(prop.table(EE, margin=1))
valor
base=ordered(rep(c("Tto. médico", "Tto. Qx conservador", "Histerectomía"), each=2),levels=c("Tto. médico", "Tto. Qx conservador", "Histerectomía"))
Grupo=rep(c("Infectada","No infectada") , 3)
valor=as.vector(prop.table(EE, margin=1))
data <- data.frame(base,Grupo,valor)
ggplot(data, aes(fill=Grupo, y=valor, x=base)) +
geom_bar(position="dodge", stat="identity")+
xlab("Tratamientos de hemorragia postparto")+
ylab("")
17/(17+175)
17/(17+189)
UCI.I=sum(Casos1w$UCI,na.rm=TRUE)
I=Casos1w$UCI_ANTES.DESPUES.DEL.PARTO
DF=data.frame(Factor=I,Síntomas=Sint)
I=Casos1w$UCI
taula=table(data.frame(I,Sint))[c(2,1) ,]
Sint=Casos1w$SINTOMAS_DIAGNOSTICO
I=Casos1w$UCI
taula=table(data.frame(I,Sint))[c(2,1) ,]
Tabla.DGSW(I,"UCI", "No UCI")
Barplot.DGSW(I,"UCI", "No UCI")
UCI.I=sum(Casos1w$UCI,na.rm=TRUE)
I=Casos1w$UCI_ANTES.DESPUES.DEL.PARTO
DF=data.frame(Factor=I,Síntomas=Sint)
taula=table(DF)[c(2,1),]
proptaula=round(100*prop.table(taula,margin=2),2)
EEExt=cbind(as.vector(taula[,1]),
as.vector(proptaula[,1]),
as.vector(taula[,2]),
as.vector(proptaula[,2]),
as.vector(taula[,3]),
as.vector(proptaula[,3])
)
rownames(EEExt)=c("UCI después del parto","UCI antes del parto")
colnames(EEExt)=Columnes.Sint
EEExt %>%
kbl() %>%
kable_styling()
Síntomas=ordered(rep(c("Asintomática", "Leve", "Grave"), each=2),levels=c("Asintomática", "Leve", "Grave"))
Grupo=ordered(rep(rownames(EEExt) , 3),levels=rownames(EEExt))
valor=as.vector(prop.table(taula, margin=1))
data <- data.frame(Grupo,Síntomas,valor)
ggplot(data, aes(fill=Síntomas, y=valor, x=Grupo)) +
geom_bar(position="dodge", stat="identity")+
ylab("")+
xlab("")+
scale_fill_brewer(palette = "Dark2")
taula
Síntomas=ordered(rep(c("Asintomática", "Leve", "Grave"), each=2),levels=c("Asintomática", "Leve", "Grave"))
Grupo=ordered(rep(rownames(EEExt)[2:1] , 3),levels=rownames(EEExt)[2:1])
valor=as.vector(prop.table(taula[2:1,], margin=1))
data <- data.frame(Grupo,Síntomas,valor)
ggplot(data, aes(fill=Síntomas, y=valor, x=Grupo)) +
geom_bar(position="dodge", stat="identity")+
ylab("")+
xlab("")+
scale_fill_brewer(palette = "Dark2")
SintN=c(Casos1w[Casos1w$Feto.muerto.intraútero=="No",]$SINTOMAS_DIAGNOSTICO,Casos1wGM[Casos1wGM$Feto.vivo=="Sí",]$SINTOMAS_DIAGNOSTICO)
Síntomas=ordered(SintN[!is.na(SintN)],levels=c("Asintomática" ,"Leve",      "Grave"  ))
Síntomas=SintN[!is.na(SintN)]
I=c(Casos1w[Casos1w$Feto.muerto.intraútero=="No",]$Peso._gramos_...125,Casos1wGM[Casos1wGM$Feto.vivo=="Sí",]$Peso._gramos_...148)
I=I[!is.na(SintN)]
data =data.frame(
Síntomas,
Pesos=I
)
data %>%
ggplot( aes(x=Síntomas, y=Pesos, fill=Síntomas)) +
geom_violin(width=1) +
geom_boxplot(width=0.1, color="black", alpha=0.2,outlier.fill="black",
outlier.size=1) +
#theme_ipsum() +
theme(
legend.position="none",
plot.title = element_text(size=11)
) +
xlab("")+
ylab("Pesos (gramos)")+
scale_fill_brewer(palette = "Dark2")
I.cut=cut(I,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)
DF=data.frame(Factor=I.cut,Síntomas=Síntomas)
taula=table(DF)[,c(1,2,3)]
proptaula=round(100*prop.table(taula,margin=2),2)
EEExt=cbind(c(as.vector(taula[,1]),length(I.cut[Síntomas=="Asintomática"])-sum(as.vector(taula[,1]))),
round(100*c(as.vector(taula[,1]),length(I.cut[Síntomas=="Asintomática"])-sum(as.vector(taula[,1])))/length(I.cut[Síntomas=="Asintomática"]),2),
c(as.vector(taula[,2]),length(I.cut[Síntomas=="Leve"])-sum(as.vector(taula[,2]))),
round(100*c(as.vector(taula[,2]),length(I.cut[Síntomas=="Leve"])-sum(as.vector(taula[,2])))/length(I.cut[Síntomas=="Leve"]),2),
c(as.vector(taula[,3]),length(I.cut[Síntomas=="Grave"])-sum(as.vector(taula[,3]))),
round(100*c(as.vector(taula[,3]),length(I.cut[Síntomas=="Grave"])-sum(as.vector(taula[,3])))/length(I.cut[Síntomas=="Grave"]),2)
)
EEExt=rbind(EEExt,c(length(I.cut[Síntomas=="Asintomática"]),100,length(I.cut[Síntomas=="Leve"]),100,length(I.cut[Síntomas=="Grave"]),100))
rownames(EEExt)=c("Bajo peso", "No bajo peso","Pérdidas","Total")
colnames(EEExt)=Columnes.Sint
EEExt %>%
kbl() %>%
kable_styling() %>%
scroll_box(width="100%", box_css="border: 0px;")
taula
prop.table(taula, margin=2)
round(100*prop.table(taula, margin=2),1)
I=c(Casos1w$APGAR.5...126,Casos1wGM$APGAR.5...150)
I=cut(I,breaks=c(-1,7,20),labels=c("0-7","8-10"))
SintN=c(Casos1w$SINTOMAS_DIAGNOSTICO,Casos1wGM$SINTOMAS_DIAGNOSTICO)
DF=data.frame(Factor=I,Síntomas=SintN)
taula=table(DF)[c(2,1),]
proptaula=round(100*prop.table(taula,margin=2),2)
EEExt=cbind(as.vector(taula[,1]),
as.vector(proptaula[,1]),
as.vector(taula[,2]),
as.vector(proptaula[,2]),
as.vector(taula[,3]),
as.vector(proptaula[,3])
)
rownames(EEExt)=c("Apgar.5≥8 ","Apgar.5≤7", )
I=c(Casos1w$APGAR.5...126,Casos1wGM$APGAR.5...150)
I=cut(I,breaks=c(-1,7,20),labels=c("0-7","8-10"))
SintN=c(Casos1w$SINTOMAS_DIAGNOSTICO,Casos1wGM$SINTOMAS_DIAGNOSTICO)
DF=data.frame(Factor=I,Síntomas=SintN)
taula=table(DF)[c(2,1),]
proptaula=round(100*prop.table(taula,margin=2),2)
EEExt=cbind(as.vector(taula[,1]),
as.vector(proptaula[,1]),
as.vector(taula[,2]),
as.vector(proptaula[,2]),
as.vector(taula[,3]),
as.vector(proptaula[,3])
)
rownames(EEExt)=c("Apgar.5≥8 ","Apgar.5≤7")
colnames(EEExt)=Columnes.Sint
EEExt %>%
kbl() %>%
kable_styling()
Síntomas=ordered(rep(c("Asintomática", "Leve", "Grave"), each=2),levels=c("Asintomática", "Leve", "Grave"))
Grupo=ordered(rep(rownames(EEExt) , 3),levels=rownames(EEExt))
valor=as.vector(prop.table(taula, margin=1))
data <- data.frame(Grupo,Síntomas,valor)
ggplot(data, aes(fill=Síntomas, y=valor, x=Grupo)) +
geom_bar(position="dodge", stat="identity")+
ylab("")+
xlab("")+
scale_fill_brewer(palette = "Dark2")
Síntomas=ordered(rep(c("Asintomática", "Leve", "Grave"), each=2),levels=c("Asintomática", "Leve", "Grave"))
Grupo=ordered(rep(rownames(EEExt)[2:1] , 3),levels=rownames(EEExt)[2:1])
valor=as.vector(prop.table(taula[2:1,], margin=1))
data <- data.frame(Grupo,Síntomas,valor)
ggplot(data, aes(fill=Síntomas, y=valor, x=Grupo)) +
geom_bar(position="dodge", stat="identity")+
ylab("")+
xlab("")+
scale_fill_brewer(palette = "Dark2")
I=Casos2w$Edad._años_
NI=Controls2w$Edad._años_
NA_I=length(I[is.na(I)])
NA_NI=length(NI[is.na(NI)])
Sint=Casos2w$SINTOMAS_DIAGNOSTICO
Sint=Casos2w$SINTOMAS_DIAGNOSTICO
Síntomas=ordered(c("Asintomática", "Leve", "Grave"),levels=c("Asintomática", "Leve", "Grave"))
valor=as.vector(prop.table(table(Sint)))
valor
table(Sint)
1/73
