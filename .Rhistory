GrComparOlasCC(I1,I2,NI1,NI2,"HG")
I1=Casos1w$Diabetes.gestacional
I2=Casos2w$Diabetes.gestacional
I2[I2=="No"]=0
I2[I2=="Sí"]=1
I1[I1=="No"]=0
I1[I1=="Sí"]=1
#
NI1=Controls1w$Diabetes.gestacional
NI2=Controls2w$Diabetes.gestacional
#
ComparOlasRR(I1,I2,NI1,NI2,"DG", "No DG")
GrComparOlasCC(I1,I2,NI1,NI2,"DG")
I1=Casos1w$PREECLAMPSIA_ECLAMPSIA_TOTAL
I2=Casos2w$PREECLAMPSIA_ECLAMPSIA_TOTAL
NI1=Controls1w$PREECLAMPSIA
NI2=Controls2w$PREECLAMPSIA
#
ComparOlasRR(I1,I2,NI1,NI2,"PE", "No PE")
GrComparOlasCC(I1,I2,NI1,NI2,"PE")
I1=Casos1w[Casos1w$PREECLAMPSIA_ECLAMPSIA_TOTAL==1,]$Preeclampsia.grave_HELLP_ECLAMPSIA
I1[I1=="Sí"]=1
I1[I1=="No"]=0
I2=Casos2w[Casos2w$PREECLAMPSIA_ECLAMPSIA_TOTAL==1,]$Preeclampsia.grave_HELLP_ECLAMPSIA
I2[I2=="Sí"]=1
I2[I2=="No"]=0
NI1.1=Controls1w[Controls1w$PREECLAMPSIA==1,]$preeclampsia_severa
NI1.2=Controls1w[Controls1w$PREECLAMPSIA==1,]$Preeclampsia.grave.No.HELLP
NI1=rep(NA,length(NI1.1))
for (i in 1:length(NI1.1)){NI1[i]=max(NI1.1[i],NI1.2[i],na.rm=TRUE)}
NI2.1=Controls2w[Controls2w$PREECLAMPSIA==1,]$preeclampsia_severa
NI2.2=Controls2w[Controls2w$PREECLAMPSIA==1,]$Preeclampsia.grave.No.HELLP
NI2=rep(NA,length(NI2.1))
for (i in 1:length(NI2.1)){NI2[i]=max(NI2.1[i],NI2.2[i],na.rm=TRUE)}
#
ComparOlasRR(I1,I2,NI1,NI2,"PE con CG", "PE sin CG")
base=c("1a ola","2a ola")
df =data.frame(
Factor=c(rep("Infectadas 1a ola",length(I1)), rep("No infectadas 1a ola",length(NI1)),rep("Infectadas 2a ola",length(I2)), rep("No infectadas 2a ola",length(NI2))),
Grupo=c(I1,NI1,I2,NI2)
)
Grupo=ordered(rep(c("Infectadas","No infectadas"), 2),levels=c("Infectadas","No infectadas"))
Ola=ordered(rep(base , each=2),levels=base)
valor=as.vector(100*prop.table(table(df)[c(1,3,2,4),2:1], margin=1))[1:4]
data=data.frame(Grupo,Ola,valor)
data %>%
ggplot(aes(fill=Grupo, y=valor, x=Ola)) +
geom_bar(position="dodge", stat="identity")+
xlab("")+
ylab("Preeclampsias con CG (% de preeclampsias)")+
scale_fill_hue(c=100)+labs(fill="")
I1=Casos1w$PREMATURO
I2=Casos2w$PREMATURO
NI1=Controls1w$Preterm.deliveries
NI2=Controls2w$Preterm.deliveries
#
ComparOlasRR(I1,I2,NI1,NI2,"Prematuro", "A término")
GrComparOlasCC(I1,I2,NI1,NI2,"Prematuro")
I1=Casos1w$EVENTOS_HEMORRAGICOS_TOTAL
I2=Casos2w$EVENTOS_HEMORRAGICOS_TOTAL
NI1=Controls1w$eventos_hemorragicos
NI2=Controls2w$eventos_hemorragicos
#
ComparOlasRR(I1,I2,NI1,NI2,"Eventos hemorrágicos", "No eventos hemorrágicos")
GrComparOlasCC(I1,I2,NI1,NI2,"Eventos hemorrágicos")
I1=factor(Casos1w$EVENTOS_TROMBO_TOTALES,levels=0:1)
I2=factor(Casos2w$EVENTOS_TROMBO_TOTALES,levels=0:1)
NI1a=Controls1w$DVT
NI1b=Controls1w$PE
NI1=rep(NA,length(NI1a))
for (i in 1:length(NI1a)){NI1[i]=max(NI1a[i],NI1b[i],na.rm=TRUE)}
NI1=factor(NI1,levels=0:1)
NI2a=Controls2w$DVT
NI2b=Controls2w$PE
NI2=rep(NA,length(NI2a))
for (i in 1:length(NI2a)){NI2[i]=max(NI2a[i],NI2b[i],na.rm=TRUE)}
NI2=factor(NI2,levels=0:1)
#
ComparOlasRR(I1,I2,NI1,NI2,"Eventos trombóticos", "No eventos trombóticos")
GrComparOlasCC(I1,I2,NI1,NI2,"Eventos trombóticos")
I1=Casos1w$Diagnóstico.de.malformación.ecográfica._.semana.20._
I1[I1=="No"]=0
I1[I1=="Sí"]=1
I2=Casos2w$Diagnóstico.de.malformación.ecográfica._.semana.20._
I2[I2=="No"]=0
I2[I2=="Sí"]=1
NI1=Controls1w$Diagnóstico.de.malformación.ecográfica._.semana.20._
NI2=Controls2w$Diagnóstico.de.malformación.ecográfica._.semana.20._
#
ComparOlasRR(I1,I2,NI1,NI2,"Anomalías congénitas", "No anomalías congénitas")
GrComparOlasCC(I1,I2,NI1,NI2,"Anomalías congénitas")
I1=Casos1w$Feto.muerto.intraútero
I1[I1=="Sí"]=1
I1[I1=="No"]=0
I2=Casos2w$Feto.muerto.intraútero
I2[I2=="Sí"]=1
I2[I2=="No"]=0
NI1a=Controls1w$Feto.vivo...194
NI1a[NI1a=="Sí"]=0
NI1a[NI1a=="No"]=1
NI1b=Controls1w$Feto.vivo...245
NI1b[NI1b=="Sí"]=0
NI1b[NI1b=="No"]=1
NI1=NI1a
for (i in 1:length(NI1a)){NI1[i]=max(NI1a[i],NI1b[i],na.rm=TRUE)}
NI2a=Controls2w$Feto.vivo...194
NI2a[NI2a=="Sí"]=0
NI2a[NI2a=="No"]=1
NI2b=Controls2w$Feto.vivo...245
NI2b[NI2b=="Sí"]=0
NI2b[NI2b=="No"]=1
NI2=NI2a
for (i in 1:length(NI2a)){NI2[i]=max(NI2a[i],NI2b[i],na.rm=TRUE)}
NI2=factor(NI2,levels=0:1)
#
ComparOlasRR(I1,I2,NI1,NI2,"Algún feto muerto anteparto", "Ningún feto muerto anteparto")
GrComparOlasCC(I1,I2,NI1,NI2,"Algún feto muerto anteparto")
I1=Casos1w$Inicio.de.parto
I1=factor(I1,levels=c("Espontáneo", "Inducido", "Cesárea"),ordered=TRUE)
I2=Casos2w$Inicio.de.parto
I2=factor(I2,levels=c("Espontáneo", "Inducido", "Cesárea"),ordered=TRUE)
NI1=Controls1w$Inicio.de.parto
NI1[NI1=="Cesárea programada"]="Cesárea"
NI1=factor(NI1,levels=c("Espontáneo", "Inducido", "Cesárea"),ordered=TRUE)
NI2=Controls2w$Inicio.de.parto
NI2[NI2=="Cesárea programada"]="Cesárea"
NI2=factor(NI2,levels=c("Espontáneo", "Inducido", "Cesárea"),ordered=TRUE)
ComparOlasRR.m(I1,I2,NI1,NI2,c("Espontáneo", "Inducido", "Cesárea programada"))
Tipo= c(I1,I2,NI1,NI2)
Tipo[Tipo=="Cesárea"]="Cesárea programada"
Tipo=ordered(Tipo, levels=c("Espontáneo", "Inducido", "Cesárea programada"))
dtbp=data.frame(Grupo=c(rep("Inf.",length(I1)+length(I2)),rep("No inf.",length(NI1)+length(NI2))),
Ola= c(rep("1a ola",length(I1)),rep("2a ola",length(I2)),rep("1a ola",length(NI1)),rep("2a ola",length(NI2))),
Tipo
)
ggplot(data=na.omit(dtbp))+
geom_mosaic(aes(x=product(Tipo,Ola), fill=Grupo)) +
theme_mosaic()+
ylab("Inicio de parto")+
xlab("")+
scale_fill_discrete(name ="", labels=c("Infectadas", "No infectadas"))+
scale_x_productlist(labels=c("Infectadas\n 1a ola",  "No infectadas\n 1a ola", "Infectadas\n 2a ola", "No infectadas\n 2a ola"))
SRH=scheirerRayHare(Tipo ~ Grupo + Ola,data=dtbp,verbose=FALSE)$p.value[3]
I1.In=Casos1w$Inicio.de.parto
I1=Casos1w$Tipo.de.parto
I1[I1.In=="Cesárea"]="Cesárea programada"
I1[I1=="Cesárea"]="Cesárea urgente"
I1[I1=="Eutocico"]="Eutócico"
I1=factor(I1,levels=c("Eutócico", "Instrumental", "Cesárea programada", "Cesárea urgente"),ordered=TRUE)
I2.In=Casos2w$Inicio.de.parto
I2=Casos2w$Tipo.de.parto
I2[I2.In=="Cesárea"]="Cesárea programada"
I2[I2=="Cesárea"]="Cesárea urgente"
I2[I2=="Eutocico"]="Eutócico"
I2=factor(I2,levels=c("Eutócico", "Instrumental", "Cesárea programada", "Cesárea urgente"),ordered=TRUE)
NI1.In=Controls1w$Inicio.de.parto
NI1=Controls1w$Tipo.de.parto
NI1[NI1.In=="Cesárea programada"]="Cesárea programada"
NI1[NI1=="Cesárea"]="Cesárea urgente"
NI1[NI1=="Eutocico"]="Eutócico"
NI1=factor(NI1,levels=c("Eutócico", "Instrumental", "Cesárea programada", "Cesárea urgente"),ordered=TRUE)
NI2.In=Controls2w$Inicio.de.parto
NI2=Controls2w$Tipo.de.parto
NI2[NI2.In=="Cesárea programada"]="Cesárea programada"
NI2[NI2=="Cesárea"]="Cesárea urgente"
NI2[NI2=="Eutocico"]="Eutócico"
NI2=factor(NI2,levels=c("Eutócico", "Instrumental", "Cesárea programada", "Cesárea urgente"),ordered=TRUE)
ComparOlasRR.m(I1,I2,NI1,NI2,c("Eutócico", "Instrumental", "Cesárea programada", "Cesárea urgente"))
I1=factor(Casos1w$Defecto.del.crecimiento.fetal..en.tercer.trimestre._.CIR._.,labels=0:1)
I2=factor(Casos2w$Defecto.del.crecimiento.fetal..en.tercer.trimestre._.CIR._.,labels=0:1)
NI1=factor(Controls1w$Defecto.del.crecimiento.fetal..en.tercer.trimestre._.CIR._.)
NI2=factor(Controls2w$Defecto.del.crecimiento.fetal..en.tercer.trimestre._.CIR._.)
ComparOlasRR(I1,I2,NI1,NI2,"RCIU", "No RCIU")
GrComparOlasCC(I1,I2,NI1,NI2,"RCIU")
I1=Casos1w$Hemorragia.postparto
I1.sino=I1
I1.sino[!is.na(I1.sino)& I1.sino!="No"]="Sí"
I1=ordered(I1,levels=names(table(I1))[c(2,3,1,4)])
I2=Casos2w$Hemorragia.postparto
I2.sino=I2
I2.sino[!is.na(I2.sino)& I2.sino!="No"]="Sí"
I2=ordered(I2,levels=names(table(I2))[c(2,3,1,4)])
NI1=Controls1w$Hemorragia.postparto
NI1.sino=NI1
NI1.sino[!is.na(NI1.sino)& NI1.sino!="No"]="Sí"
NI1=ordered(NI1,levels=names(table(NI1))[c(2,3,1,4)])
NI2=Controls2w$Hemorragia.postparto
NI2.sino=NI2
NI2.sino[!is.na(NI2.sino)& NI2.sino!="No"]="Sí"
NI2=ordered(NI2,levels=names(table(NI2))[c(2,3,1,4)])
ComparOlasRR(I1.sino,I2.sino,NI1.sino,NI2.sino,"HPP", "No HPP")
GrComparOlasCC(I1.sino,I2.sino,NI1.sino,NI2.sino,"HPP")
ComparOlasRR.m(I1,I2,NI1,NI2,c( "HPP Tto médico", "HPP Tto Qx conservador", "Histerectomía", "No HPP"),r=6)
Tipo= c(I1,I2,NI1,NI2)
dtbp=data.frame(Grupo=c(rep("Inf.",length(I1)+length(I2)),rep("No inf.",length(NI1)+length(NI2))),
Ola= c(rep("1a ola",length(I1)),rep("2a ola",length(I2)),rep("1a ola",length(NI1)),rep("2a ola",length(NI2))),
Tipo
)
ggplot(data=na.omit(dtbp))+
geom_mosaic(aes(x=product(Tipo,Ola), fill=Grupo)) +
theme_mosaic()+
ylab("Tipo de HPP")+
xlab("")+
scale_fill_discrete(name ="", labels=c("Infectadas", "No infectadas"))+
scale_x_productlist(labels=c("Infectadas\n 1a ola",  "No infectadas\n 1a ola", "Infectadas\n 2a ola", "No infectadas\n 2a ola"))
SRH=scheirerRayHare(Tipo ~ Grupo + Ola,data=dtbp)$p.value[3]
I1=Casos1w$UCI
I2=Casos2w$UCI
NI1=factor(Controls1w$UCI...9)
NI2=factor(Controls2w$UCI...9,levels=0:1)
ComparOlasRR(I1,I2,NI1,NI2,"UCI", "No UCI")
GrComparOlasCC(I1,I2,NI1,NI2,"UCI")
I1=Casos1w$Bolsa.rota.anteparto
I2=Casos2w$Bolsa.rota.anteparto
NI1=Controls1w$Bolsa.rota.anteparto
NI2=Controls2w$Bolsa.rota.anteparto
ComparOlasRR(I1,I2,NI1,NI2,"RPM", "No RPM")
GrComparOlasCC(I1,I2,NI1,NI2,"RPM")
I1=c(Casos1w[Casos1w$Feto.muerto.intraútero=="No",]$Ingreso.en.UCIN,Casos1wGM[Casos1wGM$Feto.vivo=="Sí",]$Ingreso.en.UCI)
I2=c(Casos2w[Casos2w$Feto.muerto.intraútero=="No",]$Ingreso.en.UCIN,Casos2wGM[Casos2wGM$Feto.vivo=="Sí",]$Ingreso.en.UCI)
NI1=c(Controls1w[Controls1w$Feto.vivo...194=="Sí",]$Ingreso.en.UCI...213,Controls1wGM[Controls1wGM$Feto.vivo...245=="Sí",]$Ingreso.en.UCI...260)
NI2=c(Controls2w[Controls2w$Feto.vivo...194=="Sí",]$Ingreso.en.UCI...213,Controls2wGM[Controls2wGM$Feto.vivo...245=="Sí",]$Ingreso.en.UCI...260)
ComparOlasRR(I1,I2,NI1,NI2,"UCIN", "No UCIN")
df =data.frame(
Factor=c(rep("Infectadas 1a ola",length(I1)), rep("No infectadas 1a ola",length(NI1)),rep("Infectadas 2a ola",length(I2)), rep("No infectadas 2a ola",length(NI2))),
Grupo=c(I1,NI1,I2,NI2 )
)
Grupo=ordered(rep(c("Infectadas","No infectadas"), 2),levels=c("Infectadas","No infectadas"))
Ola=ordered(rep(base , each=2),levels=base)
valor=as.vector(100*prop.table(table(df)[c(1,3,2,4),2:1], margin=1))[1:4]
data=data.frame(Grupo,Ola,valor)
data %>%
ggplot(aes(fill=Grupo, y=valor, x=Ola)) +
geom_bar(position="dodge", stat="identity")+
xlab("")+
ylab("UCI neonatal (%)")+
scale_fill_hue(c=100)+labs(fill="")
I1=c(Casos1w$APGAR.5...126,Casos1wGM$APGAR.5...150)
I2=c(Casos2w$APGAR.5...126,Casos2wGM$APGAR.5...150)
I2[I2==19]=NA
NI1=c(Controls1w$APGAR.5...200,Controls1wGM$APGAR.5...249)
NI2=c(Controls2w$APGAR.5...200,Controls2wGM$APGAR.5...249)
I1=cut(I1,breaks=c(-1,7,20),labels=c("0-7","8-10"))
I2=cut(I2,breaks=c(-1,7,20),labels=c("0-7","8-10"))
NI1=cut(NI1,breaks=c(-1,7,20),labels=c("0-7","8-10"))
NI2=cut(NI2,breaks=c(-1,7,20),labels=c("0-7","8-10"))
I1=ordered(I1,levels=c("8-10","0-7"))
I2=ordered(I2,levels=c("8-10","0-7"))
NI1=ordered(NI1,levels=c("8-10","0-7"))
NI2=ordered(NI2,levels=c("8-10","0-7"))
ComparOlasRR(I1,I2,NI1,NI2,"Apgar.5≤7", "Apgar.5≥8")
df =data.frame(
Factor=c(rep("Infectadas 1a ola",length(I1)), rep("No infectadas 1a ola",length(NI1)),rep("Infectadas 2a ola",length(I2)), rep("No infectadas 2a ola",length(NI2))),
Grupo=c(I1,NI1,I2,NI2 )
)
Grupo=ordered(rep(c("Infectadas","No infectadas"), 2),levels=c("Infectadas","No infectadas"))
Ola=ordered(rep(base , each=2),levels=base)
valor=as.vector(100*prop.table(table(df)[c(1,3,2,4),], margin=1))[1:4]
data=data.frame(Grupo,Ola,valor)
data %>%
ggplot(aes(fill=Grupo, y=valor, x=Ola)) +
geom_bar(position="dodge", stat="identity")+
xlab("")+
ylab("UCI materna (%)")+
scale_fill_hue(c=100)+labs(fill="")
I1=Casos1w$EG_TOTAL_PARTO
I2=Casos2w$EG_TOTAL_PARTO
NI1=Controls1w$EDAD_GEST
NI2=Controls2w$EDAD_GEST
Dades=rbind(c(round(min(I1,na.rm=TRUE),1),round(max(I1,na.rm=TRUE),1), round(mean(I1,na.rm=TRUE),1),round(median(I1,na.rm=TRUE),1),round(quantile(I1,c(0.25,0.75),na.rm=TRUE),1), round(sd(I1,na.rm=TRUE),1)),
c(round(min(NI1,na.rm=TRUE),1),round(max(NI1,na.rm=TRUE),1), round(mean(NI1,na.rm=TRUE),1),round(median(NI1,na.rm=TRUE),1),round(quantile(NI1,c(0.25,0.75),na.rm=TRUE),1),round(sd(NI1,na.rm=TRUE),1)),
c(round(min(I2,na.rm=TRUE),1),round(max(I2,na.rm=TRUE),1), round(mean(I2,na.rm=TRUE),1),round(median(I2,na.rm=TRUE),1),round(quantile(I2,c(0.25,0.75),na.rm=TRUE),1), round(sd(I2,na.rm=TRUE),1)),
c(round(min(NI2,na.rm=TRUE),1),round(max(NI2,na.rm=TRUE),1), round(mean(NI2,na.rm=TRUE),1),round(median(NI2,na.rm=TRUE),1),round(quantile(NI2,c(0.25,0.75),na.rm=TRUE),1),round(sd(NI2,na.rm=TRUE),1)))
colnames(Dades)=c("Edad gest. mínima","Edad gest. máxima","Edad gest. media", "Edad gest. mediana", "1er cuartil", "3er cuartil", "Desv. típica")
rownames(Dades)=c("Infectadas 1a ola", "No infectadas 1a ola","Infectadas 2a ola", "No infectadas 2a ola")
Dades %>%
kbl() %>%
kable_styling() %>%
scroll_box(width="100%", box_css="border: 0px;")
data =data.frame(
name=ordered(c( rep("Infectadas 1a ola",length(I1)), rep("No infectadas 1a ola",length(NI1)),rep("Infectadas 2a ola",length(I2)), rep("No infectadas 2a ola",length(NI2))),levels=c("Infectadas 1a ola","No infectadas 1a ola","Infectadas 2a ola","No infectadas 2a ola")),
Edades=c( I1,NI1,I2,NI2 ),
Color=c( rep("Infectadas",length(I1)), rep("No infectadas",length(NI1)),rep("Infectadas",length(I2)), rep("No infectadas",length(NI2)))
)
data %>%
ggplot( aes(x=name, y=Edades, fill=name)) +
geom_violin(width=1) +
geom_boxplot(width=0.1, color="black", alpha=0.2,outlier.fill="black",
outlier.size=1) +
theme(
legend.position="none",
plot.title=element_text(size=11)
) +
xlab("")+
ylab("Edades gestacionales (semanas)")+
scale_fill_manual(values=c("#F8766D" ,"#00BFC4" ,"#F8766D", "#00BFC4"))
Tipo= c(I1,I2,NI1,NI2)
dtbp=data.frame(Grupo=c(rep("Inf.",length(I1)+length(I2)),rep("No inf.",length(NI1)+length(NI2))),
Ola= c(rep("1a ola",length(I1)),rep("2a ola",length(I2)),rep("1a ola",length(NI1)),rep("2a ola",length(NI2))),
Tipo
)
SRH=scheirerRayHare(Tipo ~ Grupo + Ola,
data=dtbp,verbose=FALSE)$p.value[3]
I1=c(Casos1w[Casos1w$Feto.muerto.intraútero=="No",]$Peso._gramos_...125,Casos1wGM[Casos1wGM$Feto.vivo=="Sí",]$Peso._gramos_...148)
NI1=c(Controls1w[Controls1w$Feto.vivo...194=="Sí",]$Peso._gramos_...198,Controls1wGM[Controls1wGM$Feto.vivo...245=="Sí",]$Peso._gramos_...247)
I2=c(Casos2w[Casos2w$Feto.muerto.intraútero=="No",]$Peso._gramos_...125,Casos2wGM[Casos2wGM$Feto.vivo=="Sí",]$Peso._gramos_...148)
NI2=c(Controls2w[Controls2w$Feto.vivo...194=="Sí",]$Peso._gramos_...198,Controls2wGM[Controls2wGM$Feto.vivo...245=="Sí",]$Peso._gramos_...247)
Dades=rbind(c(round(min(I1,na.rm=TRUE),1),round(max(I1,na.rm=TRUE),1), round(mean(I1,na.rm=TRUE),1),round(median(I1,na.rm=TRUE),1),round(quantile(I1,c(0.25,0.75),na.rm=TRUE),1), round(sd(I1,na.rm=TRUE),1)),
c(round(min(NI1,na.rm=TRUE),1),round(max(NI1,na.rm=TRUE),1), round(mean(NI1,na.rm=TRUE),1),round(median(NI1,na.rm=TRUE),1),round(quantile(NI1,c(0.25,0.75),na.rm=TRUE),1),round(sd(NI1,na.rm=TRUE),1)),
c(round(min(I2,na.rm=TRUE),1),round(max(I2,na.rm=TRUE),1), round(mean(I2,na.rm=TRUE),1),round(median(I2,na.rm=TRUE),1),round(quantile(I2,c(0.25,0.75),na.rm=TRUE),1), round(sd(I2,na.rm=TRUE),1)),
c(round(min(NI2,na.rm=TRUE),1),round(max(NI2,na.rm=TRUE),1), round(mean(NI2,na.rm=TRUE),1),round(median(NI2,na.rm=TRUE),1),round(quantile(NI2,c(0.25,0.75),na.rm=TRUE),1),round(sd(NI2,na.rm=TRUE),1)))
colnames(Dades)=c("Peso mínimo","Peso máximo","Peso  medio", "Peso  mediano", "1er cuartil", "3er cuartil", "Desv. típica")
rownames(Dades)=c("Infectadas 1a ola", "No infectadas 1a ola","Infectadas 2a ola", "No infectadas 2a ola")
Dades %>%
kbl() %>%
kable_styling() %>%
scroll_box(width="100%", box_css="border: 0px;")
data =data.frame(
name=ordered(c( rep("Infectadas 1a ola",length(I1)), rep("No infectadas 1a ola",length(NI1)),rep("Infectadas 2a ola",length(I2)), rep("No infectadas 2a ola",length(NI2))),levels=c("Infectadas 1a ola","No infectadas 1a ola","Infectadas 2a ola","No infectadas 2a ola")),
Edades=c( I1,NI1,I2,NI2 ),
Color=c( rep("Infectadas",length(I1)), rep("No infectadas",length(NI1)),rep("Infectadas",length(I2)), rep("No infectadas",length(NI2)))
)
data %>%
ggplot( aes(x=name, y=Edades, fill=name)) +
geom_violin(width=1) +
geom_boxplot(width=0.1, color="black", alpha=0.2,outlier.fill="black",
outlier.size=1) +
theme(
legend.position="none",
plot.title=element_text(size=11)
) +
xlab("")+
ylab("Pesos (gramos)")+
scale_fill_manual(values=c("#F8766D" ,"#00BFC4" ,"#F8766D", "#00BFC4"))
Tipo= c(I1,I2,NI1,NI2)
dtbp=data.frame(Grupo=c(rep("Inf.",length(I1)+length(I2)),rep("No inf.",length(NI1)+length(NI2))),
Ola= c(rep("1a ola",length(I1)),rep("2a ola",length(I2)),rep("1a ola",length(NI1)),rep("2a ola",length(NI2))),
Tipo
)
SRH=scheirerRayHare(Tipo ~ Grupo + Ola,
data=dtbp,verbose=FALSE)$p.value[3]
I1w=cut(I1,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)
NI1w=cut(NI1,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)
I2w=cut(I2,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)
NI2w=cut(NI2,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)
I1w=ordered(I1w,levels=c(0,1))
I2w=ordered(I2w,levels=c(0,1))
NI1w=ordered(NI1w,levels=c(0,1))
NI2w=ordered(NI2w,levels=c(0,1))
ComparOlasRR(I1w,I2w,NI1w,NI2w,"Bajo peso", "No bajo peso")
df =data.frame(
Factor=c(rep("Infectadas 1a ola",length(I1w)), rep("No infectadas 1a ola",length(NI1w)),rep("Infectadas 2a ola",length(I2w)), rep("No infectadas 2a ola",length(NI2w))),
Grupo=c(I1w,NI1w,I2w,NI2w )
)
Grupo=ordered(rep(c("Infectadas","No infectadas"), 2),levels=c("Infectadas","No infectadas"))
Ola=ordered(rep(base , each=2),levels=base)
valor=as.vector(100*prop.table(table(df)[c(1,3,2,4),2:1], margin=1))[1:4]
data=data.frame(Grupo,Ola,valor)
data %>%
ggplot(aes(fill=Grupo, y=valor, x=Ola)) +
geom_bar(position="dodge", stat="identity")+
xlab("")+
ylab("RPM (%)")+
scale_fill_hue(c=100)+labs(fill="")
I1w1=Casos1w$Feto.muerto.intraútero
I1w1[I1w1=="Sí"]="Muerto"
I1w1[I1w1=="No"]="Vivo"
I1w2=Casos1wGM$Feto.vivo
I1w2[I1w2=="Sí"]="Vivo"
I1w2[I1w2=="No"]="Muerto"
I1w=c(I1w1,I1w2)
n_I1wFT=length(I1w)
n_VI1w=as.vector(table(I1w))[2]
I1w=ordered(I1w,levels=c("Vivo","Muerto"))
NI1w1=Controls1w$Feto.vivo...194
NI1w2=Controls1wGM$Feto.vivo...245
NI1w=c(NI1w1,NI1w2)
NI1w[NI1w=="Sí"]="Vivo"
NI1w[NI1w=="No"]="Muerto"
NI1w=factor(NI1w,levels=c("Muerto","Vivo"))
n_NI1wFT=length(NI1w)
n_VNI1w=as.vector(table(NI1w))[2]
I2w=ordered(I2w,levels=c("Vivo","Muerto"))
#
#
I2w1=Casos2w$Feto.muerto.intraútero
I2w1[I2w1=="Sí"]="Muerto"
I2w1[I2w1=="No"]="Vivo"
I2w2=Casos2wGM$Feto.vivo
I2w2[I2w2=="Sí"]="Vivo"
I2w2[I2w2=="No"]="Muerto"
I2w=c(I2w1,I2w2)
n_I2wFT=length(I2w)
n_VI2w=as.vector(table(I2w))[2]
NI1w=ordered(NI1w,levels=c("Vivo","Muerto"))
NI2w1=Controls2w$Feto.vivo...194
NI2w2=Controls2wGM$Feto.vivo...245
NI2w=c(NI2w1,NI2w2)
NI2w[NI2w=="Sí"]="Vivo"
NI2w[NI2w=="No"]="Muerto"
NI2w=factor(NI2w,levels=c("Muerto","Vivo"))
n_NI2wFT=length(NI2w)
n_VNI2w=as.vector(table(NI2w))[2]
NI1w=ordered(NI1w,levels=c("Vivo","Muerto"))
ComparOlasRRwe(I1w,I2w,NI1w,NI2w,"Feto muerto anteparto", "Feto vivo")
I1=Casos1w$Hipertensión.pregestacional
I2=Casos2w$Hipertensión.pregestacional
I2[I2=="No"]=0
I2[I2=="Sí"]=1
I1[I1=="No"]=0
I1[I1=="Sí"]=1
#
NI1=Controls1w$Hipertensión.pregestacional
NI2=Controls2w$Hipertensión.pregestacional
#
ComparOlasCC(I1,I2,NI1,NI2,"HTA","No HTA")
I1=Casos1w$FUMADORA_CAT
I2=Casos2w$FUMADORA_CAT
NI1=Controls1w$Fumadora_cat
NI2=Controls2w$Fumadora_cat
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
NA_I1=length(I1[is.na(I1)])
NA_NI1=length(NI1[is.na(NI1)])
NA_I2=length(I2[is.na(I2)])
NA_NI2=length(NI2[is.na(NI2)])
EE=cbind(as.vector(table(I1))[2:1],
as.vector(table(NI1))[2:1],
as.vector(table(I2))[2:1],
as.vector(table(NI2))[2:1])
OR1=fisher.test(EE[,1:2])$estimate
OR2=fisher.test(EE[,3:4])$estimate
OR1=fisher.test(EE[,1:2])$estimate
OR2=fisher.test(EE[,3:4])$estimate
QOR=OR1/OR2
pp=round(OR.OR(EE)[1],r)
r=6
pp=round(OR.OR(EE)[1],r)
IC=OR.OR(EE)[2:3]
OR.OR(EE)
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=EE[,c(1,3)]
EENI=EE[,c(2,4)]
FTGlob=c(fisher.test(EETot)$p.value,fisher.test(EEI)$p.value,fisher.test(EENI)$p.value)
EEExt=cbind(c(as.vector(table(I1))[2:1],NA_I1),
c(round(100*as.vector(prop.table(table(I1)))[2:1],1),NA),
c(as.vector(table(NI1))[2:1],NA_NI1),
c(round(100*as.vector(prop.table(table(NI1)))[2:1],1),NA),
c(as.vector(table(I2))[2:1],NA_I2),
c(round(100*as.vector(prop.table(table(I2)))[2:1],1),NA),
c(as.vector(table(NI2))[2:1],NA_NI2),
c(round(100*as.vector(prop.table(table(NI2)))[2:1],1),NA),
c(round(QOR,4),NA,NA),
c(round(IC[1],4),NA,NA),
c(round(IC[2],4),NA,NA),
c(pp,NA,NA),
c(round(FTGlob[1],r),NA,NA),
c(round(FTGlob[2],r),NA,NA),
c(round(FTGlob[3],r),NA,NA)
)
colnames(EEExt)=c(ColumnesExt,"Cociente de OR", "Extr. inf. IC",  "Extr. sup. IC", "p-valor igualdad OR","p-valor global olas", "p-valor casos","p-valor controles")
rownames(EEExt)=c(L1, L2,"Datos perdidos")
ComparOlasCC=function(I1,I2,NI1,NI2,L1,L2,r=6){
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
NA_I1=length(I1[is.na(I1)])
NA_NI1=length(NI1[is.na(NI1)])
NA_I2=length(I2[is.na(I2)])
NA_NI2=length(NI2[is.na(NI2)])
EE=cbind(as.vector(table(I1))[2:1],
as.vector(table(NI1))[2:1],
as.vector(table(I2))[2:1],
as.vector(table(NI2))[2:1])
OR1=fisher.test(EE[,1:2])$estimate
OR2=fisher.test(EE[,3:4])$estimate
QOR=OR1/OR2
pp=round(OR.OR(EE)[1],r)
IC=OR.OR(EE)[2:3]
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=EE[,c(1,3)]
EENI=EE[,c(2,4)]
FTGlob=c(fisher.test(EETot)$p.value,fisher.test(EEI)$p.value,fisher.test(EENI)$p.value)
EEExt=cbind(c(as.vector(table(I1))[2:1],NA_I1),
c(round(100*as.vector(prop.table(table(I1)))[2:1],1),NA),
c(as.vector(table(NI1))[2:1],NA_NI1),
c(round(100*as.vector(prop.table(table(NI1)))[2:1],1),NA),
c(as.vector(table(I2))[2:1],NA_I2),
c(round(100*as.vector(prop.table(table(I2)))[2:1],1),NA),
c(as.vector(table(NI2))[2:1],NA_NI2),
c(round(100*as.vector(prop.table(table(NI2)))[2:1],1),NA),
c(round(QOR,4),NA,NA),
c(round(IC[1],4),NA,NA),
c(round(IC[2],4),NA,NA),
c(pp,NA,NA),
c(round(FTGlob[1],r),NA,NA),
c(round(FTGlob[2],r),NA,NA),
c(round(FTGlob[3],r),NA,NA)
)
colnames(EEExt)=c(ColumnesExt,"Cociente de OR", "Extr. inf. IC",  "Extr. sup. IC", "p-valor igualdad OR","p-valor global olas", "p-valor casos","p-valor controles")
rownames(EEExt)=c(L1, L2,"Datos perdidos")
EEExt %>%
kbl() %>%
kable_styling() %>%
scroll_box(width="100%", box_css="border: 0px;")
}
I1=Casos1w$FUMADORA_CAT
I2=Casos2w$FUMADORA_CAT
NI1=Controls1w$Fumadora_cat
NI2=Controls2w$Fumadora_cat
#
ComparOlasCC(I1,I2,NI1,NI2,"Fumadoras","No fumadoras")
GrComparOlasCC(I1,I2,NI1,NI2,"Fumadoras")
