# Descripción global de la muestra de la primera ola 


```{r}
Casos=Casos1w
Controls=Controls1w
Sint=Casos$SINTOMAS_DIAGNOSTICO
CasosGM=Casos1wGM
ControlsGM=Controls1wGM
```



Hay `r n_I1` infectadas y `r n_NI1` no infectadas en la muestra de la primera ola.

## Antecedentes


### Edades



```{r}
I=Casos$Edad._años_
NI=Controls$Edad._años_
```



```{r 1-1w,fig.cap="\\s"}
data =data.frame(
  name=c(rep("Infectadas",length(I)), rep("No infectadas",length(NI))),
  Edades=c(I,NI)
  )

sample_size = data %>% group_by(name) %>% summarize(num=n())

data %>%
 left_join(sample_size) %>%
  mutate(myaxis = paste0(name, "\n", "n=", num)) %>%
  ggplot( aes(x=myaxis, y=Edades, fill=name)) +
    geom_violin(width=1) +
    geom_boxplot(width=0.1, color="black", alpha=0.2,outlier.fill="black",
               outlier.size=1) +
    theme(
      legend.position="none",
      plot.title = element_text(size=11)
    ) +
    xlab("")+
  ylab("Edades (años)")
```





```{r}
Dades=rbind(c(min(I,na.rm=TRUE),max(I,na.rm=TRUE), round(mean(I,na.rm=TRUE),1),round(median(I,na.rm=TRUE),1),round(quantile(I,c(0.25,0.75),na.rm=TRUE),1), round(sd(I,na.rm=TRUE),1)),
            c(min(NI,na.rm=TRUE),max(NI,na.rm=TRUE), round(mean(NI,na.rm=TRUE),1),round(median(NI,na.rm=TRUE),1),round(quantile(NI,c(0.25,0.75),na.rm=TRUE),1),round(sd(NI,na.rm=TRUE),1)))

colnames(Dades)=c("Edad mínima","Edad máxima","Edad media", "Edad mediana", "1er cuartil", "3er cuartil", "Desv. típica")
rownames(Dades)=c("Infectadas", "No infectadas")

Dades %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")


```


* Ajuste de las edades de infectadas y no infectadas a distribuciones normales: test de Shapiro-Wilks, p-valores $`r signif(shapiro.test(I)$p.value,1)`$ y $`r 
signif(shapiro.test(NI)$p.value,1)`$, respectivamente

* Igualdad de edades medias: test t, p-valor `r round(t.test(I,NI)$p.value,2)`, IC del 95% para la diferencia de medias [`r round(t.test(I,NI)$conf.int,2)`] años

* Igualdad de desviaciones típicas: test de Fligner-Killeen, p-valor $`r round(fligner.test(list(I,NI))$p.value,5)`$

En las tablas como la que sigue:

* Los porcentajes se han calculado en la muestra sin pérdidas
* OR: la odds ratio univariante estimada de infectarse relativa a la franja de edad
* IC: el intervalo de confianza del 95% para la OR
* p-valor ajustado: p-valores de tests de Fisher bilaterales ajustados por Bonferroni calculados para la muestra sin pérdidas


```{r}
I.cut=cut(I,breaks=c(0,30,40,100),labels=c("18-30","31-40",">40"))
NI.cut=cut(NI,breaks=c(0,30,40,100),labels=c("18-30","31-40",">40"))
Tabla.DMGm(I.cut,NI.cut,c("18-30","31-40",">40"))
```


```{r 2-1w,fig.cap="\\s"}
df =data.frame(
  Factor=c(rep("Infectadas",length(I)), rep("No infectadas",length(NI))),
  Edades=c( I.cut,NI.cut )
)

base=ordered(rep(c("18-30","31-40",">40"), each=2),levels=c("18-30", "31-40",   ">40"))
Grupo=rep(c("Infectada","No infectada") , length(levels(I.cut)))
valor=as.vector(prop.table(table(df), margin=1))
data <- data.frame(base,Grupo,valor)


ggplot(data, aes(fill=base , y=valor, x=Grupo)) + 
  geom_bar(position="dodge", stat="identity")+
  ylab("")+
  scale_fill_brewer(palette = "Accent")+
  labs(fill = "Grupo de edad")

```


```{r 3-1w,fig.cap="\\s"}
df =data.frame(
  Factor=c(rep("Infectadas",length(I)), rep("No infectadas",length(NI))),
  Edades=c( I.cut,NI.cut )
)

base=ordered(rep(c("18-30","31-40",">40"), each=2),levels=c("18-30", "31-40",   ">40"))
Grupo=rep(c("Infectada","No infectada") , length(levels(I.cut)))
valor=as.vector(prop.table(table(df), margin=2))
data <- data.frame(base,Grupo,valor)


ggplot(data, aes(fill=Grupo, y=valor, x=base)) + 
  geom_bar(position="dodge", stat="identity")+
xlab("Grupos de edad")+
  ylab("")
```


* Igualdad de composiciones por edades de los grupos de casos y de controles: test $\chi^2$, p-valor `r round(chisq.test(rbind(as.vector(table(I.cut)),
         as.vector(table(NI.cut))))$p.value,4)`. 




### Etnias

```{r}
I=Casos$Etnia
I[I=="Asia"]="Asiática"
I=factor(I)
NI=factor(Controls$Etnia)
Tabla.DMGm(I,NI,c("Árabe", "Asiática", "Blanca", "Latinoamericana","Negra"),r=6)

```



```{r 4-1w,fig.cap="\\s"}
df =data.frame(
  Factor=c(rep("Infectadas",length(I)), rep("No infectadas",length(NI))),
  Etnias=c(I,NI)
)
base=rep(levels(I) , each=2)
Grupo=rep(c("Infectada","No infectada") , length(levels(I)))
valor=as.vector(prop.table(table(df), margin=1))
data <- data.frame(base,Grupo,valor)


ggplot(data, aes(fill=base , y=valor, x=Grupo)) + 
  geom_bar(position="dodge", stat="identity")+
  ylab("")+
  scale_fill_brewer(palette = "Accent")+
  labs(fill = "Etnia")

```

```{r 5-1w,fig.cap="\\s"}
df =data.frame(
  Factor=c(rep("Infectadas",length(I)), rep("No infectadas",length(NI))),
  Etnias=c(I,NI)
)
base=rep(levels(I) , each=2)
Grupo=rep(c("Infectada","No infectada") , length(levels(I)))
valor=as.vector(prop.table(table(df), margin=2))
data <- data.frame(base,Grupo,valor)


ggplot(data, aes(fill=Grupo, y=valor, x=base)) + 
  geom_bar(position="dodge", stat="identity")+
xlab("Etnias")+
  ylab("")

```


* Composiciones por etnias de los grupos de casos y de controles: test $\chi^2$, p-valor  $`r signif(chisq.test(rbind(as.vector(table(I)),
         as.vector(table(NI))))$p.value,1)`$







### Hábito tabáquico (juntando fumadoras y ex-fumadoras en una sola categoría)

En las tablas como la que sigue (para antecedentes):

* Los porcentajes se calculan para la muestra sin pérdidas
* La OR es la de infección relativa al antecedente
* El IC es el IC 95% para la OR
* El p-valor es el del test de Fisher bilateral sin tener en cuenta los datos perdidos

```{r}
I=Casos$FUMADORA_CAT
NI=Controls$Fumadora_cat
Tabla.DMG(I,NI,"No fumadora","Fumadora")
```




### Obesidad 


```{r}
I=Casos$Obesidad
NI=Controls$Obesidad
Tabla.DMG(I,NI,"No obesa","Obesa")
```



### Hipertensión pregestacional


```{r}
I=Casos$Hipertensión.pregestacional
NI=Controls$Hipertensión.pregestacional
Tabla.DMG(I,NI,"No HTA","HTA")
```



### Diabetes Mellitus 

```{r}
I=Casos$DIABETES
NI=Controls$Diabetes
Tabla.DMG(I,NI,"No DM","DM")
```



### Enfermedades cardíacas crónicas 

```{r}
I=Casos$Enfermedad.cardiaca.crónica
NI=Controls$ENF.CARDIACA.TODO
Tabla.DMG(I,NI,"No ECC","ECC")
```




### Enfermedades pulmonares crónicas (incluyendo asma)




```{r,warning=FALSE}
INA=Casos$Enfermedad.pulmonar.crónica.no.asma
NINA=Controls$Enfermedad.pulmonar.crónica.no.asma
NINA[NINA==0]="No"
NINA[NINA==1]="Sí"
IA=Casos$Diagnóstico.clínico.de.Asma
NIA=Controls$Diagnóstico.clínico.de.Asma
NIA[NIA==0]="No"
NIA[NIA==1]="Sí"

I=rep(NA,n_I)
for (i in 1:n_I){I[i]=max(INA[i],IA[i],na.rm=TRUE)}
NI=rep(NA,n_NI)
for (i in 1:n_NI){NI[i]=max(NINA[i],NIA[i],na.rm=TRUE)}
NI[NI==-Inf]=NA


Tabla.DMG(I,NI,"No EPC","EPC")
```



### Paridad



```{r}
I=Casos$NULIPARA
NI=Controls$Nuliparous
Tabla.DMG(I,NI,"Multípara","Nulípara")
```


### Gestación múltiple



```{r}
I=Casos$Gestación.Múltiple
NI=Controls$Gestación.Múltiple
Tabla.DMG(I,NI,"Gestación única","Gestación múltiple")
```


## Desenlaces



### Anomalías congénitas


En las tablas como la que sigue (para desenlaces):

* Los porcentajes se calculan para la muestra sin pérdidas
* RA y RR: riesgo absoluto y relativo del desenlace relativo a la infección
* Los IC son el IC 95% para RA y RR
* El p-valor es el del test de Fisher bilateral sin tener en cuenta los datos perdidos



```{r}
I=Casos$Diagnóstico.de.malformación.ecográfica._.semana.20._
NI=Controls$Diagnóstico.de.malformación.ecográfica._.semana.20._
Tabla.DMGC(I,NI,"No anomalía congénita","Anomalía congénita")
```




### Retraso del crecimiento intrauterino 


```{r}
I=Casos$Defecto.del.crecimiento.fetal..en.tercer.trimestre._.CIR._.
NI=Controls$Defecto.del.crecimiento.fetal..en.tercer.trimestre._.CIR._.
Tabla.DMGC(I,NI,"No RCIU","RCIU")
```




### Diabetes gestacional 

```{r}
I=Casos$Diabetes.gestacional
NI=Controls$Diabetes.gestacional
Tabla.DMGC(I,NI,"No DG","DG")
```




### Hipertensión gestacional 


```{r}
I=Casos$Hipertensión.gestacional
NI=Controls$Hipertensión.gestacional
Tabla.DMGC(I,NI,"No HG","HG")
```




### Preeclampsia 



```{r}
I=Casos$PREECLAMPSIA_ECLAMPSIA_TOTAL
NI=Controls$PREECLAMPSIA
Tabla.DMGC(I,NI,"No PE","PE")
```



### Preeclampsia con criterios de gravedad


```{r}
n_PI=sum(Casos$PREECLAMPSIA_ECLAMPSIA_TOTAL)
n_PNI=sum(Controls$PREECLAMPSIA)
I=Casos[Casos$PREECLAMPSIA_ECLAMPSIA_TOTAL==1,]$Preeclampsia.grave_HELLP_ECLAMPSIA

NI1=Controls[Controls$PREECLAMPSIA==1,]$preeclampsia_severa
NI2=Controls[Controls$PREECLAMPSIA==1,]$Preeclampsia.grave.No.HELLP 
NI=rep(NA,n_PNI)
for (i in 1:n_PNI){NI[i]=max(NI1[i],NI2[i],na.rm=TRUE)}

Tabla.DMGCr(I,NI,"PE sin CG","PE con CG",n_PI,n_PNI)
```



### Rotura prematura de membranas 



```{r}
I=Casos$Bolsa.rota.anteparto
NI=Controls$Bolsa.rota.anteparto
Tabla.DMGC(I,NI,"No RPM","RPM")
```





### Edad gestacional en el momento del parto 


```{r}
I=Casos$EG_TOTAL_PARTO
NI=Controls$EDAD_GEST   
```


```{r}
Dades=round(rbind(c(min(I,na.rm=TRUE),max(I,na.rm=TRUE), round(mean(I,na.rm=TRUE),1),round(median(I,na.rm=TRUE),1),round(quantile(I,c(0.25,0.75),na.rm=TRUE),1), round(sd(I,na.rm=TRUE),1)),
            c(min(NI,na.rm=TRUE),max(NI,na.rm=TRUE), round(mean(NI,na.rm=TRUE),1),round(median(NI,na.rm=TRUE),1),round(quantile(NI,c(0.25,0.75),na.rm=TRUE),1),round(sd(NI,na.rm=TRUE),1))),1)

colnames(Dades)=c("Edad gest. mínima","Edad gest. máxima","Edad gest. media", "Edad gest. mediana", "1er cuartil", "3er cuartil", "Desv. típica")
rownames(Dades)=c("Infectadas", "No infectadas")

Dades %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")


```



```{r 6-1w,fig.cap="\\s"}
data =data.frame(
  name=c( rep("Infectadas",length(I)), rep("No infectadas",length(NI))),
  Edades=c( I,NI )
)

data %>%
  ggplot( aes(x=name, y=Edades, fill=name)) +
    geom_violin(width=1) +
    geom_boxplot(width=0.1, color="black", alpha=0.2,outlier.fill="black",
               outlier.size=1) +
    theme(
      legend.position="none",
      plot.title = element_text(size=11)
    ) +
    xlab("")+
  ylab("Edades gestacionales (semanas)")
```




```{r,include=FALSE}
shapiro.test(I)$p.value
shapiro.test(NI)$p.value
fligner.test(list(I,NI))
ttest=t.test(I,NI)
```

* Ajuste de las edades gestacionales de infectadas y no infectadas a distribuciones normales: test de Shapiro-Wilks, p-valores $`r signif(shapiro.test(I)$p.value,1)`$ y $`r 
signif(shapiro.test(NI)$p.value,1)`$, respectivamente

* Edades gestacionales medias: test t, p-valor $`r signif(ttest$p.value,1)`$, IC del 95% para la diferencia de medias [`r round(ttest$conf.int,2)`]

* Desviaciones típicas: test de Fligner-Killeen, p-valor $`r signif(fligner.test(list(I,NI))$p.value,1)`$


```{r,include=FALSE}
I=I[I>20]
shapiro.test(I)$p.value
shapiro.test(NI)$p.value
fligner.test(list(I,NI))
ttest=t.test(I,NI)
```

**Nota**: Como vemos en los boxplot, hay dos casos de infectadas con edades gestacionales incompatibles con la definición de "parto" (y que además luego tienen información incompatible con esto). Son `00133-00046` y `00268-00008`. Si las quitamos, las conclusiones son las mismas:

* Ajuste de las edades gestacionales de infectadas y no infectadas a distribuciones normales: test de Shapiro-Wilks, p-valores $`r signif(shapiro.test(I)$p.value,1)`$ y $`r 
signif(shapiro.test(NI)$p.value,1)`$, respectivamente


* Edades medias: test t, p-valor $`r signif(ttest$p.value,1)`$, IC del 95% para la diferencia de medias [`r round(ttest$conf.int,2)`]

* Desviaciones típicas: test de Fligner-Killeen, p-valor $`r signif(fligner.test(list(I,NI))$p.value,1)`$


### Prematuridad 



```{r}
I=Casos$PREMATURO
NI=Controls$Preterm.deliveries
Tabla.DMGC(I,NI,"No prematuro","Prematuro",r=7)
```




### Eventos trombóticos



```{r}
I=Casos$EVENTOS_TROMBO_TOTALES
NI1=Controls$DVT
NI2=Controls$PE
NI=rep(NA,n_NI)
for (i in 1:n_NI){NI[i]=max(NI1[i],NI2[i],na.rm=TRUE)}
Tabla.DMGC(I,NI,"No eventos trombóticos","Eventos trombóticos")
```




### Eventos hemorrágicos




```{r}
I=Casos$EVENTOS_HEMORRAGICOS_TOTAL
NI=Controls$eventos_hemorragicos
Tabla.DMGC(I,NI,"No eventos heomorrágicos","Eventos hemorrágicos")
```




### Ingreso materno en  UCI



```{r}
I=Casos$UCI
NI=Controls$UCI...9
Tabla.DMGC(I,NI,"No UCI","UCI",r=10)
```



### Ingreso materno en UCI según el momento del parto o cesárea


```{r}
UCI.I=sum(Casos$UCI,na.rm=TRUE)
UCI.NI=sum(Controls$UCI...9,na.rm=TRUE)
I=Casos$UCI_ANTES.DESPUES.DEL.PARTO
NI=Controls$UCI.ANTES.DEL.PARTO  #Vacía
NA_I=length(I[is.na(I)])
NA_NI=length(NI[is.na(NI)])




EE=rbind(as.vector(table(I)),
         c(0,UCI.NI))
FT=fisher.test(EE)
PT=prop.test(EE[,1],rowSums(EE))

RA=round(PT$estimate[1]-PT$estimate[2],3)
ICRA=round(PT$conf.int,4)
RR=round(PT$estimate[1]/PT$estimate[2],2)
ICRR=round(RelRisk(EE,conf.level=0.95,method="score")[2:3],2)

EEExt=rbind(c(as.vector(table(I))[2:1],NA_I),
            c(round(100*as.vector(table(I))[2:1]/(UCI.I-NA_I),1),NA),
            c(as.vector(c(0,UCI.NI))[2:1],NA_NI),
            c(round(100*as.vector(c(0,UCI.NI))[2:1]/(UCI.NI-NA_NI),1),NA),
            c(RA,NA,NA),
            c(ICRA[1],NA,NA),
            c(ICRA[2],NA,NA),
            c(RR,NA,NA),
            c(ICRR[1],NA,NA),
            c(ICRR[2],NA,NA),
            c(round(FT$p.value,4),NA,NA)
            )

colnames(EEExt)=c("Después del parto","Antes del parto" ,"Datos perdidos")
rownames(EEExt)=c("Infectadas (N)", "Infectadas (%)","No infectadas (N)", "No infectadas (%)","RA","Extr. Inf. IC RA","Extr. Sup. IC RA","RR","Extr. Inf. IC RA","Extr. Sup. IC RR", "p-valor")


t(EEExt) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```



### Embarazos con algún feto muerto anteparto 


```{r,include=FALSE}
IGM=Casos[Casos$Gestación.Múltiple=="Sí", c("Feto.muerto.intraútero","Feto.vivo") ]
table(IGM)
# En todas las infectadas con parto múltiple de las que tenemos datos los dos estaban vivos
NIGM=Controls[Controls$Gestación.Múltiple==1, c("Feto.vivo...194","Feto.vivo...245") ]
table(NIGM)
# En las controles hubo un caso de gestación múltiple con un feto muerto
```



```{r}
I=Casos$Feto.muerto.intraútero
I[I=="Sí"]=1
I[I=="No"]=0
NI1=Controls$Feto.vivo...194
NI1[NI1=="Sí"]=0
NI1[NI1=="No"]=1
NI2=Controls$Feto.vivo...245
NI2[NI2=="Sí"]=0
NI2[NI2=="No"]=1
NI=NI1
for (i in 1:length(NI1)){NI[i]=max(NI1[i],NI2[i],na.rm=TRUE)}

Tabla.DMGC(I,NI,"Ningún feto muerto anteparto","Algún feto muerto anteparto")
```






### Inicio del parto


```{r}
I=Casos$Inicio.de.parto
I=factor(Casos$Inicio.de.parto,levels=c("Espontáneo", "Inducido", "Cesárea"),ordered=TRUE)
NI=Controls$Inicio.de.parto
NI[NI=="Cesárea programada"]="Cesárea"
NI=factor(NI,levels=c("Espontáneo", "Inducido", "Cesárea"),ordered=TRUE)

Tabla.DMGCm(I,NI,c("Espontáneo", "Inducido", "Cesárea"),r=9)
```




```{r 7-1w,fig.cap="\\s"}
df =data.frame(
  Factor=c( rep("Infectadas",length(I)), rep("No infectadas",length(NI))),
  Inicios=ordered(c( I,NI ),levels=c("Espontáneo","Inducido","Cesárea"))
)

base=ordered(rep(c("Espontáneo","Inducido","Cesárea"), each=2),levels=c("Espontáneo","Inducido","Cesárea"))
Grupo=rep(c("Infectada","No infectada") , 3)
valor=c(as.vector(prop.table(table(df),margin=1))                 )
data <- data.frame(base,Grupo,valor)


ggplot(data, aes(fill=base, y=valor, x=Grupo)) + 
  geom_bar(position="dodge", stat="identity")+  
  ylab("")+
  scale_fill_brewer(palette = "Set3")+
  labs(fill = "Inicio de parto")
```


```{r 8-1w,fig.cap="\\s"}
df =data.frame(
  Factor=c( rep("Infectadas",length(I)), rep("No infectadas",length(NI))),
  Inicios=ordered(c( I,NI ),levels=c("Espontáneo","Inducido","Cesárea"))
)

base=ordered(rep(c("Espontáneo","Inducido","Cesárea"), each=2),levels=c("Espontáneo","Inducido","Cesárea"))
Grupo=rep(c("Infectada","No infectada") , 3)
valor=c(as.vector(prop.table(table(df),margin=2))                 )
data <- data.frame(base,Grupo,valor)


ggplot(data, aes(fill=Grupo, y=valor, x=base)) + 
  geom_bar(position="dodge", stat="identity")+  
  xlab("Inicios de parto")+
  ylab("")
```


* Distribuciones de los inicios de parto en los grupos de infectadas y no infectadas: test $\chi^2$, p-valor $`r signif(chisq.test(rbind(as.vector(table(I)),
         as.vector(table(NI))))$p.value,1)`$



### Tipo de parto


```{r}
I.In=Casos$Inicio.de.parto
I.In[I.In=="Cesárea"]="Cesárea programada"
I=Casos$Tipo.de.parto
I[I.In=="Cesárea programada"]="Cesárea programada"
I[I=="Cesárea"]="Cesárea urgente"
I[I=="Eutocico"]="Eutócico"
I=factor(I,levels=c("Eutócico", "Instrumental", "Cesárea programada", "Cesárea urgente"),ordered=TRUE)

NI.In=Controls$Inicio.de.parto
NI=Controls$Tipo.de.parto
NI[NI.In=="Cesárea programada"]="Cesárea programada"
NI[NI=="Cesárea"]="Cesárea urgente"
NI[NI=="Eutocico"]="Eutócico"
NI=factor(NI,levels=c("Eutócico", "Instrumental", "Cesárea programada", "Cesárea urgente"),ordered=TRUE)

Tabla.DMGCm(I,NI,c("Eutócico", "Instrumental", "Cesárea programada", "Cesárea urgente"),r=6)
```




```{r 9-1w,fig.cap="\\s"}
df =data.frame(
  Factor=c( rep("Infectadas",length(I)), rep("No infectadas",length(NI))),
  Inicios=ordered(c( I,NI ),levels=c("Eutócico", "Instrumental", "Cesárea programada", "Cesárea urgente"))
)

base=ordered(rep(c("Eutócico", "Instrumental", "Cesárea prog.", "Cesárea urg."), each=2),levels=c("Eutócico", "Instrumental", "Cesárea prog.", "Cesárea urg."))
Grupo=rep(c("Infectada","No infectada") , 4)
valor=c(as.vector(prop.table(table(df),margin=1))                 )
data <- data.frame(base,Grupo,valor)


ggplot(data, aes(fill=base, y=valor, x=Grupo)) + 
  geom_bar(position="dodge", stat="identity")+  
  ylab("")+
  scale_fill_brewer(palette = "Set3")+
  labs(fill = "Tipo de parto")
```

```{r 10-1w,fig.cap="\\s"}
df =data.frame(
  Factor=c( rep("Infectadas",length(I)), rep("No infectadas",length(NI))),
  Inicios=ordered(c( I,NI ),levels=c("Eutócico", "Instrumental", "Cesárea programada", "Cesárea urgente"))
)

base=ordered(rep(c("Eutócico", "Instrumental", "Cesárea prog.", "Cesárea urg."), each=2),levels=c("Eutócico", "Instrumental", "Cesárea prog.", "Cesárea urg."))
Grupo=rep(c("Infectada","No infectada") , 4)
valor=as.vector(prop.table(table(df), margin=2))
data <- data.frame(base,Grupo,valor)


ggplot(data, aes(fill=Grupo, y=valor, x=base)) + 
  geom_bar(position="dodge", stat="identity")+  
  xlab("Tipos de parto")+
  ylab("")
```




```{r,include=FALSE}
FT=chisq.test(rbind(as.vector(table(I)),
         as.vector(table(NI))))
```

* Distribuciones de los tipos de parto en los grupos de infectadas y no infectadas: test $\chi^2$, p-valor $`r signif(chisq.test(rbind(as.vector(table(I)),
         as.vector(table(NI))))$p.value,1)`$





### Hemorragias postparto



```{r}
I=Casos$Hemorragia.postparto
I.sino=I
I.sino[!is.na(I.sino)& I.sino!="No"]="Sí"
I=ordered(I,levels=names(table(I))[c(2,3,1,4)])


NI=Controls$Hemorragia.postparto
NI.sino=NI
NI.sino[!is.na(NI.sino)& NI.sino!="No"]="Sí"
NI=ordered(NI,levels=names(table(NI))[c(2,3,1,4)])

Tabla.DMGC(I.sino,NI.sino,"No HPP","HPP")
```
```{r}
Tabla.DMGCm(I,NI,c("HPP tratamiento médico" ,               
"HPP tratamiento quirúrgico conservador",
"Histerectomía obstétrica"    ,          
"No") ,r=6)

```




```{r 11-1w,fig.cap="\\s"}
df =data.frame(
  Factor=c( rep("Infectadas",length(I[I!="No"])), rep("No infectadas",length(NI[NI!="No"]))),
  Hemos=ordered(c( I[I!="No"],NI[NI!="No"] ),levels=names(table(I))[-4])
)

base=ordered(rep(c("Tto. médico", "Tto. Qx conservador", "Histerectomía"), each=2),levels=c("Tto. médico", "Tto. Qx conservador", "Histerectomía"))
Grupo=rep(c("Infectada","No infectada") , 3)
valor=as.vector(prop.table(table(df), margin=1))
data <- data.frame(base,Grupo,valor)


ggplot(data, aes(fill=Grupo, y=valor, x=base)) + 
  geom_bar(position="dodge", stat="identity")+  
  xlab("Tratamientos de hemorragia postparto")+
  ylab("")
```



```{r,include=FALSE}
EE1=rbind(as.vector(table(I)),
         as.vector(table(NI)))
FT1=chisq.test(EE1,simulate.p.value=TRUE,B=10000)
I=Casos$Hemorragia.postparto
I=I[I!="No"]
I=I[!is.na(I)]
NI=Controls$Hemorragia.postparto
NI=NI[NI!="No"]
NI=NI[!is.na(NI)]
EE2=EE1[,-4]
FT2=chisq.test(EE,simulate.p.value=TRUE,B=10000)
```

* Distribuciones de los tipos de hemorragia postparto (incluyendo Noes) en los grupos de infectadas y no infectadas: test $\chi^2$ de Montercarlo, p-valor `r round(FT1$p.value,2)`

* Distribuciones de los tipos de hemorragia postparto en los grupos de infectadas y no infectadas que tuvieron hemorragia postparto:  test $\chi^2$ de Montercarlo, p-valor `r round(FT2$p.value,2)`








### Fetos muertos anteparto 



```{r}
I1=Casos$Feto.muerto.intraútero
I1[I1=="Sí"]="Muerto"
I1[I1=="No"]="Vivo"
I2=CasosGM$Feto.vivo
I2[I2=="Sí"]="Vivo"
I2[I2=="No"]="Muerto"
I=c(I1,I2)
I=ordered(I,levels=c("Vivo","Muerto"))


n_IFT=length(I)
n_VI=as.vector(table(I))[1]
```


```{r}
NI1=Controls$Feto.vivo...194
NI2=ControlsGM$Feto.vivo...245
NI=c(NI1,NI2)
NI[NI=="Sí"]="Vivo"
NI[NI=="No"]="Muerto"
NI=ordered(NI,levels=c("Vivo","Muerto"))


n_NIFT=length(NI)
n_VNI=as.vector(table(NI))[1]


Tabla.DMGC(I,NI,"Feto vivo","Feto muerto anteparto")

```



### Peso de neonatos al nacimiento




```{r}
I=c(Casos[Casos$Feto.muerto.intraútero=="No",]$Peso._gramos_...125,CasosGM[CasosGM$Feto.vivo=="Sí",]$Peso._gramos_...148)
NI=c(Controls[Controls$Feto.vivo...194=="Sí",]$Peso._gramos_...198,ControlsGM[ControlsGM$Feto.vivo...245=="Sí",]$Peso._gramos_...247)
```

```{r 12-1w,fig.cap="\\s"}
data =data.frame(
  name=c(rep("Hijos de infectadas",length(I)), rep("Hijos de no infectadas",length(NI))),
  Pesos=c(I,NI)
  )

sample_size = data %>% group_by(name) %>% summarize(num=n())

data %>%
 left_join(sample_size) %>%
  mutate(myaxis = paste0(name, "\n", "n=", num)) %>%
  ggplot( aes(x=myaxis, y=Pesos, fill=name)) +
    geom_violin(width=0.9) +
    geom_boxplot(width=0.1, color="black", alpha=0.2,outlier.fill="black",
               outlier.size=1) +
    theme(
      legend.position="none",
      plot.title = element_text(size=11)
    ) +
    xlab("")+
  ylab("Pesos (gramos)")
```



```{r}
Dades=rbind(c(min(I,na.rm=TRUE),max(I,na.rm=TRUE), round(mean(I,na.rm=TRUE),1),round(median(I,na.rm=TRUE),1),round(quantile(I,c(0.25,0.75),na.rm=TRUE),1), round(sd(I,na.rm=TRUE),1)),
            c(min(NI,na.rm=TRUE),max(NI,na.rm=TRUE), round(mean(NI,na.rm=TRUE),1),round(median(NI,na.rm=TRUE),1),round(quantile(NI,c(0.25,0.75),na.rm=TRUE),1),round(sd(NI,na.rm=TRUE),1)))

colnames(Dades)=c("Peso mínimo","Peso máximo","Peso medio", "Peso mediano", "1er cuartil", "3er cuartil", "Desv. típica")
rownames(Dades)=c("Infectadas", "No infectadas")

Dades %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")


```



```{r,include=FALSE}
shapiro.test(I)$p.value
shapiro.test(NI)$p.value
fligner.test(list(I,NI))
ttest=t.test(I,NI)
```

* Ajuste de los pesos de hijos de infectadas y no infectadas a distribuciones normales: test de Shapiro-Wilks, p-valores $`r signif(shapiro.test(I)$p.value,1)`$ y $`r 
signif(shapiro.test(NI)$p.value,1)`$, respectivamente

* Pesos medios: test t, p-valor `r round(ttest$p.value,4)`, IC del 95% para la diferencia de medias [`r round(ttest$conf.int,2)`] 

* Desviaciones típicas: test de Fligner-Killeen, p-valor  `r round(fligner.test(list(I,NI))$p.value,4)`

Definimos **bajo peso** a peso menor o igual a 2500 g. Un `r round(100*length(c(I,NI)[!is.na(c(I,NI)) & c(I,NI)<2500])/length(c(I,NI)[!is.na(c(I,NI))]),2)`% del total de neonatos no muesrtos anteparto son  de bajo peso con esta definición.



```{r}
I.cut=cut(I,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)
I.cut=ordered(I.cut,levels=c(0,1))
NI.cut=cut(NI,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)
NI.cut=ordered(NI.cut,levels=c(0,1))

Tabla.DMGC(I.cut,NI.cut,"No bajo peso","Bajo peso")
```








###  Apgar


```{r}
I=c(Casos$APGAR.5...126,CasosGM$APGAR.5...150)
I[I==19]=NA
NI=c(Controls$APGAR.5...200,ControlsGM$APGAR.5...249)

I.5=cut(I,breaks=c(-1,7,20),labels=c("0-7","8-10"))
NI.5=cut(NI,breaks=c(-1,7,20),labels=c("0-7","8-10"))
I.5=ordered(I.5,levels=c("8-10","0-7"))
NI.5=ordered(NI.5,levels=c("8-10","0-7"))

Tabla.DMGC(I.5,NI.5,"Apgar.5≥8","Apgar.5≤7")
```




### Ingreso de neonatos vivos en UCIN

```{r}
I=c(Casos[Casos$Feto.muerto.intraútero=="No",]$Ingreso.en.UCIN,CasosGM[CasosGM$Feto.vivo=="Sí",]$Ingreso.en.UCI)
NI=c(Controls[Controls$Feto.vivo...194=="Sí",]$Ingreso.en.UCI...213,ControlsGM[ControlsGM$Feto.vivo...245=="Sí",]$Ingreso.en.UCI...260)

Tabla.DMGC(I,NI,"No UCIN","UCIN")

```


# Descripción de la muestra de casos según sintomatología

Hubo:

* `r table(Sint)[1]` infecciones asintomáticas (`r round(100*prop.table(table(Sint))[1],2)`%)

* `r table(Sint)[2]` infecciones leves (`r round(100*prop.table(table(Sint))[2],2)`%)

* `r table(Sint)[3]` infecciones graves (`r round(100*prop.table(table(Sint))[3],2)`%)



```{r sint-1w,fig.cap="\\s"}
Síntomas=ordered(c("Asintomática", "Leve", "Grave"),levels=c("Asintomática", "Leve", "Grave"))
valor=as.vector(prop.table(table(Sint)))
data <- data.frame(Síntomas,valor)

ggplot(data, aes(x=Síntomas, y=valor,fill=Síntomas)) + 
  geom_bar(stat="identity")+
  xlab("")+
  ylab("")+
  scale_fill_brewer(palette = "Dark2") +
  theme(legend.position="none")
```



```{r}
Trim=Casos$Trim.Diag
NA_T=length(Trim[is.na(Trim)])
NA_S=length(Sint[is.na(Sint)])

DF=data.frame(Trimestre=Trim,Síntomas=Sint)
taula=table(DF)[,1:3]
proptaula=round(100*prop.table(table(DF)),2)[,1:3]

EEExt=cbind(c(as.vector(taula[,1]),sum(taula[,1])),
            c(as.vector(proptaula[,1]), round(100*sum(taula[,1])/n_I,2)),
            c(as.vector(taula[,2]),sum(taula[,2])),
            c(as.vector(proptaula[,2]), round(100*sum(taula[,2])/n_I,2)),
            c(as.vector(taula[,3]),sum(taula[,3])),
            c(as.vector(proptaula[,3]), round(100*sum(taula[,3])/n_I,2))
            )
rownames(EEExt)=c("1er trimestre", "2o trimestre", "3er trimestre","Total")
colnames(EEExt)=Columnes.Sint

EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")
```



```{r 13-1w,fig.cap="\\s"}
Síntomas=ordered(rep(c("Asintomática", "Leve", "Grave"), each=3),levels=c("Asintomática", "Leve", "Grave"))
Grupo=rep(c("1er trimestre", "2o trimestre", "3er trimestre") , 3)
valor=as.vector(prop.table(taula, margin=1))
data <- data.frame(Grupo,Síntomas,valor)

ggplot(data, aes(fill=Síntomas, y=valor, x=Grupo)) + 
  geom_bar(position="dodge", stat="identity")+
  xlab("Trimestre de infección")+
  ylab("")+
  scale_fill_brewer(palette = "Dark2") 
```



## Antecedentes maternos

### Edades



```{r}
I=Casos$Edad._años_
DF=data.frame(Edad=I,Sint=Casos$SINTOMAS_DIAGNOSTICO)



DF %>%
  ggplot( aes(x=Sint, y=Edad, fill=Sint)) +
    geom_violin(width=1) +
    geom_boxplot(width=0.1, color="black", alpha=0.2,outlier.fill="black",
               outlier.size=1) +
    theme(
      legend.position="none",
      plot.title=element_text(size=11)
    ) +
    xlab("")+
  ylab("Edades (años)")+
 scale_fill_brewer(palette="Dark2")
```

```{r}
I1=I[Casos$SINTOMAS_DIAGNOSTICO=="Asintomática"]
I2=I[Casos$SINTOMAS_DIAGNOSTICO=="Leve"]
I3=I[Casos$SINTOMAS_DIAGNOSTICO=="Grave"]

Dades=rbind(c(round(min(I1,na.rm=TRUE),1),round(max(I1,na.rm=TRUE),1), round(mean(I1,na.rm=TRUE),1),round(median(I1,na.rm=TRUE),1),round(quantile(I1,c(0.25,0.75),na.rm=TRUE),1), round(sd(I1,na.rm=TRUE),1)),
            c(round(min(I2,na.rm=TRUE),1),round(max(I2,na.rm=TRUE),1), round(mean(I2,na.rm=TRUE),1),round(median(I2,na.rm=TRUE),1),round(quantile(I2,c(0.25,0.75),na.rm=TRUE),1), round(sd(I2,na.rm=TRUE),1)),
            c(round(min(I3,na.rm=TRUE),1),round(max(I3,na.rm=TRUE),1), round(mean(I3,na.rm=TRUE),1),round(median(I3,na.rm=TRUE),1),round(quantile(I3,c(0.25,0.75),na.rm=TRUE),1), round(sd(I3,na.rm=TRUE),1)))

colnames(Dades)=c("Edad mínima","Edad máxima","Edad  media", "Edad  mediana", "1er cuartil", "3er cuartil", "Desv. típica")
rownames(Dades)=c("Asintomática", "Leve","Grave")

Dades %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")


```


```{r,include=FALSE}

shapiro.test(I1)$p.value
shapiro.test(I2)$p.value
shapiro.test(I3)$p.value

kruskal.test(Edad~Sint,data=DF)$p.value

pairwise.wilcox.test(I,Sint,p.adjust.method = "bonferroni")$p.value
```

* Ajuste de las edades maternas a distribuciones normales: test de Shapiro-Wilks, p-valores $`r signif(shapiro.test(I1)$p.value,1)`$, $`r 
signif(shapiro.test(I2)$p.value,1)`$ y `r 
round(shapiro.test(I3)$p.value,4)`, respectivamente




* Edades medias: test de Kruskal-Wallis, p-valor `r kruskal.test(Edad~Sint,data=DF)$p.value`


* Desviaciones típicas: test de Fligner-Killeen, p-valor  `r round(fligner.test(list(I,I2,I3))$p.value,3)`

* Contrastes post hoc por parejas

```{r}
Contraste=c("Asíntomatica vs Leve","Asíntomatica vs Grave", "Leve vs Grave")

pvals=round(3*c(t.test(I1,I2,var.equal=TRUE)$p.value, t.test(I1,I3,var.equal=TRUE)$p.value,
            t.test(I2,I3,var.equal=TRUE)$p.value),4)
dades=data.frame(Contraste=Contraste,"p-valor"=pvals)
dades %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```


En tablas como la que sigue:

* p-valor: El p-valor del test $\chi^2$ de si la distribución de la fila correspondiente en casos sintomáticos es la misma que la del global de la muestra de casos, ajustado por Bonferroni cuando haya más de 2 filas

* Tipo: El tipo de test $\chi^2$, paramétrico, siempre que es posible, o Montecarlo, cuando no se dan las condiciones necesarias para que tenga sentido efectuar el test paramétrico


```{r}
I.cut=cut(I,breaks=c(0,30,40,100),labels=c("18-30","31-40",">40"))
Tabla.DMCasosm(I.cut, c("18-30", "31-40", ">40"))
```


```{r 14-1w,fig.cap="\\s"}
Síntomas=ordered(rep(c("Asintomática", "Leve", "Grave"), each=3),levels=c("Asintomática", "Leve", "Grave"))
Grupo=ordered(rep(c("18-30","31-40",">40") , 3),levels=c("18-30","31-40",">40"))

taula=table(data.frame(Edad=I.cut,Síntomas=Sint))
valor=as.vector(prop.table(taula, margin=1))
data <- data.frame(Grupo,Síntomas,valor)

ggplot(data, aes(fill=Síntomas, y=valor, x=Grupo)) + 
  geom_bar(position="dodge", stat="identity")+
  xlab("Edad")+
  ylab("")+
  scale_fill_brewer(palette = "Dark2") 
```

* Asociación entre los grupos de sintomatología y las franjas de edad: test $\chi^2$, p-valor `r round(chisq.test(taula)$p.value,3)`




### Etnia 



```{r}
I=Casos$Etnia
I[I=="Asia"]="Asiática"
I=factor(I)
Tabla.DMCasosm(I,c("Árabe", "Asiática", "Blanca", "Latinoamericana","Negra"))

```


```{r 15-1w,fig.cap="\\s"}
Síntomas=ordered(rep(c("Asintomática", "Leve", "Grave"), each=5),levels=c("Asintomática", "Leve", "Grave"))
Grupo=ordered(rep(c("Árabe", "Asiática", "Blanca", "Latinoamericana","Negra") , 3),levels=c("Árabe", "Asiática", "Blanca", "Latinoamericana","Negra"))

taula=table(data.frame(Etnia=I,Síntomas=Sint))
valor=as.vector(prop.table(taula, margin=1))
data <- data.frame(Grupo,Síntomas,valor)

ggplot(data, aes(fill=Síntomas, y=valor, x=Grupo)) + 
  geom_bar(position="dodge", stat="identity")+
  xlab("Etnia")+
  ylab("")+
  scale_fill_brewer(palette = "Dark2") 
```

* Asociación entre los grupos de sintomatología y las etnias: test $\chi^2$, p-valor $`r signif(chisq.test(taula)$p.value,1)`$





### Hábito tabáquico


```{r 16-1w,fig.cap="\\s"}
taula=table(data.frame(Casos$FUMADORA_CAT,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(Casos$FUMADORA_CAT,"Fumadoras", "No fumadoras")
Barplot.DGS(Casos$FUMADORA_CAT,"Fumadoras", "No fumadoras")
```


* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`


### Obesidad



```{r 17-1w,fig.cap="\\s"}
taula=table(data.frame(Casos$Obesidad,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(Casos$Obesidad,"Obesas", "No obesas")
Barplot.DGS(Casos$Obesidad,"Obesas", "No obesas")
```


* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`


### Hipertensión pregestacional



```{r 18-1w,fig.cap="\\s"}
taula=table(data.frame(Casos$Hipertensión.pregestacional,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(Casos$Hipertensión.pregestacional,"HTA", "No HTA")
Barplot.DGS(Casos$Hipertensión.pregestacional,"HTA", "No HTA")
```


* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`

### Diabetes



```{r 19-1w,fig.cap="\\s"}
taula=table(data.frame(Casos$DIABETES,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(Casos$DIABETES,"DM", "No DM")
Barplot.DGS(Casos$DIABETES,"DM", "No DM")
```



* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`

### Cardiopatía



```{r 20-1w,fig.cap="\\s"}
taula=table(data.frame(Casos$Enfermedad.cardiaca.crónica,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(Casos$Enfermedad.cardiaca.crónica,"ECC", "No ECC")
Barplot.DGS(Casos$Enfermedad.cardiaca.crónica,"ECC", "No ECC")
```


* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`

### Enfermedad pulmonar crónica 



```{r 21-1w,fig.cap="\\s"}
INA=Casos$Enfermedad.pulmonar.crónica.no.asma
IA=Casos$Diagnóstico.clínico.de.Asma
I.EPC=rep(NA,length(Sint))
for (i in 1:length(Sint)){I.EPC[i]=max(INA[i],IA[i],na.rm=TRUE)}
taula=table(data.frame(I.EPC,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(I.EPC,"EPC", "No EPC")
Barplot.DGS(I.EPC,"EPC", "No EPC")
```



* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`

### Gestación múltiple



```{r 22-1w,fig.cap="\\s"}
taula=table(data.frame(Casos$Gestación.Múltiple,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(Casos$Gestación.Múltiple,"Gestación múltiple", "Gestación única")
Barplot.DGS(Casos$Gestación.Múltiple,"Gestación múltiple", "Gestación única")
```



* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`

### Paridad



```{r 23-1w,fig.cap="\\s"}
taula=table(data.frame(Casos$NULIPARA,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(Casos$NULIPARA,"Multípara", "Nulípara")
Barplot.DGS(Casos$NULIPARA,"Multípara", "Nulípara")
```


* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`

## Desenlaces



### Anomalía congénita





```{r 24-1w,fig.cap="\\s"}
taula=table(data.frame(Casos$Diagnóstico.de.malformación.ecográfica._.semana.20._,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(Casos$Diagnóstico.de.malformación.ecográfica._.semana.20._,"Anomalías congénitas", "No anomalías congénitas")
Barplot.DGS(Casos$Diagnóstico.de.malformación.ecográfica._.semana.20._,"Anomalías congénitas", "No anomalías congénitas")
```


* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`

### Retraso del crecimiento intrauterino 





```{r 25-1w,fig.cap="\\s"}
taula=table(data.frame(Casos$Defecto.del.crecimiento.fetal..en.tercer.trimestre._.CIR._.,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(Casos$Defecto.del.crecimiento.fetal..en.tercer.trimestre._.CIR._.,"RCIU", "No RCIU")
Barplot.DGS(Casos$Defecto.del.crecimiento.fetal..en.tercer.trimestre._.CIR._.,"RCIU", "No RCIU")
```


* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`

### Diabetes gestacional 




```{r 26-1w,fig.cap="\\s"}
taula=table(data.frame(Casos$Diabetes.gestacional,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(Casos$Diabetes.gestacional,"DG", "No DG")
Barplot.DGS(Casos$Diabetes.gestacional,"DG", "No DG")
```

* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`

### Hipertensión gestacional



```{r 27-1w,fig.cap="\\s"}
taula=table(data.frame(Casos$Hipertensión.gestacional,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(Casos$Hipertensión.gestacional,"HG", "No HG")
Barplot.DGS(Casos$Hipertensión.gestacional,"HG", "No HG")
```


* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`

### Rotura prematura de membranas


```{r 28-1w,fig.cap="\\s"}
taula=table(data.frame(Casos$Bolsa.rota.anteparto,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(Casos$Bolsa.rota.anteparto,"RPM", "No RPM")
Barplot.DGS(Casos$Bolsa.rota.anteparto,"RPM", "No RPM")
```



* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`

### Preeclampsia




```{r 29-1w,fig.cap="\\s"}
taula=table(data.frame(Casos$PREECLAMPSIA_ECLAMPSIA_TOTAL,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(Casos$PREECLAMPSIA_ECLAMPSIA_TOTAL,"PE", "No PE")
Barplot.DGS(Casos$PREECLAMPSIA_ECLAMPSIA_TOTAL,"PE", "No PE")
```




* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`

### Preeclampsia con criterios de gravedad




```{r}
I=Casos[Casos$PREECLAMPSIA_ECLAMPSIA_TOTAL==1,]$Preeclampsia.grave_HELLP_ECLAMPSIA
IA=Casos[Casos$PREECLAMPSIA_ECLAMPSIA_TOTAL==1 & Casos$SINTOMAS_DIAGNOSTICO=="Asintomática",]$Preeclampsia.grave_HELLP_ECLAMPSIA
IL=Casos[Casos$PREECLAMPSIA_ECLAMPSIA_TOTAL==1 & Casos$SINTOMAS_DIAGNOSTICO=="Leve",]$Preeclampsia.grave_HELLP_ECLAMPSIA
IG=Casos[Casos$PREECLAMPSIA_ECLAMPSIA_TOTAL==1 & Casos$SINTOMAS_DIAGNOSTICO=="Grave",]$Preeclampsia.grave_HELLP_ECLAMPSIA

taula=table(data.frame(I,Sint[Casos$PREECLAMPSIA_ECLAMPSIA_TOTAL==1]))
Tabla.DMCasosr(IA,IL,IG,"PE con CG", "PE sin CG")
Barplot.DGSalt(I,Sint[Casos$PREECLAMPSIA_ECLAMPSIA_TOTAL==1],"PE con CG", "PE sin CG")
```




* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`


### Eventos hemorrágicos




```{r 31-1w,fig.cap="\\s"}
taula=table(data.frame(Casos$EVENTOS_HEMORRAGICOS_TOTAL,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(Casos$EVENTOS_HEMORRAGICOS_TOTAL,"Eventos hemorrágicos", "No eventos hemorrágicos")
Barplot.DGS(Casos$EVENTOS_HEMORRAGICOS_TOTAL,"Eventos hemorrágicos", "No eventos hemorrágicos")
```




* Asociación entre los grupos de sintomatología y evento hemorrágico: test $\chi^2$, p-valor `r round(chisq.test(taula)$p.value,3)`


* Test de diferencia en la tendencia de la gravedad respecto del global: p-valor `r round(Prop.trend.test(taula[1,],colSums(taula)),4)`


* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`

### Hemorragia postparto



```{r 59-1w,fig.cap="\\s"}
I=Casos$Hemorragia.postparto
I.sino=I
I.sino[!is.na(I.sino)& I.sino!="No"]="Sí"
taula=table(data.frame(I.sino,Sint))[c(2,1) ,1:3]

Tabla.DMCasos(I.sino,"HPP", "No HPP")
Barplot.DGS(I.sino,"HPP", "No HPP")
```






* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`



```{r}
I=ordered(I,levels=names(table(I))[c(2,3,1,4)])
Tabla.DMCasosm(I,c("Tto. médico",
  "Tto. Qx. conservador" , "Histerectomía",                
"No") ,r=6)
```


```{r 32-1w,fig.cap="\\s"}
DF=data.frame(Factor=I,Síntomas=Sint)
taula=table(DF)

Síntomas=ordered(rep(c("Asintomática", "Leve", "Grave"), each=4),levels=c("Asintomática", "Leve", "Grave"))
Grupo=ordered(rep(c("Tto. médico",
  "Tto. Qx. conservador" , "Histerectomía" ,          
"No") , 3),levels=c("Tto. médico",
  "Tto. Qx. conservador" , "Histerectomía",          
"No"))
valor=as.vector(prop.table(taula, margin=1))
data <- data.frame(Grupo,Síntomas,valor)

ggplot(data, aes(fill=Síntomas, y=valor, x=Grupo)) + 
  geom_bar(position="dodge", stat="identity")+
  ylab("")+
  xlab("")+
  scale_fill_brewer(palette = "Dark2") 
```

* Asociación entre los grupos de sintomatología y el tipo de hemorragia postparto: test $\chi^2$ de Montecarlo, p-valor `r  round(chisq.test(taula[1:3,],simulate.p.value=TRUE,B=10000)$p.value,3)`

* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula[1:3,])$statistic/sum(taula[1:3,])), N =sum(taula[1:3,]) , df =chisq.test(taula[1:3,])$parameter, sig.level =0.05 )$power,3)`



### Eventos trombóticos




```{r 33-1w,fig.cap="\\s"}
taula=table(data.frame(Casos$EVENTOS_TROMBO_TOTALES,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(Casos$EVENTOS_TROMBO_TOTALES,"Eventos trombóticos", "No eventos trombóticos")
Barplot.DGS(Casos$EVENTOS_TROMBO_TOTALES,"Eventos trombóticos", "No eventos trombóticos")
```

* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`

### UCI materna (Sí-No)


```{r 34-1w,fig.cap="\\s"}
taula=table(data.frame(Casos$UCI,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(Casos$UCI,"UCI", "No UCI")
Barplot.DGS(Casos$UCI,"UCI", "No UCI")
```



* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`

### UCI materna (antes-después)


```{r}
I=Casos$UCI_ANTES.DESPUES.DEL.PARTO[Casos$UCI==1]
IA=Casos[Casos$UCI==1 & Casos$SINTOMAS_DIAGNOSTICO=="Asintomática",]$UCI_ANTES.DESPUES.DEL.PARTO
IA=factor(IA,levels=c("ANTES DEL PARTO","DESPUES DEL PARTO"))
IL=Casos[Casos$UCI==1 & Casos$SINTOMAS_DIAGNOSTICO=="Leve",]$UCI_ANTES.DESPUES.DEL.PARTO
IL=factor(IL,levels=c("ANTES DEL PARTO","DESPUES DEL PARTO"))
IG=Casos[Casos$UCI==1 & Casos$SINTOMAS_DIAGNOSTICO=="Grave",]$UCI_ANTES.DESPUES.DEL.PARTO
IG=factor(IG,levels=c("ANTES DEL PARTO","DESPUES DEL PARTO"))

taula=table(data.frame(I,Sint[Casos$UCI==1]))
Tabla.DMCasosr(IA,IL,IG,"UCI antes del parto", "UCI después del parto")
Barplot.DGSalt(I,Sint[Casos$UCI==1],"UCI antes del parto", "UCI después del parto")

```



* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`

### Prematuridad



```{r 36-1w,fig.cap="\\s"}
taula=table(data.frame(Casos$PREMATURO,Sint))[c(2,1) ,1:3]
Tabla.DMCasos(Casos$PREMATURO,"Prematuro", "A término")
Barplot.DGS(Casos$PREMATURO,"Prematuro", "A término")
```



* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`




### Inicio de parto



```{r}
I=Casos$Inicio.de.parto
I=factor(I,levels=c("Espontáneo", "Inducido", "Cesárea"),ordered=TRUE)
DF=data.frame(Factor=I,Síntomas=Sint)
taula=table(DF)
Tabla.DMCasosm(I,c("Espontáneo", "Inducido","Cesárea programada"))

```


```{r 39-1w,fig.cap="\\s"}
Síntomas=ordered(rep(c("Asintomática", "Leve", "Grave"), each=3),levels=c("Asintomática", "Leve", "Grave"))
Grupo=ordered(rep(rownames(EEExt)[1:3] , 3),levels=rownames(EEExt)[1:3])
valor=as.vector(prop.table(taula, margin=1))
data <- data.frame(Grupo,Síntomas,valor)

ggplot(data, aes(fill=Síntomas, y=valor, x=Grupo)) + 
  geom_bar(position="dodge", stat="identity")+
  ylab("")+
  xlab("Inicio de parto")+
  scale_fill_brewer(palette = "Dark2") 
```

* Asociación entre los grupos de sintomatología y el inicio de parto: test $\chi^2$, p-valor $`r signif(chisq.test(taula)$p.value,1)`$






### Tipo de parto



```{r}
I.In=Casos$Inicio.de.parto
I.In[I.In=="Cesárea"]="Cesárea programada"
I=Casos$Tipo.de.parto
I[I.In=="Cesárea programada"]="Cesárea programada"
I[I=="Cesárea"]="Cesárea urgente"

I=factor(I,levels=c("Eutocico", "Instrumental", "Cesárea programada", "Cesárea urgente"),ordered=TRUE)
DF=data.frame(Factor=I,Síntomas=Sint)
taula=table(DF)
Tabla.DMCasosm(I,c("Eutócico", "Instrumental", "Cesárea programada", "Cesárea urgente"))
```



```{r 40-1w,fig.cap="\\s"}
Síntomas=ordered(rep(c("Asintomática", "Leve", "Grave"), each=4),levels=c("Asintomática", "Leve", "Grave"))
Grupo=ordered(rep(c("Eutócico", "Instrumental", "Cesárea programada", "Cesárea urgente") , 3),levels=c("Eutócico", "Instrumental", "Cesárea programada", "Cesárea urgente"))
valor=as.vector(prop.table(taula, margin=1))
data <- data.frame(Grupo,Síntomas,valor)

ggplot(data, aes(fill=Síntomas, y=valor, x=Grupo)) + 
  geom_bar(position="dodge", stat="identity")+
  ylab("")+
  xlab("Tipo de parto")+
  scale_fill_brewer(palette = "Dark2") 
```

* Asociación entre los grupos de sintomatología y tipos de parto: test $\chi^2$, p-valor $`r signif(chisq.test(taula)$p.value,1)`$

* Asociación entre los grupos de sintomatología y tipos de parto diferentes de la cesárea programada: test $\chi^2$, p-valor `r round(chisq.test(taula[-3,])$p.value,3)`




### APGAR


```{r}
I=c(Casos$APGAR.5...126,CasosGM$APGAR.5...150)
I[I==19]=NA
I=cut(I,breaks=c(-1,7,20),labels=c("0-7","8-10"))
I=ordered(I,levels=c("8-10","0-7"))
SintN=c(Casos$SINTOMAS_DIAGNOSTICO,CasosGM$SINTOMAS_DIAGNOSTICO)

taula=table(data.frame(I,SintN))[c(2,1) ,1:3]
Tabla.DMCasos(I,"Apgar.5≤7","Apgar.5≥8")
Barplot.DGSalt(I,SintN,"Apgar.5≤7","Apgar.5≥8")
```


* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`


### Sintomatología vs UCI neonato



```{r}
I=c(Casos[Casos$Feto.muerto.intraútero=="No",]$Ingreso.en.UCIN,CasosGM[CasosGM$Feto.vivo=="Sí",]$Ingreso.en.UCI)

IA=c(Casos[Casos$SINTOMAS_DIAGNOSTICO=="Asintomática"&Casos$Feto.muerto.intraútero=="No",]$Ingreso.en.UCIN,CasosGM[CasosGM$SINTOMAS_DIAGNOSTICO=="Asintomática" & CasosGM$Feto.vivo=="Sí",]$Ingreso.en.UCI)

IL=c(Casos[Casos$SINTOMAS_DIAGNOSTICO=="Leve"&Casos$Feto.muerto.intraútero=="No",]$Ingreso.en.UCIN,CasosGM[CasosGM$SINTOMAS_DIAGNOSTICO=="Leve" & CasosGM$Feto.vivo=="Sí",]$Ingreso.en.UCI)

IG=c(Casos[Casos$SINTOMAS_DIAGNOSTICO=="Grave"&Casos$Feto.muerto.intraútero=="No",]$Ingreso.en.UCIN,CasosGM[CasosGM$SINTOMAS_DIAGNOSTICO=="Grave" & CasosGM$Feto.vivo=="Sí",]$Ingreso.en.UCI)

SintN=c(Casos[Casos$Feto.muerto.intraútero=="No",]$SINTOMAS_DIAGNOSTICO,CasosGM[CasosGM$Feto.vivo=="Sí",]$SINTOMAS_DIAGNOSTICO)

taula=table(data.frame(I,SintN))[c(2,1) ,1:3]
Tabla.DMCasosr(IA,IL,IG,"UCIN", "No UCIN")
Barplot.DGSalt(I,SintN,"UCIN", "No UCIN")
```





* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`


### Sintomatología vs Fetos muertos anteparto 



```{r}
I1=Casos$Feto.muerto.intraútero
I1[I1=="Sí"]="Muerto"
I1[I1=="No"]="Vivo"
I1=ordered(I1,levels=c("Vivo","Muerto"))
I1A=I1[Casos$SINTOMAS_DIAGNOSTICO=="Asintomática"]
I1L=I1[Casos$SINTOMAS_DIAGNOSTICO=="Leve"]
I1G=I1[Casos$SINTOMAS_DIAGNOSTICO=="Grave"]

I2=CasosGM$Feto.vivo
I2[I2=="Sí"]="Vivo"
I2[I2=="No"]="Muerto"
I2=ordered(I2,levels=c("Vivo","Muerto"))
I2A=I2[CasosGM$SINTOMAS_DIAGNOSTICO=="Asintomática"]
I2L=I2[CasosGM$SINTOMAS_DIAGNOSTICO=="Leve"]
I2G=I2[CasosGM$SINTOMAS_DIAGNOSTICO=="Grave"]

IA=c(I1A,I2A)
IL=c(I1L,I2L)
IG=c(I1G,I2G)



I=c(I1,I2)
SintN1=Casos$SINTOMAS_DIAGNOSTICO
SintN2=CasosGM$SINTOMAS_DIAGNOSTICO
SintN=c(SintN1,SintN2)

taula=table(data.frame(I,SintN))[c(2,1) ,1:3]
Tabla.DMCasosr(IA,IL,IG,"Feto muerto anteparto", "Feto vivo")
Barplot.DGSalt(I,SintN,"Feto muerto anteparto", "Feto vivo")
```

* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`




### Edades gestacionales




```{r 41-1w,fig.cap="\\s"}
I=Casos$EG_TOTAL_PARTO
Síntomas=ordered(Sint,levels=c("Asintomática" ,"Leve",      "Grave"  ))
data =data.frame(
  Síntomas,
  Edades=I
)

data %>%
  ggplot( aes(x=Síntomas, y=Edades, fill=Síntomas)) +
    geom_violin(width=1) +
    geom_boxplot(width=0.1, color="black", alpha=0.2,outlier.fill="black",
               outlier.size=1) +
    theme(
      legend.position="none",
      plot.title = element_text(size=11)
    ) +
    xlab("")+
   ylab("Edades gestacionales (semanas)")+
  scale_fill_brewer(palette = "Dark2") 

```


```{r}
Dades=rbind(c(round(min(I[data$Síntomas=="Asintomática"],na.rm=TRUE),1),round(max(I[data$Síntomas=="Asintomática"],na.rm=TRUE),1), round(mean(I[data$Síntomas=="Asintomática"],na.rm=TRUE),1),
              round(median(I[data$Síntomas=="Asintomática"],na.rm=TRUE),1),
              round(quantile(I[data$Síntomas=="Asintomática"],c(0.25,0.75),na.rm=TRUE),1),
              round(sd(I[data$Síntomas=="Asintomática"],na.rm=TRUE),1)),
   c(round(min(I[data$Síntomas=="Leve"],na.rm=TRUE),1),round(max(I[data$Síntomas=="Leve"],na.rm=TRUE),1), round(mean(I[data$Síntomas=="Leve"],na.rm=TRUE),1),
       round(median(I[data$Síntomas=="Leve"],na.rm=TRUE),1),
              round(quantile(I[data$Síntomas=="Leve"],c(0.25,0.75),na.rm=TRUE),1),round(sd(I[data$Síntomas=="Leve"],na.rm=TRUE),1)),         
  c(round(min(I[data$Síntomas=="Grave"],na.rm=TRUE),1),round(max(I[data$Síntomas=="Grave"],na.rm=TRUE),1), round(mean(I[data$Síntomas=="Grave"],na.rm=TRUE),1),round(median(I[data$Síntomas=="Grave"],na.rm=TRUE),1),
              round(quantile(I[data$Síntomas=="Grave"],c(0.25,0.75),na.rm=TRUE),1),round(sd(I[data$Síntomas=="Grave"],na.rm=TRUE),1))          )

colnames(Dades)=c("Edad gest. mínima","Edad gest.  máxima","Edad gest.  media",
                  "Edad gest. mediana", "1er cuartil", "3er cuartil","Desv. típica")
rownames(Dades)=c("Asintomática" ,"Leve",      "Grave"  )

Dades %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")


```

```{r,include=FALSE}

shapiro.test(I)$p.value
kruskal.test(Factor~Síntomas,data=DF)$p.value

pairwise.wilcox.test(I,Sint,p.adjust.method = "bonferroni")$p.value
```

* Ajuste de las edades gestacionales de cada nivel a distribuciones normales: test de Shapiro-Wilks, p-valores $`r signif(shapiro.test(I[Sint=="Asintomática"])$p.value,1)`$, $`r signif(shapiro.test(I[Sint=="Leve"])$p.value,1)`$, $`r signif(shapiro.test(I[Sint=="Grave"])$p.value,1)`$, respectivamente

* Homocedasticidad: Test de Fligner-Killeen, p-valor $`r signif(fligner.test(I~Sint)$p.value,1)`$ 

* Edades gestacionales medias: test de Kruskal-Wallis, p-valor  $`r signif(kruskal.test(I~Síntomas,data=DF)$p.value,1)`$

* Contrastes posteriores de edades gestacionales medias por parejas:  tests de Mann-Whitney,p-valores ajustados por Bonferroni:

    * Asintomática vs Leve: `r round(pairwise.wilcox.test(I,Sint,p.adjust.method = "bonferroni")$p.value[1,1],3)`
    * Asintomática vs Grave: $`r signif(pairwise.wilcox.test(I,Sint,p.adjust.method = "bonferroni")$p.value[2,1],1)`$
    * Leve  vs Grave: $`r signif(pairwise.wilcox.test(I,Sint,p.adjust.method = "bonferroni")$p.value[2,2],1)`$

    



### Pesos hijos infectadas


```{r 42-1w,fig.cap="\\s"}
SintN=c(Casos[Casos$Feto.muerto.intraútero=="No",]$SINTOMAS_DIAGNOSTICO,CasosGM[CasosGM$Feto.vivo=="Sí",]$SINTOMAS_DIAGNOSTICO)
Síntomas=SintN[!is.na(SintN)]

I=c(Casos[Casos$Feto.muerto.intraútero=="No",]$Peso._gramos_...125,CasosGM[CasosGM$Feto.vivo=="Sí",]$Peso._gramos_...148)
I=I[!is.na(SintN)]

data =data.frame(
  Síntomas,
  Pesos=I
)

data %>%
  ggplot( aes(x=Síntomas, y=Pesos, fill=Síntomas)) +
    geom_violin(width=1) +
    geom_boxplot(width=0.1, color="black", alpha=0.2,outlier.fill="black",
               outlier.size=1) +
    theme(
      legend.position="none",
      plot.title = element_text(size=11)
    ) +
    xlab("")+
   ylab("Pesos (gramos)")+
  scale_fill_brewer(palette = "Dark2") 
```



```{r}
Dades=rbind(c(round(min(I[data$Síntomas=="Asintomática"],na.rm=TRUE),1),round(max(I[data$Síntomas=="Asintomática"],na.rm=TRUE),1), round(mean(I[data$Síntomas=="Asintomática"],na.rm=TRUE),1),
              round(median(I[data$Síntomas=="Asintomática"],na.rm=TRUE),1),
              round(quantile(I[data$Síntomas=="Asintomática"],c(0.25,0.75),na.rm=TRUE),1),
              round(sd(I[data$Síntomas=="Asintomática"],na.rm=TRUE),1)),
   c(round(min(I[data$Síntomas=="Leve"],na.rm=TRUE),1),round(max(I[data$Síntomas=="Leve"],na.rm=TRUE),1), round(mean(I[data$Síntomas=="Leve"],na.rm=TRUE),1),
       round(median(I[data$Síntomas=="Leve"],na.rm=TRUE),1),
              round(quantile(I[data$Síntomas=="Leve"],c(0.25,0.75),na.rm=TRUE),1),round(sd(I[data$Síntomas=="Leve"],na.rm=TRUE),1)),         
  c(round(min(I[data$Síntomas=="Grave"],na.rm=TRUE),1),round(max(I[data$Síntomas=="Grave"],na.rm=TRUE),1), round(mean(I[data$Síntomas=="Grave"],na.rm=TRUE),1),round(median(I[data$Síntomas=="Grave"],na.rm=TRUE),1),
              round(quantile(I[data$Síntomas=="Grave"],c(0.25,0.75),na.rm=TRUE),1),round(sd(I[data$Síntomas=="Grave"],na.rm=TRUE),1))          )
colnames(Dades)=c("Peso. mínimo","Peso.  máximo","Peso.  medio","Peso mediano", "1er cuartil", "3er cuartil","Desv. típica")
rownames(Dades)=c("Asintomática" ,"Leve",      "Grave"  )

Dades %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")


```

```{r,include=FALSE}
shapiro.test(I)$p.value
kruskal.test(I~Síntomas)$p.value
```

* Ajuste de los pesos de cada nivel a distribuciones normales: test de Shapiro-Wilks, p-valores $`r signif(shapiro.test(I[Sint=="Asintomática"])$p.value,1)`$, $`r signif(shapiro.test(I[Sint=="Leve"])$p.value,1)`$, $`r signif(shapiro.test(I[Sint=="Grave"])$p.value,1)`$, respectivamente

* Homocedasticidad: Test de Fligner-Killeen, p-valor `r round(fligner.test(I~Síntomas)$p.value,3)`


* Pesos medios: test de Kruskal-Wallis, p-valor  `r round(kruskal.test(I~Síntomas)$p.value,3)`


### Bajo peso



```{r}
I=c(Casos[Casos$Feto.muerto.intraútero=="No",]$Peso._gramos_...125,CasosGM[CasosGM$Feto.vivo=="Sí",]$Peso._gramos_...148)
I.cut=cut(I,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)
I.cut=ordered(I.cut,levels=c(0,1))

IA=c(Casos[Casos$Feto.muerto.intraútero=="No" &Casos$SINTOMAS_DIAGNOSTICO=="Asintomática" ,]$Peso._gramos_...125,CasosGM[CasosGM$Feto.vivo=="Sí"&CasosGM$SINTOMAS_DIAGNOSTICO=="Asintomática",]$Peso._gramos_...148)
IA.cut=cut(IA,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)
IA.cut=ordered(IA.cut,levels=c(0,1))

IL=c(Casos[Casos$Feto.muerto.intraútero=="No" &Casos$SINTOMAS_DIAGNOSTICO=="Leve" ,]$Peso._gramos_...125,CasosGM[CasosGM$Feto.vivo=="Sí"&CasosGM$SINTOMAS_DIAGNOSTICO=="Leve",]$Peso._gramos_...148)
IL.cut=cut(IL,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)
IL.cut=ordered(IL.cut,levels=c(0,1))

IG=c(Casos[Casos$Feto.muerto.intraútero=="No" &Casos$SINTOMAS_DIAGNOSTICO=="Grave" ,]$Peso._gramos_...125,CasosGM[CasosGM$Feto.vivo=="Sí"&CasosGM$SINTOMAS_DIAGNOSTICO=="Grave",]$Peso._gramos_...148)
IG.cut=cut(IG,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)
IG.cut=ordered(IG.cut,levels=c(0,1))



SintN=c(Casos[Casos$Feto.muerto.intraútero=="No",]$SINTOMAS_DIAGNOSTICO,CasosGM[CasosGM$Feto.vivo=="Sí",]$SINTOMAS_DIAGNOSTICO)

taula=table(data.frame(I.cut,SintN))[c(2,1) ,1:3]
Tabla.DMCasosr(IA.cut,IL.cut,IG.cut,"Bajo peso", "No bajo peso")
Barplot.DGSalt(I.cut,SintN,"Bajo peso", "No bajo peso")
```



* Potencia del test: `r round(pwr.chisq.test(w =sqrt(chisq.test(taula)$statistic/sum(taula)), N =sum(taula) , df =chisq.test(taula)$parameter, sig.level =0.05 )$power,3)`


