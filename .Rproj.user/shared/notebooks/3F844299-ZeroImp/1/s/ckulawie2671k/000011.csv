"0","# Per a cada i, calcula una p a l'atzar dins cada un dels altres CI-W, "
"0","# per a i l'agafa de manera que la suma sigui 1 i estigui dins el seu CI-W"
"0","Passada=function(i,Ints){"
"0","p=-1"
"0","while (p<Ints[i,1]|p>Ints[i,2]){"
"0","I=apply(Ints[,1:2],1,PSamp)"
"0","I[i]=1-sum(I[-i])"
"0","p=I[i]"
"0","}"
"0","return(I)  "
"0","}"
"0",""
"0","# Per a cada i aplica Passada i al final fa la mitjana"
"0","Z.Imp.1=function(x,cl=0.95){"
"0","  if (length(x[x==0])>0){"
"0"," Ints=CIW(x,c.l=cl)"
"0"," Res=matrix(0,nrow=length(x),ncol=length(x))"
"0","for (i in 1:length(x)){"
"0","Res[,i]=Passada(i,Ints)"
"0","}"
"0","return(apply(Res,1,mean)*sum(x))"
"0","  }"
"0","  else {"
"0","    return(x)"
"0","  }"
"0","}  "
"0",""
"0","ZImp=Z.Imp.1(EG)"
"0","mean(abs(EG-ZImp))"
"1","[1]"
"1"," 0.9628119"
"1","
"
