"0","ComparOlasRR.m=function(I1,I2,NI1,NI2,L,r=6){"
"0","Tot1w=c(I1,NI1)"
"0","Tot2w=c(I2,NI2)"
"0","NA_I1=length(I1[is.na(I1)])"
"0","NA_NI1=length(NI1[is.na(NI1)])"
"0","NA_I2=length(I2[is.na(I2)])"
"0","NA_NI2=length(NI2[is.na(NI2)])"
"0",""
"0",""
"0","EE=cbind(as.vector(table(I1)),"
"0","         as.vector(table(NI1)),"
"0","         as.vector(table(I2)),"
"0","         as.vector(table(NI2)))"
"0",""
"0","EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))"
"0",""
"0","RA=rep(NA,dim(EE)[1])"
"0","RR=rep(NA,dim(EE)[1])"
"0","p.RARA=rep(NA,dim(EE)[1])"
"0","IC.RARA.1=rep(NA,dim(EE)[1])"
"0","IC.RARA.2=rep(NA,dim(EE)[1])"
"0","p.RRRR=rep(NA,dim(EE)[1])"
"0","IC.RRRR.1=rep(NA,dim(EE)[1])"
"0","IC.RRRR.2=rep(NA,dim(EE)[1])"
"0",""
"0","FTGlob1=rep(NA,dim(EE)[1])"
"0","FTGlob2=rep(NA,dim(EE)[1])"
"0","FTGlob3=rep(NA,dim(EE)[1])"
"0",""
"0","for (i in 1: dim(EE)[1]){"
"0","  EEt=rbind(EE[i,],colSums(EE[-i,]))"
"0","  EETott=rbind(EETot[i,],colSums(EETot[-i,])) "
"0","  e=EEt[1,]"
"0","  n=colSums(EEt)"
"0","  p=e/n"
"0","  "
"0","  RA[i]=round((p[1]-p[2])-(p[3]-p[4]),4)"
"0","  RR[i]=round((p[1]/p[2])/(p[3]/p[4]),4)"
"0","  p.RARA[i]=RA.RA(EEt)[1]"
"0","  IC.RARA.1[i]=RA.RA(EEt)[2]"
"0","  IC.RARA.2[i]=RA.RA(EEt)[3]"
"0","  p.RRRR[i]=RR.RR(EEt)[2]"
"0","  IC.RRRR.1[i]=RR.RR(EEt)[3]"
"0","  IC.RRRR.2[i]=RR.RR(EEt)[4]"
"0"," "
"0","  FTGlob1[i]=fisher.test(EETott)$p.value"
"0","  FTGlob2[i]=fisher.test(EEt[,c(1,3)])$p.value"
"0","  FTGlob3[i]=fisher.test(EEt[,c(2,4)])$p.value"
"0","}"
"0","p.RARA=round(p.adjust(p.RARA,method=""bonferroni""),r)"
"0","p.RRRR=round(p.adjust(p.RRRR,method=""bonferroni""),r)"
"0","FTGlob1=round(p.adjust(FTGlob1,method=""bonferroni""),r)"
"0","FTGlob2=round(p.adjust(FTGlob2,method=""bonferroni""),r)"
"0","FTGlob3=round(p.adjust(FTGlob3,method=""bonferroni""),r)"
"0",""
"0",""
"0",""
"0",""
"0","EEExt=cbind(c(as.vector(table(I1)),NA_I1),"
"0","            c(round(100*as.vector(prop.table(table(I1))),1),NA),"
"0","            c(as.vector(table(NI1)),NA_NI1),"
"0","            c(round(100*as.vector(prop.table(table(NI1))),1),NA),"
"0","            c(as.vector(table(I2)),NA_I2),"
"0","            c(round(100*as.vector(prop.table(table(I2))),1),NA),"
"0","            c(as.vector(table(NI2)),NA_NI2),"
"0","            c(round(100*as.vector(prop.table(table(NI2))),1),NA),"
"0","            c(round(RA,2),NA),"
"0","            c(round(IC.RARA.1,2),NA),"
"0","            c(round(IC.RARA.1,2),NA),"
"0","            c(p.RARA,NA),"
"0","            c(round(RR,2),NA),"
"0","            c(round(IC.RRRR.1,2),NA),"
"0","            c(round(IC.RRRR.1,2),NA),"
"0","            c(p.RRRR,NA),"
"0","            c(FTGlob1,NA),"
"0","            c(FTGlob2,NA),"
"0","            c(FTGlob3,NA)"
"0",")"
"0","colnames(EEExt)=c(ColumnesExt,""Diferencia RA"", ""Extr. inf. IC RA"", "
"0","                  ""Extr. sup. IC RA"", ""p-valor igualdad RA"",""Cociente RR"", ""Extr. inf. IC RR"",  ""Extr. sup. IC RR"", ""p-valor igualdad RR"",""p-valor global olas"", ""p-valor casos"",""p-valor controles"")"
"0","rownames(EEExt)=c(L,""Datos perdidos"")"
"0",""
"0","EEExt %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")  "
"0","}"
