"0","ComparOlasCCm=function(I1,I2,NI1,NI2,L,r=6){"
"0","Tot1w=c(I1,NI1)"
"0","Tot2w=c(I2,NI2)"
"0","NA_I1=length(I1[is.na(I1)])"
"0","NA_NI1=length(NI1[is.na(NI1)])"
"0","NA_I2=length(I2[is.na(I2)])"
"0","NA_NI2=length(NI2[is.na(NI2)])"
"0",""
"0","EE=cbind(as.vector(table(I1)),"
"0","         as.vector(table(NI1)),"
"0","         as.vector(table(I2)),"
"0","         as.vector(table(NI2)))"
"0","EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))"
"0",""
"0",""
"0","OR1=rep(NA,dim(EE)[1])"
"0","OR2=rep(NA,dim(EE)[1])"
"0","QOR=rep(NA,dim(EE)[1])"
"0","pp=rep(NA,dim(EE)[1])"
"0","IC1=rep(NA,dim(EE)[1])"
"0","IC2=rep(NA,dim(EE)[1])"
"0","FTGlob1=rep(NA,dim(EE)[1])"
"0","FTGlob2=rep(NA,dim(EE)[1])"
"0","FTGlob3=rep(NA,dim(EE)[1])"
"0",""
"0","for (i in 1: dim(EE)[1]){"
"0","EEt=rbind(EE[i,],colSums(EE[-i,]))"
"0","EETott=rbind(EETot[i,],colSums(EETot[-i,])) "
"0","QOR[i]=fisher.test(EEt[,1:2])$estimate/fisher.test(EEt[,3:4])$estimate"
"0","pp[i]=OR.OR(EEt)[1]"
"0","IC1[i]=OR.OR(EEt)[2]"
"0","IC2[i]=OR.OR(EEt)[3]"
"0","FTGlob1[i]=fisher.test(EETott)$p.value"
"0","FTGlob2[i]=fisher.test(EEt[,c(1,3)])$p.value"
"0","FTGlob3[i]=fisher.test(EEt[,c(2,4)])$p.value"
"0","}"
"0","pp=round(p.adjust(pp,method=""bonferroni""),r)"
"0","FTGlob1=round(p.adjust(FTGlob1,method=""bonferroni""),r)"
"0","FTGlob2=round(p.adjust(FTGlob2,method=""bonferroni""),r)"
"0","FTGlob3=round(p.adjust(FTGlob3,method=""bonferroni""),r)"
"0",""
"0",""
"0","EEExt=cbind(c(as.vector(table(I1)),NA_I1),"
"0","            c(round(100*as.vector(prop.table(table(I1))),1),NA),"
"0","            c(as.vector(table(NI1)),NA_NI1),"
"0","            c(round(100*as.vector(prop.table(table(NI1))),1),NA),"
"0","            c(as.vector(table(I2)),NA_I2),"
"0","            c(round(100*as.vector(prop.table(table(I2))),1),NA),"
"0","            c(as.vector(table(NI2)),NA_NI2),"
"0","            c(round(100*as.vector(prop.table(table(NI2))),1),NA),"
"0","            c(round(QOR,2),NA),"
"0","            c(round(IC1,2),NA),"
"0","            c(round(IC2,2),NA),"
"0","            c(pp,NA),"
"0","            c(FTGlob1,NA),"
"0","            c(FTGlob2,NA),"
"0","            c(FTGlob3,NA)"
"0","            )"
"0","colnames(EEExt)=c(ColumnesExt,""Cociente de OR"", ""Extr. inf. IC"",  ""Extr. sup. IC"", ""p-valor igualdad OR"",""p-valor global olas"", ""p-valor casos"",""p-valor controles"")"
"0",""
"0","rownames(EEExt)=c(L,""Datos perdidos"")"
"0","EEExt %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")  "
"0","}"
