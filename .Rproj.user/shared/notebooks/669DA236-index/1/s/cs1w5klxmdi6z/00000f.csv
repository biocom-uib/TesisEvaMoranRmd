"0","#Test para diferencias de RA"
"0",""
"0","RA.RA=function(M,conf.level=0.95){"
"0","beta=c(1,-1,-1,1)"
"0","B=sum(beta)"
"0","e=M[1,]"
"0","n=colSums(M)"
"0","p=e/n"
"0","q=1-2*p"
"0","N=sum(n)"
"0","L.b=sum(beta*p)"
"0","T=L.b+n[2]+n[3]"
"0","T0=4*L.b^2/sum(beta^2/n)"
"0","if (L.b>0){T1=T*L.b/2}"
"0","if (L.b<0){T1=(N-T)*L.b/(-2)}"
"0","if (L.b==0){T1=0}"
"0","y=function(x){N-sum(sqrt(n^2+((2*n*beta*q)/L.b)*x+(beta^2/L.b^2)*x^2))}"
"0","z2=rootSolve::multiroot(y,start=(T0+T1)/2,maxiter=1000,rtol = 1e-8, atol = 1e-10, ctol = 1e-10)$root"
"0","p.val=1-pchisq(z2,1)"
"0","zz=qnorm((1-conf.level)/2)^2"
"0","y=function(x){N+2*zz -2*L.b*x-sum(sqrt(n^2+2*n*beta*q*x+x^2))}"
"0","C1=rootSolve::multiroot(y,start=-100,maxiter=1000,rtol = 1e-8, atol = 1e-10, ctol = 1e-10)$root"
"0","C2=rootSolve::multiroot(y,start=100,maxiter=1000,rtol = 1e-8, atol = 1e-10, ctol = 1e-10)$root"
"0","IC=L.b-zz/c(C2,C1)"
"0","Res=rbind(c(p.val,IC))"
"0","colnames(Res)=c(""p-valor"",""IC-inferior"",""IC-superior"")"
"0","return(Res)"
"0","}"
"0",""
"0",""
"0","#Test para cociente de RR"
"0",""
"0","RR.RR=function(M,conf.level=0.95){"
"0","e=M[1,]"
"0","n=colSums(M)"
"0","p=e/n"
"0",""
"0","RR1=p[1]/p[2]"
"0","RR2=p[3]/p[4]"
"0","se.lnRR1=sqrt(1/e[1]+1/e[2]-1/n[1]-1/n[2])"
"0","se.lnRR2=sqrt(1/e[3]+1/e[4]-1/n[3]-1/n[4])"
"0",""
"0","RRR=RR1/RR2"
"0","se.lnRRR=sqrt(se.lnRR1^2+se.lnRR2^2)"
"0",""
"0","IC.1=exp(log(RRR)-se.lnRRR*qnorm((1+conf.level)/2))"
"0","IC.2=exp(log(RRR)+se.lnRRR*qnorm((1+conf.level)/2))"
"0","p.val=2-2*pnorm(abs(log(RRR))/se.lnRRR)"
"0","Res=rbind(c(RRR,p.val,IC.1,IC.2))"
"0","colnames(Res)=c(""RRR"", ""p-valor"",""IC-inferior"",""IC-superior"")"
"0","return(Res)"
"0","}"
"0",""
"0","# Test para comparar OR"
"0",""
"0","OR.OR=function(M,conf.level=0.95){"
"0","M1=M[,1:2]"
"0","M2=M[,3:4]"
"0","LOR1=log(fisher.test(M1)$estimate)"
"0","LOR2=log(fisher.test(M2)$estimate)"
"0","Z=abs(LOR1-LOR2)/sqrt(sum(1/M))"
"0","p.val=2*(1-pnorm(Z))"
"0","IC=exp(LOR1-LOR2+qnorm((1+conf.level)/2)*sqrt(sum(1/M))*c(-1,1))"
"0","Res=rbind(c(p.val,IC))"
"0","colnames(Res)=c(""p-valor"",""IC-inferior"",""IC-superior"")"
"0","return(Res)"
"0","}"
