"0","ComparOlasRRwe=function(I1,I2,NI1,NI2,L1,L2,r=6){"
"0","Tot1w=c(I1,NI1)"
"0","Tot2w=c(I2,NI2)"
"0","NA_I1=length(I1[is.na(I1)])"
"0","NA_NI1=length(NI1[is.na(NI1)])"
"0","NA_I2=length(I2[is.na(I2)])"
"0","NA_NI2=length(NI2[is.na(NI2)])"
"0","EE=cbind(as.vector(table(I1))[2:1],"
"0","         as.vector(table(NI1))[2:1],"
"0","         as.vector(table(I2))[2:1],"
"0","         as.vector(table(NI2))[2:1])"
"0",""
"0","e=EE[1,]"
"0","n=colSums(EE)"
"0","p=e/n"
"0",""
"0","RA=round((p[1]-p[2])-(p[3]-p[4]),4)"
"0","RR=round((p[1]/p[2])/(p[3]/p[4]),4)"
"0","p.RARA=RA.RA(EE)[1]"
"0","IC.RARA=RA.RA(EE)[2:3]"
"0","p.RRRR=RR.RR(EE)[2]"
"0","IC.RRRR=RR.RR(EE)[3:4]"
"0",""
"0",""
"0","EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))"
"0","EEI=EE[,c(1,3)]"
"0","EENI=EE[,c(2,4)]"
"0","FTGlob=c(fisher.test(EETot,workspace=2e8)$p.value,fisher.test(EEI,workspace=2e8)$p.value,fisher.test(EENI,workspace=2e8)$p.value)"
"0",""
"0","EEExt=cbind(c(as.vector(table(I1))[2:1],NA_I1),"
"0","            c(round(100*as.vector(prop.table(table(I1)))[2:1],1),NA),"
"0","            c(as.vector(table(NI1))[2:1],NA_NI1),"
"0","            c(round(100*as.vector(prop.table(table(NI1)))[2:1],1),NA),"
"0","            c(as.vector(table(I2))[2:1],NA_I2),"
"0","            c(round(100*as.vector(prop.table(table(I2)))[2:1],1),NA),"
"0","            c(as.vector(table(NI2))[2:1],NA_NI2),"
"0","            c(round(100*as.vector(prop.table(table(NI2)))[2:1],1),NA),"
"0","            c(round(RA,4),NA,NA),"
"0","            c(round(IC.RARA[1],4),NA,NA),"
"0","            c(round(IC.RARA[2],4),NA,NA),"
"0","            c(round(p.RARA,r),NA,NA),"
"0","           c(round(RR,4),NA,NA),"
"0","            c(round(IC.RRRR[1],4),NA,NA),"
"0","            c(round(IC.RRRR[2],4),NA,NA),"
"0","            c(round(p.RRRR,r),NA,NA),"
"0","c(round(FTGlob[1],r),NA,NA),"
"0","c(round(FTGlob[2],r),NA,NA),"
"0","c(round(FTGlob[3],r),NA,NA)"
"0","            )"
"0","colnames(EEExt)=c(ColumnesExt,""Diferencia RA"", ""Extr. inf. IC RA"",  ""Extr. sup. IC RA"", ""p-valor igualdad RA"",""Cociente RR"", ""Extr. inf. IC RR"",  ""Extr. sup. IC RR"", ""p-valor igualdad RR"",""p-valor global olas"", ""p-valor casos"",""p-valor controles"")"
"0",""
"0","rownames(EEExt)=c(L1, L2,""Datos perdidos"")"
"0","EEExt %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")  "
"0","}"
