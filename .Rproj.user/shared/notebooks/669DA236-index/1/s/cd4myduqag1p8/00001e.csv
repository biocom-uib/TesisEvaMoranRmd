"0","# Tablas 2d Descripción casos-controles"
"0","Tabla.DMG=function(I,NI,L1,L2,r=4){"
"0","n_I=length(I)  "
"0","n_NI=length(NI)  "
"0","NA_I=length(I[is.na(I)])"
"0","NA_NI=length(NI[is.na(NI)])"
"0",""
"0","EE=rbind(as.vector(table(I))[2:1],"
"0","         as.vector(table(NI))[2:1])"
"0","FT=fisher.test(EE)"
"0","OR=round(FT$estimate,2)"
"0","IC=round(FT$conf.int,2)"
"0",""
"0","EEExt=rbind(c(as.vector(table(I))[2:1],NA_I),"
"0","            c(round(100*as.vector(table(I))[2:1]/(n_I-NA_I),1),NA),"
"0","            c(as.vector(table(NI))[2:1],NA_NI),"
"0","            c(round(100*as.vector(table(NI))[2:1]/(n_NI-NA_NI),1),NA),"
"0","            c(round(FT$estimate,2),NA,NA),"
"0","            c(round(FT$conf.int[1],2),NA,NA),"
"0","            c(round(FT$conf.int[2],2),NA,NA),"
"0","            c(round(FT$p.value,r),NA,NA)"
"0","            )"
"0",""
"0","colnames(EEExt)=c(L2,L1,""Datos perdidos"")"
"0","rownames(EEExt)=c(""Infectadas (N)"", ""Infectadas (%)"",""No infectadas (N)"", ""No infectadas (%)"",""OR"",""Extr. Inf. IC"",""Extr. Sup. IC"",""p-valor"")"
"0",""
"0","t(EEExt) %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")"
"0","}"
"0","#######"
"0","#######"
"0",""
"0","Tabla.DMGm=function(I,NI,L,r=4){"
"0","l=length(L)"
"0","n_I=length(I)  "
"0","n_NI=length(NI)  "
"0","NA_I=length(I[is.na(I)])"
"0","NA_NI=length(NI[is.na(NI)])"
"0","EE=rbind(as.vector(table(I)),"
"0","         as.vector(table(NI)))"
"0",""
"0","pp=rep(0,dim(EE)[2])"
"0","for (i in 1:dim(EE)[2]){"
"0","pp[i]=prop.test(c(EE[1,i],sum(EE[1,-i])),"
"0","                c(sum(EE[,i]),sum(EE[,-i])))$p.value"
"0","}"
"0","pp=round(p.adjust(pp,method=""bonferroni""),r)"
"0","OR=rep(0,dim(EE)[2])"
"0","CI1=rep(0,dim(EE)[2])"
"0","CI2=rep(0,dim(EE)[2])"
"0",""
"0","for (i in 1:dim(EE)[2]){"
"0","FT=fisher.test(rbind(c(EE[1,i],sum(EE[1,-i])),"
"0","                  c(EE[2,i],sum(EE[2,-i]))))"
"0","OR[i]=round(FT$estimate,2)"
"0","CI1[i]=round(FT$conf.int[1],2)"
"0","CI2[i]=round(FT$conf.int[2],2)}"
"0",""
"0",""
"0","EEExt=rbind(c(as.vector(table(I)),NA_I),"
"0","            c(round(100*as.vector(table(I))/(n_I-NA_I),1),NA),"
"0","            c(as.vector(table(NI)),NA_NI),"
"0","            c(round(100*as.vector(table(NI))/(n_NI-NA_NI),1),NA),"
"0","            c(OR,NA),"
"0","            c(CI1,NA),"
"0","            c(CI2,NA),"
"0","            c(pp,NA)"
"0","            )"
"0",""
"0","colnames(EEExt)=c(L,""Datos perdidos"")"
"0","rownames(EEExt)=c(""Infectadas (N)"", ""Infectadas (%)"",""No infectadas (N)"", ""No infectadas (%)"",""OR"",""Extr. Inf. IC"",""Extr. Sup. IC"", ""p-valor ajustado"")"
"0",""
"0","t(EEExt) %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")"
"0","}"
"0",""
"0","#########"
"0","#########"
"0",""
"0","Tabla.DMGC=function(I,NI,L1,L2,r=4){"
"0","n_I=length(I)  "
"0","n_NI=length(NI)  "
"0","NA_I=length(I[is.na(I)])"
"0","NA_NI=length(NI[is.na(NI)])"
"0",""
"0","EE=rbind(as.vector(table(I))[2:1],"
"0","         as.vector(table(NI))[2:1])"
"0","FT=fisher.test(EE)"
"0","PT=prop.test(EE[,1],rowSums(EE))"
"0",""
"0","RA=round(PT$estimate[1]-PT$estimate[2],4)"
"0","ICRA=round(PT$conf.int,4)"
"0","RR=round(PT$estimate[1]/PT$estimate[2],2)"
"0","ICRR=round(RelRisk(EE,conf.level=0.95,method=""score"")[2:3],2)"
"0",""
"0","EEExt=rbind(c(as.vector(table(I))[2:1],NA_I),"
"0","            c(round(100*as.vector(table(I))[2:1]/(n_I-NA_I),1),NA),"
"0","            c(as.vector(table(NI))[2:1],NA_NI),"
"0","            c(round(100*as.vector(table(NI))[2:1]/(n_NI-NA_NI),1),NA),"
"0","            c(RA,NA,NA),"
"0","            c(ICRA[1],NA,NA),"
"0","            c(ICRA[2],NA,NA),"
"0","            c(RR,NA,NA),"
"0","            c(ICRR[1],NA,NA),"
"0","            c(ICRR[2],NA,NA),"
"0","            c(round(FT$p.value,r),NA,NA)"
"0","            )"
"0",""
"0","colnames(EEExt)=c(L2,L1,""Datos perdidos"")"
"0","rownames(EEExt)=c(""Infectadas (N)"", ""Infectadas (%)"",""No infectadas (N)"", ""No infectadas (%)"",""RA"",""Extr. Inf. IC RA"",""Extr. Sup. IC RA"",""RR"",""Extr. Inf. IC RA"",""Extr. Sup. IC RR"", ""p-valor"")"
"0",""
"0",""
"0","t(EEExt) %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")"
"0","}"
"0","####"
"0","####"
"0","Tabla.DMGCr=function(I,NI,L1,L2,ni,nni,r=4){"
"0","NA_I=length(I[is.na(I)])"
"0","NA_NI=length(NI[is.na(NI)])"
"0",""
"0","EE=rbind(as.vector(table(I))[2:1],"
"0","         as.vector(table(NI))[2:1])"
"0","FT=fisher.test(EE)"
"0","PT=prop.test(EE[,1],rowSums(EE))"
"0",""
"0","RA=round(PT$estimate[1]-PT$estimate[2],4)"
"0","ICRA=round(PT$conf.int,4)"
"0","RR=round(PT$estimate[1]/PT$estimate[2],2)"
"0","ICRR=round(RelRisk(EE,conf.level=0.95,method=""score"")[2:3],2)"
"0",""
"0","EEExt=rbind(c(as.vector(table(I))[2:1],NA_I),"
"0","            c(round(100*as.vector(table(I))[2:1]/(ni-NA_I),1),NA),"
"0","            c(as.vector(table(NI))[2:1],NA_NI),"
"0","            c(round(100*as.vector(table(NI))[2:1]/(nni-NA_NI),1),NA),"
"0","            c(RA,NA,NA),"
"0","            c(ICRA[1],NA,NA),"
"0","            c(ICRA[2],NA,NA),"
"0","            c(RR,NA,NA),"
"0","            c(ICRR[1],NA,NA),"
"0","            c(ICRR[2],NA,NA),"
"0","            c(round(FT$p.value,r),NA,NA)"
"0","            )"
"0",""
"0","colnames(EEExt)=c(L2,L1,""Datos perdidos"")"
"0","rownames(EEExt)=c(""Infectadas (N)"", ""Infectadas (%)"",""No infectadas (N)"", ""No infectadas (%)"",""RA"",""Extr. Inf. IC RA"",""Extr. Sup. IC RA"",""RR"",""Extr. Inf. IC RA"",""Extr. Sup. IC RR"", ""p-valor"")"
"0",""
"0",""
"0","t(EEExt) %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")"
"0","}"
"0",""
"0","######"
"0","######"
"0","Tabla.DMGCm=function(I,NI,L,r=4){"
"0","l=length(L)"
"0","n_I=length(I)  "
"0","n_NI=length(NI)  "
"0","NA_I=length(I[is.na(I)])"
"0","NA_NI=length(NI[is.na(NI)])"
"0",""
"0","EE=rbind(as.vector(table(I)),"
"0","         as.vector(table(NI)))"
"0","pp=rep(0,dim(EE)[2])"
"0","RA=rep(0,dim(EE)[2])"
"0","RR=rep(0,dim(EE)[2])"
"0","CIRA1=rep(0,dim(EE)[2])"
"0","CIRA2=rep(0,dim(EE)[2])"
"0","CIRR1=rep(0,dim(EE)[2])"
"0","CIRR2=rep(0,dim(EE)[2])"
"0",""
"0","for (i in 1:dim(EE)[2]){"
"0","EE.temp=rbind(c(EE[1,i],sum(EE[1,-i])),"
"0","                  c(EE[2,i],sum(EE[2,-i])))"
"0","FT=fisher.test(EE.temp)"
"0","PT=prop.test(EE.temp[,1],rowSums(EE.temp))"
"0","pp[i]=FT$p.value"
"0","RA[i]=round(PT$estimate[1]-PT$estimate[2],4)"
"0","RR[i]=round(PT$estimate[1]/PT$estimate[2],3)"
"0","CIRA1[i]=round(PT$conf.int,4)[1]"
"0","CIRA2[i]=round(PT$conf.int,4)[2]"
"0","CIRR1[i]=round(RelRisk(EE.temp,conf.level=0.95,method=""wald""),3)[2]"
"0","CIRR2[i]=round(RelRisk(EE.temp,conf.level=0.95,method=""wald""),3)[3]"
"0","            }"
"0","pp=p.adjust(pp,method=""bonferroni"")"
"0",""
"0","EEExt=rbind(c(as.vector(table(I)),NA_I),"
"0","            c(round(100*as.vector(table(I))/(n_I-NA_I),1),NA),"
"0","            c(as.vector(table(NI)),NA_NI),"
"0","            c(round(100*as.vector(table(NI))/(n_NI-NA_NI),1),NA),"
"0","            c(RA,NA),"
"0","            c(CIRA1,NA),"
"0","            c(CIRA2,NA),"
"0","            c(RR,NA),"
"0","            c(CIRR1,NA),"
"0","            c(CIRR2,NA),"
"0","            c(round(pp,r),NA)"
"0","            )"
"0",""
"0","colnames(EEExt)=c(L,""Datos perdidos"")"
"0","rownames(EEExt)=c(""Infectadas (N)"", ""Infectadas (%)"",""No infectadas (N)"", ""No infectadas (%)"",""RA"",""Extr. Inf. IC RA"",""Extr. Sup. IC RA"",""RR"",""Extr. Inf. IC RA"",""Extr. Sup. IC RR"", ""p-valor"")"
"0",""
"0",""
"0","t(EEExt) %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")"
"0","}"
"0","####"
"0","####"
"0","# Tablas 2d Descripción sintomatología"
"0",""
"0","Tabla.DMCasos=function(I,L1,L2,r=6){"
"0","I=factor(I)"
"0","IA=I[Casos$SINTOMAS_DIAGNOSTICO==""Asintomática""]"
"0","IL=I[Casos$SINTOMAS_DIAGNOSTICO==""Leve""]"
"0","IG=I[Casos$SINTOMAS_DIAGNOSTICO==""Grave""]"
"0","NA_A=length(IA[is.na(IA)])"
"0","NA_L=length(IL[is.na(IL)])"
"0","NA_G=length(IG[is.na(IG)])"
"0",""
"0","EEExt=cbind(c(as.vector(table(IA))[2:1],NA_A),"
"0","            c(round(100*as.vector(prop.table(table(IA))[2:1]),1),NA),"
"0","            c(as.vector(table(IL))[2:1],NA_L),"
"0","            c(round(100*as.vector(prop.table(table(IL))[2:1]),1),NA),"
"0","            c(as.vector(table(IG))[2:1],NA_G),"
"0","            c(round(100*as.vector(prop.table(table(IG))[2:1]),1),NA)"
"0","            )"
"0",""
"0","test=chisq.test(EEExt[1:2,c(1,3,5)])"
"0","if(any(test$expected< 5))"
"0","  {"
"0","p.val=chisq.test(EEExt[1:2,c(1,3,5)],simulate.p.value=TRUE,B=10000)$p.value"
"0","tipus=""Montecarlo""} else"
"0","  {"
"0","   p.val=test$p.value"
"0","   tipus=""Paramétrico"""
"0","  }"
"0","p.val=round(p.val,r)"
"0","EEExt=cbind(data.frame(EEExt),c(p.val,NA,NA),c(tipus,NA,NA))"
"0","rownames(EEExt)=c(L1,L2,""Datos perdidos"")"
"0","colnames(EEExt)=c(Columnes.Sint,""p-valor"",""Tipo"")"
"0",""
"0","EEExt %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")"
"0","}"
"0","######"
"0","#####"
"0","Tabla.DMCasosr=function(IA,IL,IG,L1,L2,r=6){"
"0","NA_A=length(IA[is.na(IA)])"
"0","NA_L=length(IL[is.na(IL)])"
"0","NA_G=length(IG[is.na(IG)])"
"0",""
"0","EEExt=cbind(c(as.vector(table(IA))[2:1],NA_A),"
"0","            c(round(100*as.vector(prop.table(table(IA))[2:1]),1),NA),"
"0","            c(as.vector(table(IL))[2:1],NA_L),"
"0","            c(round(100*as.vector(prop.table(table(IL))[2:1]),1),NA),"
"0","            c(as.vector(table(IG))[2:1],NA_G),"
"0","            c(round(100*as.vector(prop.table(table(IG))[2:1]),1),NA)"
"0","            )"
"0",""
"0","test=chisq.test(EEExt[1:2,c(1,3,5)])"
"0","if(any(test$expected< 5))"
"0","  {"
"0","p.val=chisq.test(EEExt[1:2,c(1,3,5)],simulate.p.value=TRUE,B=10000)$p.value"
"0","tipus=""Montecarlo""} else"
"0","  {"
"0","   p.val=test$p.value"
"0","   tipus=""Paramétrico"""
"0","  }"
"0","p.val=round(p.val,r)"
"0","EEExt=cbind(data.frame(EEExt),c(p.val,NA,NA),c(tipus,NA,NA))"
"0","rownames(EEExt)=c(L1,L2,""Datos perdidos"")"
"0","colnames(EEExt)=c(Columnes.Sint,""p-valor"",""Tipo"")"
"0",""
"0","EEExt %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")"
"0","}"
"0",""
"0","######"
"0","#####"
"0","Tabla.DMCasosm=function(I,L,r=6){"
"0","l=length(L)"
"0","IA=I[Casos$SINTOMAS_DIAGNOSTICO==""Asintomática""]"
"0","IL=I[Casos$SINTOMAS_DIAGNOSTICO==""Leve""]"
"0","IG=I[Casos$SINTOMAS_DIAGNOSTICO==""Grave""]"
"0","NA_A=length(IA[is.na(IA)])"
"0","NA_L=length(IL[is.na(IL)])"
"0","NA_G=length(IG[is.na(IG)])"
"0",""
"0","EEExt=cbind(c(as.vector(table(IA)),NA_A),"
"0","            c(round(100*as.vector(prop.table(table(IA))),1),NA),"
"0","            c(as.vector(table(IL)),NA_L),"
"0","            c(round(100*as.vector(prop.table(table(IL))),1),NA),"
"0","            c(as.vector(table(IG)),NA_G),"
"0","            c(round(100*as.vector(prop.table(table(IG))),1),NA)"
"0","            )"
"0","p.val=rep(NA,l+1)"
"0","tipus=rep(NA,l+1)"
"0","taula=EEExt[1:l,c(1,3,5)]"
"0","for (i in 1:l){"
"0","X=rbind(taula[i,],colSums(taula)-taula[i,])"
"0","test=chisq.test(X)"
"0","if(any(test$expected< 5))"
"0","  {"
"0","p.val[i]=chisq.test(X,simulate.p.value=TRUE,B=10000)$p.value"
"0","tipus[i]=""Montecarlo""}"
"0","else"
"0","  {"
"0","   p.val[i]=test$p.value"
"0","   tipus[i]=""Paramétrico"""
"0","  }"
"0","}"
"0","p.val=round(p.adjust(p.val,method=""bonferroni""),r)"
"0","EEExt=cbind(data.frame(EEExt),p.val,tipus)"
"0","rownames(EEExt)=c(L,""Datos perdidos"")"
"0","colnames(EEExt)=c(Columnes.Sint,""p-valor"",""Tipo"")"
"0",""
"0","EEExt %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")"
"0","}"
"0","######"
"0","#####"
"0","#"
"0","# Tabla de comparación Anteparto-Periparto"
"0","#"
"0","TablaAntePeriOR=function(I,L1,L2,r=6){"
"0","  I.AP=I[Casos$PreP==1]"
"0","  I.PP=I[Casos$PreP==0]"
"0","  n_IAP=length(I.AP)"
"0","  n_IPP=length(I.PP)"
"0","  NA_IAP=length(I.AP[is.na(I.AP)])"
"0","  NA_IPP=length(I.PP[is.na(I.PP)])"
"0","  EE=rbind(as.vector(table(I.AP))[2:1],"
"0","           as.vector(table(I.PP))[2:1])"
"0"," FT=fisher.test(EE)"
"0","OR=round(FT$estimate,2)"
"0","IC=round(FT$conf.int,2)"
"0"," "
"0","  EEExt=rbind(c(as.vector(table(I.AP))[2:1],NA_IAP),"
"0","              c(round(100*as.vector(prop.table(table(I.AP)))[2:1],1),NA),"
"0","              c(as.vector(table(I.PP))[2:1],NA_IPP),"
"0","              c(round(100*as.vector(prop.table(table(I.PP)))[2:1],1),NA),"
"0","               c(OR,NA,NA),"
"0","              c(IC[1],NA,NA),"
"0","              c(IC[2],NA,NA),"
"0","              c(round(FT$p.value,r),NA,NA)"
"0","  )"
"0","  "
"0","  colnames(EEExt)=c(L2,L1,""Datos perdidos"")"
"0","  rownames(EEExt)=c(""Inf. Anteparto (N)"", ""Inf. Anteparto (%)"",""Inf. Periparto (N)"", ""Inf. Periparto (%)"",""OR"",""Extr. Inf. IC"",""Extr. Sup. IC"", ""p-valor"")"
"0","  "
"0","  "
"0","  t(EEExt) %>%"
"0","    kbl() %>%"
"0","    kable_styling() %>%     "
"0","    scroll_box(width=""100%"", box_css=""border: 0px;"")  "
"0","}"
"0","############"
"0","TablaAntePeriOR.m=function(I,L,r=6){"
"0","  I.AP=I[Casos$PreP==1]"
"0","  I.PP=I[Casos$PreP==0]"
"0","  n_IAP=length(I.AP)"
"0","  n_IPP=length(I.PP)"
"0","  NA_IAP=length(I.AP[is.na(I.AP)])"
"0","  NA_IPP=length(I.PP[is.na(I.PP)])"
"0","  EE=rbind(as.vector(table(I.AP)),"
"0","           as.vector(table(I.PP)))"
"0","  pp=rep(0,dim(EE)[2])"
"0","  OR=rep(0,dim(EE)[2])"
"0","  CI1=rep(0,dim(EE)[2])"
"0","  CI2=rep(0,dim(EE)[2])"
"0",""
"0","  for (i in 1:dim(EE)[2]){"
"0","    EE.temp=rbind(c(EE[1,i],sum(EE[1,-i])),"
"0","                  c(EE[2,i],sum(EE[2,-i])))"
"0","    FT=fisher.test(EE.temp)"
"0","    pp[i]=FT$p.value"
"0","    OR[i]=round(FT$estimate,2)"
"0","    CI1[i]=round(FT$conf.int,2)[1]"
"0","    CI2[i]=round(FT$conf.int,2)[2]"
"0","   }"
"0","  pp=p.adjust(pp,method=""bonferroni"")"
"0","  "
"0","  EEExt=rbind(c(as.vector(table(I.AP)),NA_IAP),"
"0","              c(round(100*as.vector(prop.table(table(I.AP))),1),NA),"
"0","              c(as.vector(table(I.PP)),NA_IPP),"
"0","              c(round(100*as.vector(prop.table(table(I.PP))),1),NA),"
"0","              c(OR,NA),"
"0","              c(CI1,NA),"
"0","              c(CI2,NA),"
"0","              c(round(pp,r),NA)"
"0","  )"
"0","  "
"0","  colnames(EEExt)=c(L,""Datos perdidos"")"
"0","  rownames(EEExt)=c(""Inf. Anteparto (N)"", ""Inf. Anteparto (%)"",""Inf. Periparto (N)"", ""Inf. Periparto (%)"",""OR"",""Extr. Inf. IC"",""Extr. Sup. IC"", ""p-valor"")"
"0","  "
"0","  "
"0","  t(EEExt) %>%"
"0","    kbl() %>%"
"0","    kable_styling() %>%     "
"0","    scroll_box(width=""100%"", box_css=""border: 0px;"")  "
"0","}"
"0","#############"
"0",""
"0",""
"0","TablaAntePeri=function(I,L1,L2,r=6){"
"0","  I.AP=I[Casos$PreP==1]"
"0","  I.PP=I[Casos$PreP==0]"
"0","  n_IAP=length(I.AP)"
"0","  n_IPP=length(I.PP)"
"0","  NA_IAP=length(I.AP[is.na(I.AP)])"
"0","  NA_IPP=length(I.PP[is.na(I.PP)])"
"0","  EE=rbind(as.vector(table(I.AP))[2:1],"
"0","           as.vector(table(I.PP))[2:1])"
"0","  FT=fisher.test(EE)"
"0","  PT=prop.test(EE[,1],rowSums(EE))"
"0","  "
"0","  RA=round(PT$estimate[1]-PT$estimate[2],4)"
"0","  ICRA=round(PT$conf.int,4)"
"0","  RR=round(PT$estimate[1]/PT$estimate[2],2)"
"0","  ICRR=round(RelRisk(EE,conf.level=0.95,method=""score"")[2:3],2)"
"0","  "
"0","  EEExt=rbind(c(as.vector(table(I.AP))[2:1],NA_IAP),"
"0","              c(round(100*as.vector(prop.table(table(I.AP)))[2:1],1),NA),"
"0","              c(as.vector(table(I.PP))[2:1],NA_IPP),"
"0","              c(round(100*as.vector(prop.table(table(I.PP)))[2:1],1),NA),"
"0","               c(RA,NA,NA),"
"0","              c(ICRA[1],NA,NA),"
"0","              c(ICRA[2],NA,NA),"
"0","              c(RR,NA,NA),"
"0","              c(ICRR[1],NA,NA),"
"0","              c(ICRR[2],NA,NA),"
"0","              c(round(FT$p.value,r),NA,NA)"
"0","  )"
"0","  "
"0","  colnames(EEExt)=c(L2,L1,""Datos perdidos"")"
"0","  rownames(EEExt)=c(""Inf. Anteparto (N)"", ""Inf. Anteparto (%)"",""Inf. Periparto (N)"", ""Inf. Periparto (%)"",""RA"",""Extr. Inf. IC RA"",""Extr. Sup. IC RA"",""RR"",""Extr. Inf. IC RA"",""Extr. Sup. IC RR"", ""p-valor"")"
"0","  "
"0","  "
"0","  t(EEExt) %>%"
"0","    kbl() %>%"
"0","    kable_styling() %>%     "
"0","    scroll_box(width=""100%"", box_css=""border: 0px;"")  "
"0","}"
"0","####"
"0","TablaAntePeri.m=function(I,L,r=6){"
"0","  I.AP=I[Casos$PreP==1]"
"0","  I.PP=I[Casos$PreP==0]"
"0","  n_IAP=length(I.AP)"
"0","  n_IPP=length(I.PP)"
"0","  NA_IAP=length(I.AP[is.na(I.AP)])"
"0","  NA_IPP=length(I.PP[is.na(I.PP)])"
"0","  EE=rbind(as.vector(table(I.AP)),"
"0","           as.vector(table(I.PP)))"
"0","  pp=rep(0,dim(EE)[2])"
"0","  RA=rep(0,dim(EE)[2])"
"0","  RR=rep(0,dim(EE)[2])"
"0","  CIRA1=rep(0,dim(EE)[2])"
"0","  CIRA2=rep(0,dim(EE)[2])"
"0","  CIRR1=rep(0,dim(EE)[2])"
"0","  CIRR2=rep(0,dim(EE)[2])"
"0","  "
"0","  for (i in 1:dim(EE)[2]){"
"0","    EE.temp=rbind(c(EE[1,i],sum(EE[1,-i])),"
"0","                  c(EE[2,i],sum(EE[2,-i])))"
"0","    FT=fisher.test(EE.temp)"
"0","    PT=prop.test(EE.temp[,1],rowSums(EE.temp))"
"0","    pp[i]=FT$p.value"
"0","    RA[i]=round(PT$estimate[1]-PT$estimate[2],4)"
"0","    RR[i]=round(PT$estimate[1]/PT$estimate[2],3)"
"0","    CIRA1[i]=round(PT$conf.int,4)[1]"
"0","    CIRA2[i]=round(PT$conf.int,4)[2]"
"0","    CIRR1[i]=round(RelRisk(EE.temp,conf.level=0.95,method=""wald""),3)[2]"
"0","    CIRR2[i]=round(RelRisk(EE.temp,conf.level=0.95,method=""wald""),3)[3]"
"0","  }"
"0","  pp=p.adjust(pp,method=""bonferroni"")"
"0","  "
"0","  EEExt=rbind(c(as.vector(table(I.AP)),NA_IAP),"
"0","              c(round(100*as.vector(prop.table(table(I.AP))),1),NA),"
"0","              c(as.vector(table(I.PP)),NA_IPP),"
"0","              c(round(100*as.vector(prop.table(table(I.PP))),1),NA),"
"0","              c(RA,NA),"
"0","              c(CIRA1,NA),"
"0","              c(CIRA2,NA),"
"0","              c(RR,NA),"
"0","              c(CIRR1,NA),"
"0","              c(CIRR2,NA),"
"0","              c(round(pp,r),NA)"
"0","  )"
"0","  "
"0","  colnames(EEExt)=c(L,""Datos perdidos"")"
"0","  rownames(EEExt)=c(""Inf. Anteparto (N)"", ""Inf. Anteparto (%)"",""Inf. Periparto (N)"", ""Inf. Periparto (%)"",""RA"",""Extr. Inf. IC RA"",""Extr. Sup. IC RA"",""RR"",""Extr. Inf. IC RA"",""Extr. Sup. IC RR"", ""p-valor"")"
"0","  "
"0","  "
"0","  t(EEExt) %>%"
"0","    kbl() %>%"
"0","    kable_styling() %>%     "
"0","    scroll_box(width=""100%"", box_css=""border: 0px;"")  "
"0","}"
"0","#############"
"0","###########"
"0","TablaAntePeri.r=function(I.AP,I.PP,L1,L2,r=6){"
"0","  n_IAP=length(I.AP)"
"0","  n_IPP=length(I.PP)"
"0","  NA_IAP=length(I.AP[is.na(I.AP)])"
"0","  NA_IPP=length(I.PP[is.na(I.PP)])"
"0","  EE=rbind(as.vector(table(I.AP))[2:1],"
"0","           as.vector(table(I.PP))[2:1])"
"0","  FT=fisher.test(EE)"
"0","  PT=prop.test(EE[,1],rowSums(EE))"
"0","  "
"0","  RA=round(PT$estimate[1]-PT$estimate[2],4)"
"0","  ICRA=round(PT$conf.int,4)"
"0","  RR=round(PT$estimate[1]/PT$estimate[2],2)"
"0","  ICRR=round(RelRisk(EE,conf.level=0.95,method=""score"")[2:3],2)"
"0","  "
"0","  EEExt=rbind(c(as.vector(table(I.AP))[2:1],NA_IAP),"
"0","              c(round(100*as.vector(prop.table(table(I.AP)))[2:1],1),NA),"
"0","              c(as.vector(table(I.PP))[2:1],NA_IPP),"
"0","              c(round(100*as.vector(prop.table(table(I.PP)))[2:1],1),NA),"
"0","              c(RA,NA,NA),"
"0","              c(ICRA[1],NA,NA),"
"0","              c(ICRA[2],NA,NA),"
"0","              c(RR,NA,NA),"
"0","              c(ICRR[1],NA,NA),"
"0","              c(ICRR[2],NA,NA),"
"0","              c(round(FT$p.value,r),NA,NA)"
"0","  )"
"0","  "
"0","  colnames(EEExt)=c(L2,L1,""Datos perdidos"")"
"0","  rownames(EEExt)=c(""Inf. Anteparto (N)"", ""Inf. Anteparto (%)"",""Inf. Periparto (N)"", ""Inf. Periparto (%)"",""RA"",""Extr. Inf. IC RA"",""Extr. Sup. IC RA"",""RR"",""Extr. Inf. IC RA"",""Extr. Sup. IC RR"", ""p-valor"")"
"0","  "
"0","  "
"0","  t(EEExt) %>%"
"0","    kbl() %>%"
"0","    kable_styling() %>%     "
"0","    scroll_box(width=""100%"", box_css=""border: 0px;"")  "
"0","}"
"0","#####"
"0","#####"
"0",""
"0","TablaAntePeriCasos=function(CasosX,I,L,SintX=Sint.Tot){"
"0","  I.AP.A=I[CasosX$PreP==1& SintX==""Asintomática""]"
"0","  I.AP.L=I[CasosX$PreP==1& SintX==""Leve""]"
"0","  I.AP.G=I[CasosX$PreP==1& SintX==""Grave""]"
"0","  I.PP.A=I[CasosX$PreP==0& SintX==""Asintomática""]"
"0","  I.PP.L=I[CasosX$PreP==0& SintX==""Leve""]"
"0","  I.PP.G=I[CasosX$PreP==0& SintX==""Asintomática""]"
"0","  "
"0","  NA_I.AP.A=length(I.AP.A[is.na(I.AP.A)])"
"0","  NA_I.AP.L=length(I.AP.L[is.na(I.AP.L)])"
"0","  NA_I.AP.G=length(I.AP.G[is.na(I.AP.G)])"
"0","  NA_I.PP.A=length(I.PP.A[is.na(I.PP.A)])"
"0","  NA_I.PP.L=length(I.PP.L[is.na(I.PP.L)])"
"0","  NA_I.PP.G=length(I.PP.G[is.na(I.PP.G)])"
"0","  "
"0","  "
"0","  "
"0","  EEExt=rbind(c(as.vector(table(I.AP.A))[2:1],NA_I.AP.A),"
"0","              c(round(100*as.vector(prop.table(table(I.AP.A)))[2:1],1),NA),"
"0","              c(as.vector(table(I.AP.L))[2:1],NA_I.AP.L),"
"0","              c(round(100*as.vector(prop.table(table(I.AP.L)))[2:1],1),NA),"
"0","              c(as.vector(table(I.AP.G))[2:1],NA_I.AP.G),"
"0","              c(round(100*as.vector(prop.table(table(I.AP.G)))[2:1],1),NA),"
"0","              c(as.vector(table(I.PP.A))[2:1],NA_I.PP.A),"
"0","              c(round(100*as.vector(prop.table(table(I.PP.A)))[2:1],1),NA),"
"0","              c(as.vector(table(I.PP.L))[2:1],NA_I.PP.L),"
"0","              c(round(100*as.vector(prop.table(table(I.PP.L)))[2:1],1),NA),"
"0","              c(as.vector(table(I.PP.G))[2:1],NA_I.PP.G),"
"0","              c(round(100*as.vector(prop.table(table(I.PP.G)))[2:1],1),NA)"
"0","  )"
"0","  "
"0","  colnames(EEExt)=c(L,""Datos perdidos"")"
"0","  rownames(EEExt)=c(""Inf. AP. Asintomáticas (N)"", ""Inf. AP. Asintomáticas (%)"","
"0","                    ""Inf. AP. Leves (N)"", ""Inf. AP. Leves (%)"","
"0","                    ""Inf. AP. Graves (N)"", ""Inf. AP. Graves (%)"","
"0","                    ""Inf. PP. Asintomáticas (N)"", ""Inf. PP. Asintomáticas (%)"","
"0","                    ""Inf. PP. Leves (N)"", ""Inf. PP. Leves (%)"","
"0","                    ""Inf. PP. Graves (N)"", ""Inf. PP. Graves (%)"")"
"0","  "
"0","  t(EEExt) %>%"
"0","    kbl() %>%"
"0","    kable_styling() %>%     "
"0","    scroll_box(width=""100%"", box_css=""border: 0px;"")  "
"0","}"
"0","#########"
"0","########"
"0","TablaAntePeriCasos.m=function(CasosX,I,L,SintX=Sint.Tot){"
"0","  I.AP.A=I[CasosX$PreP==1& Sint==""Asintomática""]"
"0","  I.AP.L=I[CasosX$PreP==1& SintX==""Leve""]"
"0","  I.AP.G=I[CasosX$PreP==1& SintX==""Grave""]"
"0","  I.PP.A=I[CasosX$PreP==0& SintX==""Asintomática""]"
"0","  I.PP.L=I[CasosX$PreP==0& SintX==""Leve""]"
"0","  I.PP.G=I[CasosX$PreP==0& SintX==""Asintomática""]"
"0","  "
"0","  NA_I.AP.A=length(I.AP.A[is.na(I.AP.A)])"
"0","  NA_I.AP.L=length(I.AP.L[is.na(I.AP.L)])"
"0","  NA_I.AP.G=length(I.AP.G[is.na(I.AP.G)])"
"0","  NA_I.PP.A=length(I.PP.A[is.na(I.PP.A)])"
"0","  NA_I.PP.L=length(I.PP.L[is.na(I.PP.L)])"
"0","  NA_I.PP.G=length(I.PP.G[is.na(I.PP.G)])"
"0","  "
"0","  "
"0","  "
"0","  EEExt=rbind(c(as.vector(table(I.AP.A)),NA_I.AP.A),"
"0","              c(round(100*as.vector(prop.table(table(I.AP.A))),1),NA),"
"0","              c(as.vector(table(I.AP.L)),NA_I.AP.L),"
"0","              c(round(100*as.vector(prop.table(table(I.AP.L))),1),NA),"
"0","              c(as.vector(table(I.AP.G)),NA_I.AP.G),"
"0","              c(round(100*as.vector(prop.table(table(I.AP.G))),1),NA),"
"0","              c(as.vector(table(I.PP.A)),NA_I.PP.A),"
"0","              c(round(100*as.vector(prop.table(table(I.PP.A))),1),NA),"
"0","              c(as.vector(table(I.PP.L)),NA_I.PP.L),"
"0","              c(round(100*as.vector(prop.table(table(I.PP.L))),1),NA),"
"0","              c(as.vector(table(I.PP.G)),NA_I.PP.G),"
"0","              c(round(100*as.vector(prop.table(table(I.PP.G))),1),NA)"
"0","  )"
"0","  "
"0","  colnames(EEExt)=c(L,""Datos perdidos"")"
"0","  rownames(EEExt)=c(""Inf. AP. Asintomáticas (N)"", ""Inf. AP. Asintomáticas (%)"","
"0","                    ""Inf. AP. Leves (N)"", ""Inf. AP. Leves (%)"","
"0","                    ""Inf. AP. Graves (N)"", ""Inf. AP. Graves (%)"","
"0","                    ""Inf. PP. Asintomáticas (N)"", ""Inf. PP. Asintomáticas (%)"","
"0","                    ""Inf. PP. Leves (N)"", ""Inf. PP. Leves (%)"","
"0","                    ""Inf. PP. Graves (N)"", ""Inf. PP. Graves (%)"")"
"0","  "
"0","  t(EEExt) %>%"
"0","    kbl() %>%"
"0","    kable_styling() %>%     "
"0","    scroll_box(width=""100%"", box_css=""border: 0px;"")  "
"0","}"
"0",""
"0","########"
"0","# Tablas 2d Robson"
"0",""
"0","TablaRobsonGlobal=function(TR1,TR2,x,y=x){"
"0","EE1=t(TR1)[2:1,2:11]"
"0","EE2=t(TR2)[2:1,2:11]"
"0","OR=rep(0,10)"
"0","pp=rep(0,10)"
"0","for (i in 1:10){"
"0","FT=fisher.test(cbind(EE1[,i],EE2[,i]))"
"0","OR[i]=FT$estimate"
"0","pp[i]=FT$p.value       }"
"0",""
"0","dt=data.frame(1:10,colSums(EE1),EE1[1,],round(100*prop.table(EE1,margin=2)[1,],2),colSums(EE2),EE2[1,],round(100*prop.table(EE2,margin=2)[1,],2),round(OR,2),round(pp,3))"
"0","names(dt)=c(""Grupo Robson"", paste(""Casos"",x), ""Cesáreas"", ""Porcentaje"",  paste(""Controles"",y), ""Cesáreas"", ""Porcentaje"",""OR"",""p-valor test de Fisher"")"
"0","dt %>%"
"0","  kbl() %>%"
"0","  kable_styling()%>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")}"
