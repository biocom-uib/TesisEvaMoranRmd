"0","#Tabla de RA y RR"
"0",""
"0","Riesgos=function(M){"
"0","e=M[1,]"
"0","n=colSums(M)"
"0","p=e/n"
"0",""
"0","RA=round(c(p[1]-p[2],p[3]-p[4]),4)"
"0","RR=round(c(p[1]/p[2],p[3]/p[4]),4)"
"0","Res=cbind(RA,RR)"
"0","rownames(Res)=c(""1a ola"", ""2a ola"")"
"0","return(Res)"
"0","}"
"0",""
"0","# Tablas 2d Descripción casos-controles"
"0",""
"0","Tabla.DMG=function(I,NI,L1,L2){"
"0","NA_I=length(I[is.na(I)])"
"0","NA_NI=length(NI[is.na(NI)])"
"0","EEExt=rbind(c(as.vector(table(I)),NA_I),"
"0","            round(100*c(as.vector(table(I)),NA_I)/n_I,1),"
"0","            c(as.vector(table(NI)),NA_NI),"
"0","            round(100*c(as.vector(table(NI)),NA_NI)/n_NI,1))"
"0",""
"0","colnames(EEExt)=c(L1, L2,""Pérdidas"")"
"0","rownames(EEExt)=c(""Infectadas (N)"", ""Infectadas (%)"",""No infectadas (N)"", ""No infectadas (%)"")"
"0",""
"0","t(EEExt) %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")"
"0","}"
"0",""
"0","Tabla.DMG1=function(I,NI,L1,L2){"
"0","NA_I=length(I[is.na(I)])"
"0","NA_NI=length(NI[is.na(NI)])"
"0","EEExt=rbind(c(as.vector(table(I))[2:1],NA_I),"
"0","            round(100*c(as.vector(table(I))[2:1],NA_I)/n_I1,1),"
"0","            c(as.vector(table(NI))[2:1],NA_NI),"
"0","            round(100*c(as.vector(table(NI))[2:1],NA_NI)/n_NI1,1))"
"0",""
"0","colnames(EEExt)=c(L1, L2,""Pérdidas"")"
"0","rownames(EEExt)=c(""Infectadas (N)"", ""Infectadas (%)"",""No infectadas (N)"", ""No infectadas (%)"")"
"0",""
"0","t(EEExt) %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")"
"0","}"
"0",""
"0","Tabla.DMG2=function(I,NI,L1,L2){"
"0","NA_I=length(I[is.na(I)])"
"0","NA_NI=length(NI[is.na(NI)])"
"0","EEExt=rbind(c(as.vector(table(I))[2:1],NA_I),"
"0","            round(100*c(as.vector(table(I))[2:1],NA_I)/n_I2,1),"
"0","            c(as.vector(table(NI))[2:1],NA_NI),"
"0","            round(100*c(as.vector(table(NI))[2:1],NA_NI)/n_NI2,1))"
"0",""
"0","colnames(EEExt)=c(L1, L2,""Pérdidas"")"
"0","rownames(EEExt)=c(""Infectadas (N)"", ""Infectadas (%)"",""No infectadas (N)"", ""No infectadas (%)"")"
"0",""
"0","t(EEExt) %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")"
"0","}"
"0",""
"0","# Tablas 2d Descripción sintomatología"
"0",""
"0","Tabla.DGS=function(I,L1,L2){"
"0","DF=data.frame(Factor=I,Síntomas=Sint)"
"0","taula=table(DF)[c(2,1) ,1:3]"
"0","proptaula=round(100*prop.table(taula,margin=2),2)"
"0",""
"0","EEExt=cbind(c(as.vector(taula[,1]),n_AS-sum(as.vector(taula[,1]))),"
"0","            round(100*c(as.vector(taula[,1]),n_AS-sum(as.vector(taula[,1])))/n_AS,2),"
"0","            c(as.vector(taula[,2]),n_SL-sum(as.vector(taula[,2]))),"
"0","            round(100*c(as.vector(taula[,2]),n_SL-sum(as.vector(taula[,2])))/n_SL,2),"
"0","             c(as.vector(taula[,3]),n_NE-sum(as.vector(taula[,3]))),"
"0","            round(100*c(as.vector(taula[,3]),n_NE-sum(as.vector(taula[,3])))/n_NE,2)"
"0","           )"
"0","EEExt=rbind(EEExt,c(n_AS,100,n_SL,100,n_NE,100))"
"0",""
"0","rownames(EEExt)=c(L1,L2,""Pérdidas"",""Total"")"
"0","colnames(EEExt)=Columnes.Sint"
"0",""
"0","EEExt %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")"
"0","}"
"0",""
"0",""
"0","Tabla.DGSW=function(I,L1,L2){"
"0","DF=data.frame(Factor=I,Síntomas=Sint)"
"0","taula=table(DF)[c(2,1) ,]"
"0","proptaula=round(100*prop.table(taula,margin=2),2)"
"0",""
"0","EEExt=cbind(as.vector(taula[,1]),"
"0","            as.vector(proptaula[,1]),"
"0","            as.vector(taula[,2]),"
"0","            as.vector(proptaula[,2]),"
"0","            as.vector(taula[,3]),"
"0","            as.vector(proptaula[,3])"
"0","            )"
"0","rownames(EEExt)=c(L1,L2)"
"0","colnames(EEExt)=Columnes.Sint"
"0",""
"0","EEExt %>%"
"0","  kbl() %>%"
"0","  kable_styling()"
"0","}"
"0",""
"0",""
"0","# Barplots descripción global sintomatología"
"0",""
"0","Barplot.DGS=function(I,L1,L2){"
"0","taula=table(data.frame(Factor=I,Síntomas=Sint))[c(2,1) ,1:3]"
"0","Síntomas=ordered(rep(c(""Asintomática"", ""Leve"", ""Grave""), each=2),levels=c(""Asintomática"", ""Leve"", ""Grave""))"
"0","Grupo=ordered(rep(c(L1, L2) , 3),levels=c(L1, L2))"
"0","valor=as.vector(prop.table(taula, margin=1))"
"0","data <- data.frame(Grupo,Síntomas,valor)"
"0",""
"0","ggplot(data, aes(fill=Síntomas, y=valor, x=Grupo)) + "
"0","  geom_bar(position=""dodge"", stat=""identity"")+"
"0","  ylab("""")+"
"0","  xlab("""")+  "
"0","  scale_fill_brewer(palette = ""Dark2"") "
"0","}"
"0",""
"0",""
"0","Barplot.DGSW=function(I,L1,L2){"
"0","taula=table(data.frame(Factor=I,Síntomas=Sint))[c(2,1),]"
"0","Síntomas=ordered(rep(c(""Asintomática"", ""Leve"", ""Grave""), each=2),levels=c(""Asintomática"", ""Leve"", ""Grave""))"
"0","Grupo=ordered(rep(c(L1,L2) , 3),levels=c(L1,L2))"
"0","valor=as.vector(prop.table(taula, margin=1))"
"0","data <- data.frame(Grupo,Síntomas,valor)"
"0",""
"0","ggplot(data, aes(fill=Síntomas, y=valor, x=Grupo)) + "
"0","  geom_bar(position=""dodge"", stat=""identity"")+"
"0","  ylab("""")+"
"0","  xlab("""")+  "
"0","  scale_fill_brewer(palette = ""Dark2"") "
"0","}"
"0",""
"0","# Tabla de comparación entre olas: Casos y controles"
"0",""
"0","ComparOlasCC=function(I1,I2,NI1,NI2,L1,L2){"
"0","NA_I1=length(I1[is.na(I1)])"
"0","NA_NI1=length(NI1[is.na(NI1)])"
"0","NA_I2=length(I2[is.na(I2)])"
"0","NA_NI2=length(NI2[is.na(NI2)])"
"0","EEExt=cbind(c(as.vector(table(I1))[2:1],NA_I1),"
"0","            round(100*c(as.vector(table(I1))[2:1],NA_I1)/n_I1,1),"
"0","            c(as.vector(table(NI1))[2:1],NA_NI1),"
"0","            round(100*c(as.vector(table(NI1))[2:1],NA_NI1)/n_NI1,1),"
"0","            c(as.vector(table(I2))[2:1],NA_I2),"
"0","            round(100*c(as.vector(table(I2))[2:1],NA_I2)/n_I2,1),"
"0","            c(as.vector(table(NI2))[2:1],NA_NI2),"
"0","            round(100*c(as.vector(table(NI2))[2:1],NA_NI2)/n_NI2,1)"
"0","            )"
"0","colnames(EEExt)=ColumnesExt"
"0","rownames(EEExt)=c(L1, L2,""Pérdidas"")"
"0","EEExt %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")  "
"0","}"
"0",""
"0","GrComparOlasCC=function(I1,I2,NI1,NI2,L1){"
"0","base=c(""1a ola"",""2a ola"")"
"0","df=data.frame("
"0","Factor=c(rep(""Infectadas 1a ola"",length(I1)), rep(""No infectadas 1a ola"",length(NI1)),rep(""Infectadas 2a ola"",length(I2)), rep(""No infectadas 2a ola"",length(NI2))),"
"0","Grupo=c(I1,NI1,I2,NI2 )"
"0",")"
"0","Grupo=ordered(rep(c(""Infectadas"",""No infectadas""), 2),levels=c(""Infectadas"",""No infectadas""))"
"0","Ola=ordered(rep(base , each=2),levels=base)"
"0","valor=as.vector(100*prop.table(table(df)[c(1,3,2,4),2:1], margin=1))[1:4]"
"0","data=data.frame(Grupo,Ola,valor)"
"0","data %>%"
"0","ggplot(aes(fill=Grupo, y=valor, x=Ola)) + "
"0","  geom_bar(position=""dodge"", stat=""identity"")+"
"0","xlab("""")+"
"0","  ylab(paste(L1,""(%)""))+"
"0","scale_fill_hue(c=100)+labs(fill="""")}"
"0",""
"0",""
"0","# Tabla de comparación entre olas: Global"
"0",""
"0","ComparOlasGl=function(Tot1w,Tot2w,L1,L2){"
"0","n_1=length(Tot1w)"
"0","n_2=length(Tot2w)"
"0",""
"0","NA_1=length(Tot1w[is.na(Tot1w)])"
"0","NA_2=length(Tot2w[is.na(Tot2w)])"
"0",""
"0","EEExt=cbind(c(as.vector(table(Tot1w))[2:1],NA_1),"
"0","            round(100*c(as.vector(table(Tot1w))[2:1],NA_1)/n_1,1),"
"0","            c(as.vector(table(Tot2w))[2:1],NA_2),"
"0","            round(100*c(as.vector(table(Tot2w))[2:1],NA_2)/n_2,1)"
"0","            )"
"0","colnames(EEExt)=ColumnesOnes"
"0","rownames(EEExt)=c(L1,L2,""Pérdidas"")"
"0","EEExt %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")"
"0","}"
"0",""
"0","# Tabla de comparación Anteparto-Periparto"
"0",""
"0","TablaAntePeri=function(I,NI,L1,L2){"
"0","I.AP=I[Casos$PreP==1]"
"0","I.PP=I[Casos$PreP==0]"
"0","NA_IAP=length(I.AP[is.na(I.AP)])"
"0","NA_IPP=length(I.PP[is.na(I.PP)])"
"0","NA_NI=length(NI[is.na(NI)])"
"0","EEExt=rbind(c(as.vector(table(I.AP))[2:1],NA_IAP),"
"0","            round(100*c(as.vector(table(I.AP))[2:1],NA_IAP)/n_IAP,1),"
"0","            c(as.vector(table(I.PP))[2:1],NA_IPP),"
"0","            round(100*c(as.vector(table(I.PP))[2:1],NA_IPP)/n_IPP,1),"
"0","            c(as.vector(table(NI))[2:1],NA_NI),"
"0","            round(100*c(as.vector(table(NI))[2:1],NA_NI)/n_NI,1))"
"0","rownames(EEExt)=ColumnesP"
"0","colnames(EEExt)=c(L1,L2,""Pérdidas"")"
"0","t(EEExt) %>%"
"0","  kbl() %>%"
"0","  kable_styling()"
"0","}"
"0",""
"0","# Tablas 2d Robson"
"0",""
"0","TablaRobsonGlobal=function(TR1,TR2,x,y=x){"
"0","EE1=t(TR1)[2:1,2:11]"
"0","EE2=t(TR2)[2:1,2:11]"
"0","OR=rep(0,10)"
"0","pp=rep(0,10)"
"0","for (i in 1:10){"
"0","FT=fisher.test(cbind(EE1[,i],EE2[,i]))"
"0","OR[i]=FT$estimate"
"0","pp[i]=FT$p.value       }"
"0",""
"0","dt=data.frame(1:10,colSums(EE1),EE1[1,],round(100*prop.table(EE1,margin=2)[1,],2),colSums(EE2),EE2[1,],round(100*prop.table(EE2,margin=2)[1,],2),round(OR,2),round(pp,3))"
"0","names(dt)=c(""Grupo Robson"", paste(""Casos"",x), ""Cesáreas"", ""Porcentaje"",  paste(""Controles"",y), ""Cesáreas"", ""Porcentaje"",""OR"",""p-valor test de Fisher"")"
"0","dt %>%"
"0","  kbl() %>%"
"0","  kable_styling()%>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")}"
