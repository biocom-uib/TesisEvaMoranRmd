"0","Tabla.DMCasos=function(I,L1,L2,r=6){"
"0","I=factor(I)"
"0","IA=I[Casos$SINTOMAS_DIAGNOSTICO==""Asintomática""]"
"0","IL=I[Casos$SINTOMAS_DIAGNOSTICO==""Leve""]"
"0","IG=I[Casos$SINTOMAS_DIAGNOSTICO==""Grave""]"
"0","NA_A=length(IA[is.na(IA)])"
"0","NA_L=length(IL[is.na(IL)])"
"0","NA_G=length(IG[is.na(IG)])"
"0",""
"0","EEExt=cbind(c(as.vector(table(IA))[2:1],NA_A),"
"0","            c(round(100*as.vector(prop.table(table(IA))[2:1]),1),NA),"
"0","            c(as.vector(table(IL))[2:1],NA_L),"
"0","            c(round(100*as.vector(prop.table(table(IL))[2:1]),1),NA),"
"0","            c(as.vector(table(IG))[2:1],NA_G),"
"0","            c(round(100*as.vector(prop.table(table(IG))[2:1]),1),NA)"
"0","            )"
"0",""
"0","test=chisq.test(EEExt[1:2,c(1,3,5)])"
"0","if(any(test$expected< 5))"
"0","  {"
"0","p.val=round(chisq.test(EEExt[1:2,c(1,3,5)],simulate.p.value=TRUE,B=10000)$p.value,r)"
"0","tipus=""Montecarlo""} else"
"0","  {"
"0","   p.val=round(test$p.value,r)"
"0","   tipus=""Paramétrico"""
"0","   }"
"0","EEExt=cbind(data.frame(EEExt),c(p.val,NA,NA),c(tipus,NA,NA))"
"0","rownames(EEExt)=c(L1,L2,""Datos perdidos"")"
"0","colnames(EEExt)=c(Columnes.Sint,""p-valor"",""Tipo"")"
"0",""
"0","EEExt %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")"
"0","}"
"0","######"
"0","#####"
"0","Tabla.DMCasos3=function(I,L1,L2,L3,r=6){"
"0","IA=I[Casos$SINTOMAS_DIAGNOSTICO==""Asintomática""]"
"0","IL=I[Casos$SINTOMAS_DIAGNOSTICO==""Leve""]"
"0","IG=I[Casos$SINTOMAS_DIAGNOSTICO==""Grave""]"
"0","NA_A=length(IA[is.na(IA)])"
"0","NA_L=length(IL[is.na(IL)])"
"0","NA_G=length(IG[is.na(IG)])"
"0",""
"0","EEExt=cbind(c(as.vector(table(IA)),NA_A),"
"0","            c(round(100*as.vector(prop.table(table(IA))),1),NA),"
"0","            c(as.vector(table(IL)),NA_L),"
"0","            c(round(100*as.vector(prop.table(table(IL))),1),NA),"
"0","            c(as.vector(table(IG)),NA_G),"
"0","            c(round(100*as.vector(prop.table(table(IG))),1),NA)"
"0","            )"
"0","p.val=rep(NA,4)"
"0","tipus=rep(NA,4)"
"0","taula=EEExt[1:3,c(1,3,5)]"
"0","for (i in 1:3){"
"0","X=rbind(taula[i,],colSums(taula)-taula[i,])"
"0","test=chisq.test(X)"
"0","if(any(test$expected< 5))"
"0","  {"
"0","p.val[i]=round(chisq.test(X,simulate.p.value=TRUE,B=10000)$p.value,r)"
"0","tipus[i]=""Montecarlo""}"
"0","else"
"0","  {"
"0","   p.val[i]=round(test$p.value,r)"
"0","   tipus[i]=""Paramétrico"""
"0","  }"
"0","}"
"0","EEExt=cbind(data.frame(EEExt),p.val,tipus)"
"0","rownames(EEExt)=c(L1,L2,L3,""Datos perdidos"")"
"0","colnames(EEExt)=c(Columnes.Sint,""p-valor"",""Tipo"")"
"0",""
"0","EEExt %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")"
"0","}"
"0","######"
"0","#####"
"0","Tabla.DMCasos4=function(I,L1,L2,L3,L4,r=6){"
"0","IA=I[Casos$SINTOMAS_DIAGNOSTICO==""Asintomática""]"
"0","IL=I[Casos$SINTOMAS_DIAGNOSTICO==""Leve""]"
"0","IG=I[Casos$SINTOMAS_DIAGNOSTICO==""Grave""]"
"0","NA_A=length(IA[is.na(IA)])"
"0","NA_L=length(IL[is.na(IL)])"
"0","NA_G=length(IG[is.na(IG)])"
"0",""
"0","EEExt=cbind(c(as.vector(table(IA)),NA_A),"
"0","            c(round(100*as.vector(prop.table(table(IA))),1),NA),"
"0","            c(as.vector(table(IL)),NA_L),"
"0","            c(round(100*as.vector(prop.table(table(IL))),1),NA),"
"0","            c(as.vector(table(IG)),NA_G),"
"0","            c(round(100*as.vector(prop.table(table(IG))),1),NA)"
"0","            )"
"0","p.val=rep(NA,5)"
"0","tipus=rep(NA,5)"
"0","taula=EEExt[1:4,c(1,3,5)]"
"0","for (i in 1:4){"
"0","X=rbind(taula[i,],colSums(taula)-taula[i,])"
"0","test=chisq.test(X)"
"0","if(any(test$expected< 5))"
"0","  {"
"0","p.val[i]=round(chisq.test(X,simulate.p.value=TRUE,B=10000)$p.value,r)"
"0","tipus[i]=""Montecarlo""}"
"0","else"
"0","  {"
"0","   p.val[i]=round(test$p.value,r)"
"0","   tipus[i]=""Paramétrico"""
"0","  }"
"0","}"
"0","EEExt=cbind(data.frame(EEExt),p.val,tipus)"
"0","rownames(EEExt)=c(L1,L2,L3,L4,""Datos perdidos"")"
"0","colnames(EEExt)=c(Columnes.Sint,""p-valor"",""Tipo"")"
"0",""
"0","EEExt %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")"
"0","}"
"0","######"
"0","#####"
"0","Tabla.DMCasos5=function(I,L1,L2,L3,L4,L5,r=6){"
"0","IA=I[Casos$SINTOMAS_DIAGNOSTICO==""Asintomática""]"
"0","IL=I[Casos$SINTOMAS_DIAGNOSTICO==""Leve""]"
"0","IG=I[Casos$SINTOMAS_DIAGNOSTICO==""Grave""]"
"0","NA_A=length(IA[is.na(IA)])"
"0","NA_L=length(IL[is.na(IL)])"
"0","NA_G=length(IG[is.na(IG)])"
"0",""
"0","EEExt=cbind(c(as.vector(table(IA)),NA_A),"
"0","            c(round(100*as.vector(prop.table(table(IA))),1),NA),"
"0","            c(as.vector(table(IL)),NA_L),"
"0","            c(round(100*as.vector(prop.table(table(IL))),1),NA),"
"0","            c(as.vector(table(IG)),NA_G),"
"0","            c(round(100*as.vector(prop.table(table(IG))),1),NA)"
"0","            )"
"0","p.val=rep(NA,6)"
"0","tipus=rep(NA,6)"
"0","taula=EEExt[1:5,c(1,3,5)]"
"0","for (i in 1:5){"
"0","X=rbind(taula[i,],colSums(taula)-taula[i,])"
"0","test=chisq.test(X)"
"0","if(any(test$expected< 5))"
"0","  {"
"0","p.val[i]=round(chisq.test(X,simulate.p.value=TRUE,B=10000)$p.value,r)"
"0","tipus[i]=""Montecarlo""}"
"0","else"
"0","  {"
"0","   p.val[i]=round(test$p.value,r)"
"0","   tipus[i]=""Paramétrico"""
"0","  }"
"0","}"
"0","EEExt=cbind(data.frame(EEExt),p.val,tipus)"
"0","rownames(EEExt)=c(L1,L2,L3,L4,L5,""Datos perdidos"")"
"0","colnames(EEExt)=c(Columnes.Sint,""p-valor"",""Tipo"")"
"0",""
"0","EEExt %>%"
"0","  kbl() %>%"
"0","  kable_styling() %>%     "
"0","  scroll_box(width=""100%"", box_css=""border: 0px;"")"
"0","}"
