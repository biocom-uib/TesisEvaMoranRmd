# Comparación de las dos olas

## Gravedad en la infeccion

```{r}
Sint1w=Casos1w$SINTOMAS_DIAGNOSTICO
Sint2w=Casos2w$SINTOMAS_DIAGNOSTICO
Sint=c(Sint1w,Sint2w)
EEExt=rbind(c(table(Sint1w)[1],round(100*prop.table(table(Sint1w)),2)[1],
              table(Sint1w)[2],round(100*prop.table(table(Sint1w)),2)[2],
              table(Sint1w)[3],round(100*prop.table(table(Sint1w)),2)[3],
              length(Sint1w)),
            c(table(Sint2w)[1],round(100*prop.table(table(Sint2w)),2)[1],
              table(Sint2w)[2],round(100*prop.table(table(Sint2w)),2)[2],
              table(Sint2w)[3],round(100*prop.table(table(Sint2w)),2)[3],
              length(Sint2w))
            )
EEE=EEExt[,c(1,3,5)]

rownames(EEExt)=c("Infectadas 1a ola", "Infectadas 2a ola")
colnames(EEExt)=c("Asintomáticas (N)", "Asintomáticas (%)","Síntomas leves (N)", "Síntomas leves (%)", "Neumonía (N)", "Neumonía (%)","Total")

EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")



```

```{r 401,fig.cap="\\s"}
df =data.frame(
  Ola=c(rep("1a ola",length(Sint1w)), rep("2a ola",length(Sint2w))),
  Sintomas=c(Sint1w,Sint2w)
)

Gravedad=ordered(rep(c("Asintomáticas", "Síntomas leves", "Neumonía"), each=2),levels=c("Asintomáticas", "Síntomas leves", "Neumonía"))
Grupo=rep(c("1a ola","2a ola") , 3)
valor=as.vector(prop.table(table(df), margin=1))
data <- data.frame(Gravedad,Grupo,valor)


ggplot(data, aes(fill=Gravedad, y=valor, x=Grupo)) + 
  geom_bar(position="dodge", stat="identity")+
  xlab("Olas")+
  ylab("")+
    scale_fill_brewer(palette="Dark2")+labs(fill="")


```


* Asociación entre los grupos de sintomatología y las olas: test $\chi^2$, p-valor $`r signif(chisq.test(EEE)$p.value,1)`$



* Test de diferencia en la tendencia de la gravedad : p-valor $`r signif(Prop.trend.test(EEE[1,],colSums(EEE)),1)`$


## Comparación de antecedentes


### Hábito tabáquico


```{r 452,fig.cap="\\s"}
I1=Casos1w$FUMADORA_CAT
I2=Casos2w$FUMADORA_CAT
NI1=Controls1w$Fumadora_cat
NI2=Controls2w$Fumadora_cat
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
ComparOlasCC(I1,I2,NI1,NI2,"Fumadoras","No fumadoras")
GrComparOlasCC(I1,I2,NI1,NI2,"Fumadoras")
```



Comparación de OR: 

* OR univariante en la 1a ola `r round(fisher.test(EE[,1:2])$estimate,2)`; OR univariante en la 2a ola `r round(fisher.test(EE[,3:4])$estimate,2)`; cociente `r round(fisher.test(EE[,1:2])$estimate/fisher.test(EE[,3:4])$estimate,4)`
* p-valor del contraste de igualdad entre OR `r round(OR.OR(EE)[1],3)`; 
* IC-95% para el cociente  "OR-en-la-1a-ola"/"OR-en-la-2a-ola"	[`r round(OR.OR(EE)[2:3],4)`]


### Obesidad


```{r 453,fig.cap="\\s"}
I1=Casos1w$Obesidad
I2=Casos2w$Obesidad
I2[I2=="No"]=0
I2[I2=="Sí"]=1
I1[I1=="No"]=0
I1[I1=="Sí"]=1
#
NI1=Controls1w$Obesidad
NI2=Controls2w$Obesidad
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
ComparOlasCC(I1,I2,NI1,NI2,"Obesas","No obesas")
GrComparOlasCC(I1,I2,NI1,NI2,"Obesas")
```



Comparación de OR: 

* OR univariante en la 1a ola `r round(fisher.test(EE[,1:2])$estimate,2)`; OR univariante en la 2a ola `r round(fisher.test(EE[,3:4])$estimate,2)`; cociente `r round(fisher.test(EE[,1:2])$estimate/fisher.test(EE[,3:4])$estimate,4)`

* p-valor del contraste de igualdad entre OR `r round(OR.OR(EE)[1],3)`; 
* IC-95% para el cociente  "OR-en-la-1a-ola"/"OR-en-la-2a-ola"	[`r round(OR.OR(EE)[2:3],4)`]

### Hipertensión pregestacional


```{r 454,fig.cap="\\s"}
I1=Casos1w$Hipertensión.pregestacional
I2=Casos2w$Hipertensión.pregestacional
I2[I2=="No"]=0
I2[I2=="Sí"]=1
I1[I1=="No"]=0
I1[I1=="Sí"]=1
#
NI1=Controls1w$Hipertensión.pregestacional
NI2=Controls2w$Hipertensión.pregestacional
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
ComparOlasCC(I1,I2,NI1,NI2,"HTA","No HTA")
GrComparOlasCC(I1,I2,NI1,NI2,"HTA")
```



Comparación de OR: 

* OR univariante en la 1a ola `r round(fisher.test(EE[,1:2])$estimate,2)`; OR univariante en la 2a ola `r round(fisher.test(EE[,3:4])$estimate,2)`; cociente `r round(fisher.test(EE[,1:2])$estimate/fisher.test(EE[,3:4])$estimate,4)`
* p-valor del contraste de igualdad entre OR `r round(OR.OR(EE)[1],3)`; 
* IC-95% para el cociente  "OR-en-la-1a-ola"/"OR-en-la-2a-ola"	[`r round(OR.OR(EE)[2:3],4)`]

### Diabetes Mellitus 

```{r 455,fig.cap="\\s"}
I1=Casos1w$DIABETES
I2=Casos2w$DIABETES
I2[I2=="No"]=0
I2[I2=="Sí"]=1
I1[I1=="No"]=0
I1[I1=="Sí"]=1
#
NI1=Controls1w$Diabetes
NI2=Controls2w$Diabetes
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
ComparOlasCC(I1,I2,NI1,NI2,"DM","No DM")
GrComparOlasCC(I1,I2,NI1,NI2,"DM")
```




Comparación de OR: 

* OR univariante en la 1a ola `r round(fisher.test(EE[,1:2])$estimate,2)`; OR univariante en la 2a ola `r round(fisher.test(EE[,3:4])$estimate,2)`; cociente `r round(fisher.test(EE[,1:2])$estimate/fisher.test(EE[,3:4])$estimate,4)`
* p-valor del contraste de igualdad entre OR `r round(OR.OR(EE)[1],3)`; 
* IC-95% para el cociente  "OR-en-la-1a-ola"/"OR-en-la-2a-ola"	[`r round(OR.OR(EE)[2:3],4)`]

### Enfermedades cardiacas crónicas 


```{r 456,fig.cap="\\s"}
I1=Casos1w$Enfermedad.cardiaca.crónica
I2=Casos2w$Enfermedad.cardiaca.crónica
I2[I2=="No"]=0
I2[I2=="Sí"]=1
I1[I1=="No"]=0
I1[I1=="Sí"]=1
#
NI1=Controls1w$ENF.CARDIACA.TODO
NI2=Controls2w$ENF.CARDIACA.TODO
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
ComparOlasCC(I1,I2,NI1,NI2,"ECC","No ECC")
GrComparOlasCC(I1,I2,NI1,NI2,"ECC")
```




Comparación de OR: 

* OR univariante en la 1a ola `r round(fisher.test(EE[,1:2])$estimate,2)`; OR univariante en la 2a ola `r round(fisher.test(EE[,3:4])$estimate,2)`; cociente `r round(fisher.test(EE[,1:2])$estimate/fisher.test(EE[,3:4])$estimate,4)`
* p-valor del contraste de igualdad entre OR `r round(OR.OR(EE)[1],3)`; 
* IC-95% para el cociente  "OR-en-la-1a-ola"/"OR-en-la-2a-ola"	[`r round(OR.OR(EE)[2:3],4)`]

### Enfermedades pulmonares crónicas (incluyendo asma)

```{r 457,fig.cap="\\s"}
INA1w=Casos1w$Enfermedad.pulmonar.crónica.no.asma
NINA1w=Controls1w$Enfermedad.pulmonar.crónica.no.asma
NINA1w[NINA1w==0]="No"
NINA1w[NINA1w==1]="Sí"
IA1w=Casos1w$Diagnóstico.clínico.de.Asma
NIA1w=Controls1w$Diagnóstico.clínico.de.Asma
NIA1w[NIA1w==0]="No"
NIA1w[NIA1w==1]="Sí"
I1=rep(NA,n_I1)
for (i in 1:n_I1){I1[i]=max(INA1w[i],IA1w[i],na.rm=TRUE)}
NI1=rep(NA,n_NI1)
for (i in 1:n_NI1){NI1[i]=max(NINA1w[i],NIA1w[i],na.rm=TRUE)}
NI1[NI1==-Inf]=NA


INA2w=Casos2w$Enfermedad.pulmonar.crónica.no.asma
NINA2w=Controls2w$Enfermedad.pulmonar.crónica.no.asma
NINA2w[NINA2w==0]="No"
NINA2w[NINA2w==1]="Sí"
IA2w=Casos2w$Diagnóstico.clínico.de.Asma
NIA2w=Controls2w$Diagnóstico.clínico.de.Asma
NIA2w[NIA2w==0]="No"
NIA2w[NIA2w==1]="Sí"
I2=rep(NA,n_I2)
for (i in 1:n_I2){I2[i]=max(INA2w[i],IA2w[i],na.rm=TRUE)}
NI2=rep(NA,n_NI2)
for (i in 1:n_NI2){NI2[i]=max(NINA2w[i],NIA2w[i],na.rm=TRUE)}
NI2[NI2==-Inf]=NA
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
ComparOlasCC(I1,I2,NI1,NI2,"EPC","No EPC")
GrComparOlasCC(I1,I2,NI1,NI2,"EPC")
```






Comparación de OR: 

* OR univariante en la 1a ola `r round(fisher.test(EE[,1:2])$estimate,2)`; OR univariante en la 2a ola `r round(fisher.test(EE[,3:4])$estimate,2)`; cociente `r round(fisher.test(EE[,1:2])$estimate/fisher.test(EE[,3:4])$estimate,4)`
* p-valor del contraste de igualdad entre OR `r round(OR.OR(EE)[1],3)`; 
* IC-95% para el cociente  "OR-en-la-1a-ola"/"OR-en-la-2a-ola"	[`r round(OR.OR(EE)[2:3],4)`]


### Paridad

```{r 458,fig.cap="\\s"}
I1=Casos1w$NULIPARA
I2=Casos2w$NULIPARA
NI1=Controls1w$Nuliparous
NI2=Controls2w$Nuliparous
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
ComparOlasCC(I1,I2,NI1,NI2,"Nulípara","Multípara")
GrComparOlasCC(I1,I2,NI1,NI2,"Nulípara")
```




Comparación de OR: 

* OR univariante en la 1a ola `r round(fisher.test(EE[,1:2])$estimate,2)`; OR univariante en la 2a ola `r round(fisher.test(EE[,3:4])$estimate,2)`; cociente `r round(fisher.test(EE[,1:2])$estimate/fisher.test(EE[,3:4])$estimate,4)`
* p-valor del contraste de igualdad entre OR `r round(OR.OR(EE)[1],3)`; 
* IC-95% para el cociente  "OR-en-la-1a-ola"/"OR-en-la-2a-ola"	[`r round(OR.OR(EE)[2:3],4)`]

### Gestación múltiple

```{r 459,fig.cap="\\s"}
I1=Casos1w$Gestación.Múltiple
I2=Casos2w$Gestación.Múltiple
I2[I2=="No"]=0
I2[I2=="Sí"]=1
I1[I1=="No"]=0
I1[I1=="Sí"]=1
#
NI1=Controls1w$Gestación.Múltiple
NI2=Controls2w$Gestación.Múltiple
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
ComparOlasCC(I1,I2,NI1,NI2,"Gestación múltiple", "Gestación única")
GrComparOlasCC(I1,I2,NI1,NI2,"Gestación múltiple")
```





Comparación de OR: 

* OR univariante en la 1a ola `r round(fisher.test(EE[,1:2])$estimate,2)`; OR univariante en la 2a ola `r round(fisher.test(EE[,3:4])$estimate,2)`; cociente `r round(fisher.test(EE[,1:2])$estimate/fisher.test(EE[,3:4])$estimate,4)`
* p-valor del contraste de igualdad entre OR `r round(OR.OR(EE)[1],3)`; 
* IC-95% para el cociente  "OR-en-la-1a-ola"/"OR-en-la-2a-ola"	[`r round(OR.OR(EE)[2:3],4)`]





## Comparación de riesgos de desenlaces



### Hipertensión gestacional 




```{r 462,fig.cap="\\s"}
I1=Casos1w$Hipertensión.gestacional
I2=Casos2w$Hipertensión.gestacional
I2[I2=="No"]=0
I2[I2=="Sí"]=1
I1[I1=="No"]=0
I1[I1=="Sí"]=1
#
NI1=Controls1w$Hipertensión.gestacional
NI2=Controls2w$Hipertensión.gestacional
ComparOlasCC(I1,I2,NI1,NI2,"HG", "No HG")
GrComparOlasCC(I1,I2,NI1,NI2,"HG")
```


```{r}
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```






* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]


* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"	[`r round(RR.RR(EE)[3:4],3)`]



### Diabetes gestacional 




```{r 463,fig.cap="\\s"}
I1=Casos1w$Diabetes.gestacional
I2=Casos2w$Diabetes.gestacional
I2[I2=="No"]=0
I2[I2=="Sí"]=1
I1[I1=="No"]=0
I1[I1=="Sí"]=1
#
NI1=Controls1w$Diabetes.gestacional
NI2=Controls2w$Diabetes.gestacional
ComparOlasCC(I1,I2,NI1,NI2,"DG", "No DG")
GrComparOlasCC(I1,I2,NI1,NI2,"DG")
```





```{r}
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")
```






* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]


* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"	[`r round(RR.RR(EE)[3:4],3)`]






### Preeclampsia




```{r 402,fig.cap="\\s"}
I1=Casos1w$PREECLAMPSIA_ECLAMPSIA_TOTAL
I2=Casos2w$PREECLAMPSIA_ECLAMPSIA_TOTAL
NI1=Controls1w$PREECLAMPSIA
NI2=Controls2w$PREECLAMPSIA
ComparOlasCC(I1,I2,NI1,NI2,"PE", "No PE")
GrComparOlasCC(I1,I2,NI1,NI2,"PE")
```



```{r}
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```






* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]


* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"	[`r round(RR.RR(EE)[3:4],3)`]


### Preeclampsia con CG entre las preeclámpsicas


```{r}
n_PI1=sum(Casos1w$PREECLAMPSIA_ECLAMPSIA_TOTAL)
n_PNI1=sum(Controls1w$PREECLAMPSIA)
n_PI2=sum(Casos2w$PREECLAMPSIA_ECLAMPSIA_TOTAL)
n_PNI2=sum(Controls2w$PREECLAMPSIA)

I1=Casos1w[Casos1w$PREECLAMPSIA_ECLAMPSIA_TOTAL==1,]$Preeclampsia.grave_HELLP_ECLAMPSIA
I1[I1=="Sí"]=1
I1[I1=="No"]=0
I2=Casos2w[Casos2w$PREECLAMPSIA_ECLAMPSIA_TOTAL==1,]$Preeclampsia.grave_HELLP_ECLAMPSIA
I2[I2=="Sí"]=1
I2[I2=="No"]=0

NI1.1=Controls1w[Controls1w$PREECLAMPSIA==1,]$preeclampsia_severa
NI1.2=Controls1w[Controls1w$PREECLAMPSIA==1,]$Preeclampsia.grave.No.HELLP 
NI1=rep(NA,length(NI1.1))
for (i in 1:length(NI1.1)){NI1[i]=max(NI1.1[i],NI1.2[i],na.rm=TRUE)}

NI2.1=Controls2w[Controls2w$PREECLAMPSIA==1,]$preeclampsia_severa
NI2.2=Controls2w[Controls2w$PREECLAMPSIA==1,]$Preeclampsia.grave.No.HELLP 
NI2=rep(NA,length(NI2.1))
for (i in 1:length(NI2.1)){NI2[i]=max(NI2.1[i],NI2.2[i],na.rm=TRUE)}


NA_I1=length(I1[is.na(I1)])
NA_NI1=length(NI1[is.na(NI1)])
NA_I2=length(I2[is.na(I2)])
NA_NI2=length(NI2[is.na(NI2)])

```

```{r}
EEExt=cbind(c(as.vector(table(I1))[2:1],NA_I1),
            round(100*c(as.vector(table(I1))[2:1],NA_I1)/n_PI1,1),
            c(as.vector(table(NI1))[2:1],NA_NI1),
            round(100*c(as.vector(table(NI1))[2:1],NA_NI1)/n_PNI1,1),
            c(as.vector(table(I2))[2:1],NA_I2),
            round(100*c(as.vector(table(I2))[2:1],NA_I2)/n_PI2,1),
            c(as.vector(table(NI2))[2:1],NA_NI2),
            round(100*c(as.vector(table(NI2))[2:1],NA_NI2)/n_PNI2,1)
            )
colnames(EEExt)=ColumnesExt
rownames(EEExt)=c("PE con CG", "PE sin CG","Pérdidas")
EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")



```




```{r 403,fig.cap="\\s"}
base=c("1a ola","2a ola")

df =data.frame(
  Factor=c(rep("Infectadas 1a ola",length(I1)), rep("No infectadas 1a ola",length(NI1)),rep("Infectadas 2a ola",length(I2)), rep("No infectadas 2a ola",length(NI2))),
  Grupo=c(I1,NI1,I2,NI2)
)

Grupo=ordered(rep(c("Infectadas","No infectadas"), 2),levels=c("Infectadas","No infectadas"))
Ola=ordered(rep(base , each=2),levels=base)
valor=as.vector(100*prop.table(table(df)[c(1,3,2,4),2:1], margin=1))[1:4]
data=data.frame(Grupo,Ola,valor)


data %>%
ggplot(aes(fill=Grupo, y=valor, x=Ola)) + 
  geom_bar(position="dodge", stat="identity")+
xlab("")+
  ylab("Preeclampsias con CG (% de preeclampsias)")+
scale_fill_hue(c=100)+labs(fill="")
```




```{r}
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")


```


* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]



* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"	[`r round(RR.RR(EE)[3:4],3)`]



### Prematurez


```{r 404,fig.cap="\\s"}
I1=Casos1w$PREMATURO
I2=Casos2w$PREMATURO
NI1=Controls1w$Preterm.deliveries
NI2=Controls2w$Preterm.deliveries
ComparOlasCC(I1,I2,NI1,NI2,"Prematuro", "A término")
GrComparOlasCC(I1,I2,NI1,NI2,"Prematuro")
```



```{r}
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")
```

* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]

* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"		[`r round(RR.RR(EE)[3:4],3)`]



### Eventos hemorrágicos


```{r 405,fig.cap="\\s"}
I1=Casos1w$EVENTOS_HEMORRAGICOS_TOTAL
I2=Casos2w$EVENTOS_HEMORRAGICOS_TOTAL
NI1=Controls1w$eventos_hemorragicos
NI2=Controls2w$eventos_hemorragicos
ComparOlasCC(I1,I2,NI1,NI2,"Eventos hemorrágicos", "No eventos hemorrágicos")
GrComparOlasCC(I1,I2,NI1,NI2,"Eventos hemorrágicos")
```





```{r}
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")
```


* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]


* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"		[`r round(RR.RR(EE)[3:4],3)`]

### Eventos trombóticos


```{r 406,fig.cap="\\s"}
I1=factor(Casos1w$EVENTOS_TROMBO_TOTALES,levels=0:1)
I2=factor(Casos2w$EVENTOS_TROMBO_TOTALES,levels=0:1)
NI1a=Controls1w$DVT
NI1b=Controls1w$PE
NI1=rep(NA,length(NI1a))
for (i in 1:length(NI1a)){NI1[i]=max(NI1a[i],NI1b[i],na.rm=TRUE)}
NI1=factor(NI1,levels=0:1)
NI2a=Controls2w$DVT
NI2b=Controls2w$PE
NI2=rep(NA,length(NI2a))
for (i in 1:length(NI2a)){NI2[i]=max(NI2a[i],NI2b[i],na.rm=TRUE)}
NI2=factor(NI2,levels=0:1)

ComparOlasCC(I1,I2,NI1,NI2,"Eventos trombóticos", "No eventos trombóticos")
GrComparOlasCC(I1,I2,NI1,NI2,"Eventos trombóticos")
```







```{r}
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```


* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]


* RR: No tiene sentido (RR de la 1a ola es $`r Inf`$)


### Anomalías congénitas





```{r 407,fig.cap="\\s"}
I1=Casos1w$Diagnóstico.de.malformación.ecográfica._.semana.20._
I1[I1=="No"]=0
I1[I1=="Sí"]=1
I2=Casos2w$Diagnóstico.de.malformación.ecográfica._.semana.20._
I2[I2=="No"]=0
I2[I2=="Sí"]=1
NI1=Controls1w$Diagnóstico.de.malformación.ecográfica._.semana.20._
NI2=Controls2w$Diagnóstico.de.malformación.ecográfica._.semana.20._

ComparOlasCC(I1,I2,NI1,NI2,"Anomalías congénitas", "No anomalías congénitas")
GrComparOlasCC(I1,I2,NI1,NI2,"Anomalías congénitas")
```






```{r}
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```


* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]

* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"		[`r round(RR.RR(EE)[3:4],3)`]


### Embarazos con feto muerto anteparto



```{r 408,fig.cap="\\s"}
I1=Casos1w$Feto.muerto.intraútero
I1[I1=="Sí"]=1
I1[I1=="No"]=0
I2=Casos2w$Feto.muerto.intraútero
I2[I2=="Sí"]=1
I2[I2=="No"]=0


NI1a=Controls1w$Feto.vivo...194
NI1a[NI1a=="Sí"]=0
NI1a[NI1a=="No"]=1
NI1b=Controls1w$Feto.vivo...245
NI1b[NI1b=="Sí"]=0
NI1b[NI1b=="No"]=1
NI1=NI1a
for (i in 1:length(NI1a)){NI1[i]=max(NI1a[i],NI1b[i],na.rm=TRUE)}

NI2a=Controls2w$Feto.vivo...194
NI2a[NI2a=="Sí"]=0
NI2a[NI2a=="No"]=1
NI2b=Controls2w$Feto.vivo...245
NI2b[NI2b=="Sí"]=0
NI2b[NI2b=="No"]=1
NI2=NI2a
for (i in 1:length(NI2a)){NI2[i]=max(NI2a[i],NI2b[i],na.rm=TRUE)}
NI2=factor(NI2,levels=0:1)

ComparOlasCC(I1,I2,NI1,NI2,"Algún feto muerto anteparto", "Ningún feto muerto anteparto")
GrComparOlasCC(I1,I2,NI1,NI2,"Algún feto muerto anteparto")
```



```{r}
NI2=factor(NI2,levels=0:1)
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```


* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]


* RR: No tiene sentido (RR de la 2a ola es $`r Inf`$)



### Inicios de parto


```{r}
I1=Casos1w$Inicio.de.parto
I2=Casos2w$Inicio.de.parto
NI1=Controls1w$Inicio.de.parto
NI1[NI1=="Cesárea programada"]="Cesárea"
NI2=Controls2w$Inicio.de.parto
NI2[NI2=="Cesárea programada"]="Cesárea"
NA_I1=length(I1[is.na(I1)])
NA_NI1=length(NI1[is.na(NI1)])
NA_I2=length(I2[is.na(I2)])
NA_NI2=length(NI2[is.na(NI2)])
```

```{r}
EEExt=cbind(c(as.vector(table(I1))[c(2,3,1)],NA_I1),
            round(100*c(as.vector(table(I1))[c(2,3,1)],NA_I1)/n_I1,1),
            c(as.vector(table(NI1))[c(2,3,1)],NA_NI1),
            round(100*c(as.vector(table(NI1))[c(2,3,1)],NA_NI1)/n_NI1,1),
            c(as.vector(table(I2))[c(2,3,1)],NA_I2),
            round(100*c(as.vector(table(I2))[c(2,3,1)],NA_I2)/n_I2,1),
            c(as.vector(table(NI2))[c(2,3,1)],NA_NI2),
            round(100*c(as.vector(table(NI2))[c(2,3,1)],NA_NI2)/n_NI2,1)
            )
colnames(EEExt)=ColumnesExt
rownames(EEExt)=c("Espontáneo", "Inducido", "Cesárea programada","Pérdidas")

EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")
```

```{r 409,fig.cap="\\s"}
Tipo= c(I1,I2,NI1,NI2)
Tipo[Tipo=="Cesárea"]="Cesárea programada"
Tipo=ordered(Tipo, levels=c("Espontáneo", "Inducido", "Cesárea programada"))
dtbp=data.frame(Grupo=c(rep("Inf.",length(I1)+length(I2)),rep("No inf.",length(NI1)+length(NI2))),
Ola= c(rep("1a ola",length(I1)),rep("2a ola",length(I2)),rep("1a ola",length(NI1)),rep("2a ola",length(NI2))),  
Tipo
 )

ggplot(data=na.omit(dtbp))+
   geom_mosaic(aes(x=product(Tipo,Ola), fill=Grupo)) +
  theme_mosaic()+
  ylab("Inicio de parto")+
  xlab("")+
  scale_fill_discrete(name ="", labels=c("Infectadas", "No infectadas"))+
  scale_x_productlist(labels=c("Infectadas\n 1a ola",  "No infectadas\n 1a ola", "Infectadas\n 2a ola", "No infectadas\n 2a ola"))
```

```{r}
SRH=scheirerRayHare(Tipo ~ Grupo + Ola,data=dtbp,verbose=FALSE)$p.value[3]
```

* Test de interacción de Scheirer-Ray-Hare: p-valor, `r round(SRH,3)`. Para simplificar, un p-valor pequeño hubiera sido evidencia estadística de que la diferencia de la "gravedad mediana" de los inicios de parto en infectadas y no infectadas en las dos olas han sido diferentes.  No ha sido el caso.





#### Cesáreas programadas


```{r}
I1=Casos1w$Inicio.de.parto
I1=I1[!is.na(I1)]
I1[I1=="Cesárea"]=1
I1[I1!=1]=0

I2=Casos2w$Inicio.de.parto
I2=I2[!is.na(I2)]
I2[I2=="Cesárea"]=1
I2[I2!=1]=0

NI1=Controls1w$Inicio.de.parto
NI1=NI1[!is.na(NI1)]
NI1[NI1=="Cesárea programada"]=1
NI1[NI1!=1]=0

NI2=Controls2w$Inicio.de.parto
NI2=NI2[!is.na(NI2)]
NI2[NI2=="Cesárea programada"]=1
NI2[NI2!=1]=0
```


```{r 410,fig.cap="\\s"}
GrComparOlasCC(I1,I2,NI1,NI2,"Cesáreas programadas")
```

```{r}
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```


* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]


* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"		[`r round(RR.RR(EE)[3:4],3)`]


#### Partos inducidos


```{r}
I1=Casos1w$Inicio.de.parto
I1=I1[!is.na(I1)]
I1[I1=="Inducido"]=1
I1[I1!=1]=0

I2=Casos2w$Inicio.de.parto
I2=I2[!is.na(I2)]
I2[I2=="Inducido"]=1
I2[I2!=1]=0

NI1=Controls1w$Inicio.de.parto
NI1=NI1[!is.na(NI1)]
NI1[NI1=="Inducido"]=1
NI1[NI1!=1]=0

NI2=Controls2w$Inicio.de.parto
NI2=NI2[!is.na(NI2)]
NI2[NI2=="Inducido"]=1
NI2[NI2!=1]=0
```


```{r 411,fig.cap="\\s"}
GrComparOlasCC(I1,I2,NI1,NI2,"Partos inducidos")
```

```{r}
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```

* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]


* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"		[`r round(RR.RR(EE)[3:4],3)`]



#### Partos espontáneos


```{r}
I1=Casos1w$Inicio.de.parto
I1=I1[!is.na(I1)]
I1[I1=="Espontáneo"]=1
I1[I1!=1]=0

I2=Casos2w$Inicio.de.parto
I2=I2[!is.na(I2)]
I2[I2=="Espontáneo"]=1
I2[I2!=1]=0

NI1=Controls1w$Inicio.de.parto
NI1=NI1[!is.na(NI1)]
NI1[NI1=="Espontáneo"]=1
NI1[NI1!=1]=0

NI2=Controls2w$Inicio.de.parto
NI2=NI2[!is.na(NI2)]
NI2[NI2=="Espontáneo"]=1
NI2[NI2!=1]=0
```


```{r 412,fig.cap="\\s"}
GrComparOlasCC(I1,I2,NI1,NI2,"Partos espontáneos")
```

```{r}
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```

* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]


* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"		[`r round(RR.RR(EE)[3:4],3)`]


### Tipos de parto


```{r}
I1.In=Casos1w$Inicio.de.parto
I1=Casos1w$Tipo.de.parto
I1[I1.In=="Cesárea"]="Cesárea programada"
I1[I1=="Cesárea"]="Cesárea urgente"
#table(I1)

I2.In=Casos2w$Inicio.de.parto
I2=Casos2w$Tipo.de.parto
I2[I2.In=="Cesárea"]="Cesárea programada"
I2[I2=="Cesárea"]="Cesárea urgente"
#table(I2)

NI1.In=Controls1w$Inicio.de.parto
NI1=Controls1w$Tipo.de.parto
NI1[NI1.In=="Cesárea programada"]="Cesárea programada"
NI1[NI1=="Cesárea"]="Cesárea urgente"
#table(NI1)


NI2.In=Controls2w$Inicio.de.parto
NI2=Controls2w$Tipo.de.parto
NI2[NI2.In=="Cesárea programada"]="Cesárea programada"
NI2[NI2=="Cesárea"]="Cesárea urgente"
#table(NI2)


NA_I1=length(I1[is.na(I1)])
NA_NI1=length(NI1[is.na(NI1)])
NA_I2=length(I2[is.na(I2)])
NA_NI2=length(NI2[is.na(NI2)])
```


```{r}
EEExt=cbind(c(as.vector(table(I1))[c(3,4,1,2)],NA_I1),
            round(100*c(as.vector(table(I1))[c(3,4,1,2)],NA_I1)/n_I1,1),
            c(as.vector(table(NI1))[c(3,4,1,2)],NA_NI1),
            round(100*c(as.vector(table(NI1))[c(3,4,1,2)],NA_NI1)/n_NI1,1),
            c(as.vector(table(I2))[c(3,4,1,2)],NA_I2),
            round(100*c(as.vector(table(I2))[c(3,4,1,2)],NA_I2)/n_I2,1),
            c(as.vector(table(NI2))[c(3,4,1,2)],NA_NI2),
            round(100*c(as.vector(table(NI2))[c(3,4,1,2)],NA_NI2)/n_NI2,1)
            )
colnames(EEExt)=ColumnesExt
rownames(EEExt)=c("Eutócico", "Instrumental", "Cesárea programada", "Cesárea urgente", "Pérdidas")

EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")
```


```{r 413,fig.cap="\\s"}
Tipo= c(I1,I2,NI1,NI2)
Tipo[Tipo=="Eutocico"]="Eutócico"
Tipo=ordered(Tipo, levels=c("Eutócico", "Instrumental", "Cesárea programada", "Cesárea urgente"))
dtbp=data.frame(Grupo=c(rep("Inf.",length(I1)+length(I2)),rep("No inf.",length(NI1)+length(NI2))),
Ola= c(rep("1a ola",length(I1)),rep("2a ola",length(I2)),rep("1a ola",length(NI1)),rep("2a ola",length(NI2))),  
Tipo
 )

ggplot(data=na.omit(dtbp))+
   geom_mosaic(aes(x=product(Tipo,Ola), fill=Grupo)) +
  theme_mosaic()+
  ylab("Tipo de parto")+
  xlab("")+
  scale_fill_discrete(name ="", labels=c("Infectadas", "No infectadas"))+
  scale_x_productlist(labels=c("Infectadas\n 1a ola",  "No infectadas\n 1a ola", "Infectadas\n 2a ola", "No infectadas\n 2a ola"))
```

```{r}
SRH=scheirerRayHare(Tipo ~ Grupo + Ola,data=dtbp)$p.value[3]
```

* Test de interacción de Scheirer-Ray-Hare: p-valor, `r round(SRH,3)`. 



#### Cesáreas urgentes


```{r}
I1C=I1
I1C[I1C=="Cesárea urgente"]=1
I1C[I1C!=1]=0
#table(I1C)

I2C=I2
I2C[I2C=="Cesárea urgente"]=1
I2C[I2C!=1]=0
#table(I2C)

NI1C=NI1
NI1C[NI1C=="Cesárea urgente"]=1
NI1C[NI1C!=1]=0
#table(NI1C)

NI2C=NI2
NI2C[NI2C=="Cesárea urgente"]=1
NI2C[NI2C!=1]=0
#table(NI2C)



```

```{r 414,fig.cap="\\s"}
GrComparOlasCC(I1C,NI1C,I2C,NI2C,"Cesáreas urgentes")
```

```{r}
EE=cbind(as.vector(table(I1C))[2:1],
         as.vector(table(NI1C))[2:1],
         as.vector(table(I2C))[2:1],
         as.vector(table(NI2C))[2:1])


Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```

* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]


* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"		[`r round(RR.RR(EE)[3:4],3)`]

#### Instrumentales



```{r}
I1C=I1
I1C[I1C=="Instrumental"]=1
I1C[I1C!=1]=0
#table(I1C)

I2C=I2
I2C[I2C=="Instrumental"]=1
I2C[I2C!=1]=0
#table(I2C)

NI1C=NI1
NI1C[NI1C=="Instrumental"]=1
NI1C[NI1C!=1]=0
#table(NI1C)

NI2C=NI2
NI2C[NI2C=="Instrumental"]=1
NI2C[NI2C!=1]=0
#table(NI2C)
```


```{r 415,fig.cap="\\s"}
GrComparOlasCC(I1C,NI1C,I2C,NI2C,"Partos instrumentales")
```

```{r}
EE=cbind(as.vector(table(I1C))[2:1],
         as.vector(table(NI1C))[2:1],
         as.vector(table(I2C))[2:1],
         as.vector(table(NI2C))[2:1])

Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```

* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]


* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"		[`r round(RR.RR(EE)[3:4],3)`]



#### Eutócicos


```{r}
I1C=I1
I1C[I1C=="Eutocico"]=1
I1C[I1C!=1]=0
#table(I1C)

I2C=I2
I2C[I2C=="Eutocico"]=1
I2C[I2C!=1]=0
#table(I2C)

NI1C=NI1
NI1C[NI1C=="Eutocico"]=1
NI1C[NI1C!=1]=0
#table(NI1C)

NI2C=NI2
NI2C[NI2C=="Eutocico"]=1
NI2C[NI2C!=1]=0
#table(NI2C)



```

```{r 416,fig.cap="\\s"}
GrComparOlasCC(I1C,NI1C,I2C,NI2C,"Partos eutócicos")

```

```{r}
EE=cbind(as.vector(table(I1C))[2:1],
         as.vector(table(NI1C))[2:1],
         as.vector(table(I2C))[2:1],
         as.vector(table(NI2C))[2:1])


Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```


* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]


* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"		[`r round(RR.RR(EE)[3:4],3)`]


### Retraso del crecimiento


```{r 417,fig.cap="\\s"}
I1=factor(Casos1w$Defecto.del.crecimiento.fetal..en.tercer.trimestre._.CIR._.,labels=0:1)
I2=factor(Casos2w$Defecto.del.crecimiento.fetal..en.tercer.trimestre._.CIR._.,labels=0:1)
NI1=factor(Controls1w$Defecto.del.crecimiento.fetal..en.tercer.trimestre._.CIR._.)
NI2=factor(Controls2w$Defecto.del.crecimiento.fetal..en.tercer.trimestre._.CIR._.)

ComparOlasCC(I1,I2,NI1,NI2,"RCIU", "No RCIU")
GrComparOlasCC(I1,I2,NI1,NI2,"RCIU")
```





```{r}
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```

* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]

* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"		[`r round(RR.RR(EE)[3:4],3)`]


### Hemorragia postparto


```{r 477,fig.cap="\\s"}
I1=Casos1w$Hemorragia.postparto
I1.sino=I1
I1.sino[!is.na(I1.sino)& I1.sino!="No"]="Sí"
I1=ordered(I1,levels=names(table(I1))[c(4,2,3,1)])
I2=Casos2w$Hemorragia.postparto
I2.sino=I2
I2.sino[!is.na(I2.sino)& I2.sino!="No"]="Sí"
I2=ordered(I2,levels=names(table(I2))[c(4,2,3,1)])


NI1=Controls1w$Hemorragia.postparto
NI1.sino=NI1
NI1.sino[!is.na(NI1.sino)& NI1.sino!="No"]="Sí"
NI1=ordered(NI1,levels=names(table(NI1))[c(4,2,3,1)])
NI2=Controls2w$Hemorragia.postparto
NI2.sino=NI2
NI2.sino[!is.na(NI2.sino)& NI2.sino!="No"]="Sí"
NI2=ordered(NI2,levels=names(table(NI2))[c(4,2,3,1)])

ComparOlasCC(I1,I2,NI1,NI2,"HPP", "No HPP")
GrComparOlasCC(I1,I2,NI1,NI2,"HPP")
```




```{r}
EE=cbind(as.vector(table(I1.sino))[2:1],
         as.vector(table(NI1.sino))[2:1],
         as.vector(table(I2.sino))[2:1],
         as.vector(table(NI2.sino))[2:1])
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```

* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]

* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"		[`r round(RR.RR(EE)[3:4],3)`]





```{r}
EEExt=cbind(c(as.vector(table(I1)),NA_I1),
            round(100*c(as.vector(table(I1)),NA_I1)/n_I1,1),
            c(as.vector(table(NI1)),NA_NI1),
            round(100*c(as.vector(table(NI1)),NA_NI1)/n_NI1,1),
            c(as.vector(table(I2)),NA_I2),
            round(100*c(as.vector(table(I2)),NA_I2)/n_I2,1),
            c(as.vector(table(NI2)),NA_NI2),
            round(100*c(as.vector(table(NI2)),NA_NI2)/n_NI2,1)
            )
colnames(EEExt)=ColumnesExt
rownames(EEExt)=c("No HPP", "HPP Tto médico", "HPP Tto Qx conservador", "Histerectomía", "Pérdidas")

EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")
```


```{r 473,fig.cap="\\s"}
Tipo= c(I1,I2,NI1,NI2)
dtbp=data.frame(Grupo=c(rep("Inf.",length(I1)+length(I2)),rep("No inf.",length(NI1)+length(NI2))),
Ola= c(rep("1a ola",length(I1)),rep("2a ola",length(I2)),rep("1a ola",length(NI1)),rep("2a ola",length(NI2))),  
Tipo
 )

ggplot(data=na.omit(dtbp))+
   geom_mosaic(aes(x=product(Tipo,Ola), fill=Grupo)) +
  theme_mosaic()+
  ylab("Tipo de HPP")+
  xlab("")+
  scale_fill_discrete(name ="", labels=c("Infectadas", "No infectadas"))+
  scale_x_productlist(labels=c("Infectadas\n 1a ola",  "No infectadas\n 1a ola", "Infectadas\n 2a ola", "No infectadas\n 2a ola"))
```

```{r}
SRH=scheirerRayHare(Tipo ~ Grupo + Ola,data=dtbp)$p.value[3]
```

* Test de interacción de Scheirer-Ray-Hare: p-valor, `r round(SRH,3)`. 




### Ingreso materno en UCI


```{r}
I1=Casos1w$UCI
I2=Casos2w$UCI

NI1=factor(Controls1w$UCI...9)
NI2=factor(Controls2w$UCI...9,levels=0:1)

ComparOlasCC(I1,I2,NI1,NI2,"UCI", "No UCI")
GrComparOlasCC(I1,I2,NI1,NI2,"UCI")
```


```{r 418,fig.cap="\\s"}
EEExt=cbind(c(as.vector(table(I1))[2:1],NA_I1),
            round(100*c(as.vector(table(I1))[2:1],NA_I1)/n_I1,1),
            c(as.vector(table(NI1))[2:1],NA_NI1),
            round(100*c(as.vector(table(NI1))[2:1],NA_NI1)/n_NI1,1),
            c(as.vector(table(I2))[2:1],NA_I2),
            round(100*c(as.vector(table(I2))[2:1],NA_I2)/n_I2,1),
            c(as.vector(table(NI2))[2:1],NA_NI2),
            round(100*c(as.vector(table(NI2))[2:1],NA_NI2)/n_NI2,1)
            )
colnames(EEExt)=ColumnesExt
rownames(EEExt)=c("UCI", "No UCI","Pérdidas")
EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")
```


```{r,eval=FALSE}
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")
```



* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]

* RR: No tiene sentido




### Rotura prematura de membranas


```{r 421,fig.cap="\\s"}
I1=Casos1w$Bolsa.rota.anteparto
I2=Casos2w$Bolsa.rota.anteparto

NI1=Controls1w$Bolsa.rota.anteparto
NI2=Controls2w$Bolsa.rota.anteparto

ComparOlasCC(I1,I2,NI1,NI2,"RPM", "No RPM")
GrComparOlasCC(I1,I2,NI1,NI2,"RPM")
```



```{r}
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```

* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]

* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"		[`r round(RR.RR(EE)[3:4],3)`]





### Ingreso neonatal en UCIN 

```{r}
I1=c(Casos1w[Casos1w$Feto.muerto.intraútero=="No",]$Ingreso.en.UCIN,Casos1wGM[Casos1wGM$Feto.vivo=="Sí",]$Ingreso.en.UCI)
I2=c(Casos2w[Casos2w$Feto.muerto.intraútero=="No",]$Ingreso.en.UCIN,Casos2wGM[Casos2wGM$Feto.vivo=="Sí",]$Ingreso.en.UCI)
NI1=c(Controls1w[Controls1w$Feto.vivo...194=="Sí",]$Ingreso.en.UCI...213,Controls1wGM[Controls1wGM$Feto.vivo...245=="Sí",]$Ingreso.en.UCI...260)
NI2=c(Controls2w[Controls2w$Feto.vivo...194=="Sí",]$Ingreso.en.UCI...213,Controls2wGM[Controls2wGM$Feto.vivo...245=="Sí",]$Ingreso.en.UCI...260)

NA_I1=length(I1[is.na(I1)])
NA_NI1=length(NI1[is.na(NI1)])
NA_I2=length(I2[is.na(I2)])
NA_NI2=length(NI2[is.na(NI2)])
```


```{r}
EEExt=cbind(c(as.vector(table(I1))[2:1],NA_I1),
            round(100*c(as.vector(table(I1))[2:1],NA_I1)/length(I1),1),
            c(as.vector(table(NI1))[2:1],NA_NI1),
            round(100*c(as.vector(table(NI1))[2:1],NA_NI1)/length(NI1),1),
            c(as.vector(table(I2))[2:1],NA_I2),
            round(100*c(as.vector(table(I2))[2:1],NA_I2)/length(I2),1),
            c(as.vector(table(NI2))[2:1],NA_NI2),
            round(100*c(as.vector(table(NI2))[2:1],NA_NI2)/length(NI2),1)
            )
colnames(EEExt)=ColumnesExt
rownames(EEExt)=c("UCIN", "No UCIN","Pérdidas")
EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")
```


```{r 419,fig.cap="\\s"}
df =data.frame(
  Factor=c(rep("Infectadas 1a ola",length(I1)), rep("No infectadas 1a ola",length(NI1)),rep("Infectadas 2a ola",length(I2)), rep("No infectadas 2a ola",length(NI2))),
  Grupo=c(I1,NI1,I2,NI2 )
)

Grupo=ordered(rep(c("Infectadas","No infectadas"), 2),levels=c("Infectadas","No infectadas"))
Ola=ordered(rep(base , each=2),levels=base)
valor=as.vector(100*prop.table(table(df)[c(1,3,2,4),2:1], margin=1))[1:4]
data=data.frame(Grupo,Ola,valor)


data %>%
ggplot(aes(fill=Grupo, y=valor, x=Ola)) + 
  geom_bar(position="dodge", stat="identity")+
xlab("")+
  ylab("UCI neonatal (%)")+
scale_fill_hue(c=100)+labs(fill="")
```



```{r}
EE=cbind(as.vector(table(I1))[2:1],
         as.vector(table(NI1))[2:1],
         as.vector(table(I2))[2:1],
         as.vector(table(NI2))[2:1])
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```

* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]

* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"		[`r round(RR.RR(EE)[3:4],3)`]


### Apgar


```{r}
I1=c(Casos1w$APGAR.5...126,Casos1wGM$APGAR.5...150)
I2=c(Casos2w$APGAR.5...126,Casos2wGM$APGAR.5...150)
I2[I2==19]=NA
NI1=c(Controls1w$APGAR.5...200,Controls1wGM$APGAR.5...249)
NI2=c(Controls2w$APGAR.5...200,Controls2wGM$APGAR.5...249)

I1=cut(I1,breaks=c(-1,7,20),labels=c("0-7","8-10"))
I2=cut(I2,breaks=c(-1,7,20),labels=c("0-7","8-10"))
NI1=cut(NI1,breaks=c(-1,7,20),labels=c("0-7","8-10"))
NI2=cut(NI2,breaks=c(-1,7,20),labels=c("0-7","8-10"))
NA_I1=length(I1[is.na(I1)])
NA_NI1=length(NI1[is.na(NI1)])
NA_I2=length(I2[is.na(I2)])
NA_NI2=length(NI2[is.na(NI2)])
```


```{r}
EEExt=cbind(c(as.vector(table(I1)),NA_I1),
            round(100*c(as.vector(table(I1)),NA_I1)/length(I1),1),
            c(as.vector(table(NI1)),NA_NI1),
            round(100*c(as.vector(table(NI1)),NA_NI1)/length(NI1),1),
            c(as.vector(table(I2)),NA_I2),
            round(100*c(as.vector(table(I2)),NA_I2)/length(I2),1),
            c(as.vector(table(NI2)),NA_NI2),
            round(100*c(as.vector(table(NI2)),NA_NI2)/length(NI2),1)
            )
colnames(EEExt)=ColumnesExt
rownames(EEExt)=c("Apgar.5≤7", "Apgar.5≥8","Pérdidas")
EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")
```


```{r 420,fig.cap="\\s"}
df =data.frame(
  Factor=c(rep("Infectadas 1a ola",length(I1)), rep("No infectadas 1a ola",length(NI1)),rep("Infectadas 2a ola",length(I2)), rep("No infectadas 2a ola",length(NI2))),
  Grupo=c(I1,NI1,I2,NI2 )
)

Grupo=ordered(rep(c("Infectadas","No infectadas"), 2),levels=c("Infectadas","No infectadas"))
Ola=ordered(rep(base , each=2),levels=base)
valor=as.vector(100*prop.table(table(df)[c(1,3,2,4),], margin=1))[1:4]
data=data.frame(Grupo,Ola,valor)


data %>%
ggplot(aes(fill=Grupo, y=valor, x=Ola)) + 
  geom_bar(position="dodge", stat="identity")+
xlab("")+
  ylab("UCI materna (%)")+
scale_fill_hue(c=100)+labs(fill="")
```


```{r}
EE=cbind(as.vector(table(I1)),
         as.vector(table(NI1)),
         as.vector(table(I2)),
         as.vector(table(NI2)))
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```

* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]

* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"		[`r round(RR.RR(EE)[3:4],3)`]





### Edad gestacional al parto

```{r}
I1=Casos1w$EG_TOTAL_PARTO
I2=Casos2w$EG_TOTAL_PARTO
NI1=Controls1w$EDAD_GEST 
NI2=Controls2w$EDAD_GEST 
```


```{r}
Dades=rbind(c(round(min(I1,na.rm=TRUE),1),round(max(I1,na.rm=TRUE),1), round(mean(I1,na.rm=TRUE),1),round(median(I1,na.rm=TRUE),1),round(quantile(I1,c(0.25,0.75),na.rm=TRUE),1), round(sd(I1,na.rm=TRUE),1)),
            c(round(min(NI1,na.rm=TRUE),1),round(max(NI1,na.rm=TRUE),1), round(mean(NI1,na.rm=TRUE),1),round(median(NI1,na.rm=TRUE),1),round(quantile(NI1,c(0.25,0.75),na.rm=TRUE),1),round(sd(NI1,na.rm=TRUE),1)),
            c(round(min(I2,na.rm=TRUE),1),round(max(I2,na.rm=TRUE),1), round(mean(I2,na.rm=TRUE),1),round(median(I2,na.rm=TRUE),1),round(quantile(I2,c(0.25,0.75),na.rm=TRUE),1), round(sd(I2,na.rm=TRUE),1)),
            c(round(min(NI2,na.rm=TRUE),1),round(max(NI2,na.rm=TRUE),1), round(mean(NI2,na.rm=TRUE),1),round(median(NI2,na.rm=TRUE),1),round(quantile(NI2,c(0.25,0.75),na.rm=TRUE),1),round(sd(NI2,na.rm=TRUE),1)))

colnames(Dades)=c("Edad gest. mínima","Edad gest. máxima","Edad gest. media", "Edad gest. mediana", "1er cuartil", "3er cuartil", "Desv. típica")
rownames(Dades)=c("Infectadas 1a ola", "No infectadas 1a ola","Infectadas 2a ola", "No infectadas 2a ola")

Dades %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")


```



```{r 422,fig.cap="\\s"}
data =data.frame(
  name=ordered(c( rep("Infectadas 1a ola",length(I1)), rep("No infectadas 1a ola",length(NI1)),rep("Infectadas 2a ola",length(I2)), rep("No infectadas 2a ola",length(NI2))),levels=c("Infectadas 1a ola","No infectadas 1a ola","Infectadas 2a ola","No infectadas 2a ola")),
  Edades=c( I1,NI1,I2,NI2 ),
  Color=c( rep("Infectadas",length(I1)), rep("No infectadas",length(NI1)),rep("Infectadas",length(I2)), rep("No infectadas",length(NI2)))
)


data %>%
  ggplot( aes(x=name, y=Edades, fill=name)) +
    geom_violin(width=1) +
    geom_boxplot(width=0.1, color="black", alpha=0.2,outlier.fill="black",
               outlier.size=1) +
    theme(
      legend.position="none",
      plot.title=element_text(size=11)
    ) +
    xlab("")+
  ylab("Edades gestacionales (semanas)")+
  scale_fill_manual(values=c("#F8766D" ,"#00BFC4" ,"#F8766D", "#00BFC4"))

```


* Ninguno de los cuatro grupos de edades gestacionales se ajusta a distribución normal: test de Shapiro-Wilkis, p-valor máximo $`r signif(max(shapiro.test(I1)$p.value,shapiro.test(I2)$p.value,shapiro.test(NI1)$p.value,shapiro.test(NI2)$p.value),1)`$


```{r}
Tipo= c(I1,I2,NI1,NI2)
dtbp=data.frame(Grupo=c(rep("Inf.",length(I1)+length(I2)),rep("No inf.",length(NI1)+length(NI2))),
Ola= c(rep("1a ola",length(I1)),rep("2a ola",length(I2)),rep("1a ola",length(NI1)),rep("2a ola",length(NI2))),  
Tipo
 )
SRH=scheirerRayHare(Tipo ~ Grupo + Ola,
                data=dtbp,verbose=FALSE)$p.value[3]

```



* Test de interacción de Scheirer-Ray-Hare: p-valor `r round(SRH,3)`: no hay evidencia de que la diferencia de edades medias gestacionales de infectadas y no infectadas sea diferente según la ola.





### Peso de neonatos al nacimiento


```{r}
I1=c(Casos1w[Casos1w$Feto.muerto.intraútero=="No",]$Peso._gramos_...125,Casos1wGM[Casos1wGM$Feto.vivo=="Sí",]$Peso._gramos_...148)
NI1=c(Controls1w[Controls1w$Feto.vivo...194=="Sí",]$Peso._gramos_...198,Controls1wGM[Controls1wGM$Feto.vivo...245=="Sí",]$Peso._gramos_...247)
I2=c(Casos2w[Casos2w$Feto.muerto.intraútero=="No",]$Peso._gramos_...125,Casos2wGM[Casos2wGM$Feto.vivo=="Sí",]$Peso._gramos_...148)
NI2=c(Controls2w[Controls2w$Feto.vivo...194=="Sí",]$Peso._gramos_...198,Controls2wGM[Controls2wGM$Feto.vivo...245=="Sí",]$Peso._gramos_...247)
```


```{r}
Dades=rbind(c(round(min(I1,na.rm=TRUE),1),round(max(I1,na.rm=TRUE),1), round(mean(I1,na.rm=TRUE),1),round(median(I1,na.rm=TRUE),1),round(quantile(I1,c(0.25,0.75),na.rm=TRUE),1), round(sd(I1,na.rm=TRUE),1)),
            c(round(min(NI1,na.rm=TRUE),1),round(max(NI1,na.rm=TRUE),1), round(mean(NI1,na.rm=TRUE),1),round(median(NI1,na.rm=TRUE),1),round(quantile(NI1,c(0.25,0.75),na.rm=TRUE),1),round(sd(NI1,na.rm=TRUE),1)),
            c(round(min(I2,na.rm=TRUE),1),round(max(I2,na.rm=TRUE),1), round(mean(I2,na.rm=TRUE),1),round(median(I2,na.rm=TRUE),1),round(quantile(I2,c(0.25,0.75),na.rm=TRUE),1), round(sd(I2,na.rm=TRUE),1)),
            c(round(min(NI2,na.rm=TRUE),1),round(max(NI2,na.rm=TRUE),1), round(mean(NI2,na.rm=TRUE),1),round(median(NI2,na.rm=TRUE),1),round(quantile(NI2,c(0.25,0.75),na.rm=TRUE),1),round(sd(NI2,na.rm=TRUE),1)))

colnames(Dades)=c("Peso mínimo","Peso máximo","Peso  medio", "Peso  mediano", "1er cuartil", "3er cuartil", "Desv. típica")
rownames(Dades)=c("Infectadas 1a ola", "No infectadas 1a ola","Infectadas 2a ola", "No infectadas 2a ola")

Dades %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")


```



```{r 423,fig.cap="\\s"}
data =data.frame(
  name=ordered(c( rep("Infectadas 1a ola",length(I1)), rep("No infectadas 1a ola",length(NI1)),rep("Infectadas 2a ola",length(I2)), rep("No infectadas 2a ola",length(NI2))),levels=c("Infectadas 1a ola","No infectadas 1a ola","Infectadas 2a ola","No infectadas 2a ola")),
  Edades=c( I1,NI1,I2,NI2 ),
  Color=c( rep("Infectadas",length(I1)), rep("No infectadas",length(NI1)),rep("Infectadas",length(I2)), rep("No infectadas",length(NI2)))
)


data %>%
  ggplot( aes(x=name, y=Edades, fill=name)) +
    geom_violin(width=1) +
    geom_boxplot(width=0.1, color="black", alpha=0.2,outlier.fill="black",
               outlier.size=1) +
    theme(
      legend.position="none",
      plot.title=element_text(size=11)
    ) +
    xlab("")+
  ylab("Pesos (gramos)")+
  scale_fill_manual(values=c("#F8766D" ,"#00BFC4" ,"#F8766D", "#00BFC4"))

```


* Ninguno de los cuatro grupos de edades gestacionales se ajusta a distribución normal: test de Shapiro-Wilkis, p-valor máximo $`r signif(max(shapiro.test(I1)$p.value,shapiro.test(I2)$p.value,shapiro.test(NI1)$p.value,shapiro.test(NI2)$p.value),1)`$


```{r}
Tipo= c(I1,I2,NI1,NI2)
dtbp=data.frame(Grupo=c(rep("Inf.",length(I1)+length(I2)),rep("No inf.",length(NI1)+length(NI2))),
Ola= c(rep("1a ola",length(I1)),rep("2a ola",length(I2)),rep("1a ola",length(NI1)),rep("2a ola",length(NI2))),  
Tipo
 )
SRH=scheirerRayHare(Tipo ~ Grupo + Ola,
                data=dtbp,verbose=FALSE)$p.value[3]

```



* Test de interacción de Scheirer-Ray-Hare: p-valor `r round(SRH,3)`: no hay evidencia de que la diferencia de pesos medios de hijos de infectadas y no infectadas sea diferente según la ola.





```{r}
I1w=cut(I1,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)
NI1w=cut(NI1,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)
I2w=cut(I2,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)
NI2w=cut(NI2,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)

NA_I1w=length(I1w[is.na(I1w)])
NA_NI1w=length(NI1w[is.na(NI1w)])
NA_I2w=length(I2w[is.na(I2w)])
NA_NI2w=length(NI2w[is.na(NI2w)])

EEExt=cbind(c(as.vector(table(I1w)),NA_I1w),
            round(100*c(as.vector(table(I1w)),NA_I1w)/length(I1),1),
            c(as.vector(table(NI1w)),NA_NI1w),
            round(100*c(as.vector(table(NI1w)),NA_NI1w)/length(NI1),1),
            c(as.vector(table(I2w)),NA_I2w),
            round(100*c(as.vector(table(I2w)),NA_I2w)/length(I2),1),
            c(as.vector(table(NI2w)),NA_NI2w),
            round(100*c(as.vector(table(NI2w)),NA_NI2w)/length(NI2),1)
            )
colnames(EEExt)=ColumnesExt
rownames(EEExt)=c("Bajo peso", "No bajo peso","Pérdidas")
EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")
```

```{r}
df =data.frame(
  Factor=c(rep("Infectadas 1a ola",length(I1w)), rep("No infectadas 1a ola",length(NI1w)),rep("Infectadas 2a ola",length(I2w)), rep("No infectadas 2a ola",length(NI2w))),
  Grupo=c(I1w,NI1w,I2w,NI2w )
)

Grupo=ordered(rep(c("Infectadas","No infectadas"), 2),levels=c("Infectadas","No infectadas"))
Ola=ordered(rep(base , each=2),levels=base)
valor=as.vector(100*prop.table(table(df)[c(1,3,2,4),2:1], margin=1))[1:4]
data=data.frame(Grupo,Ola,valor)


data %>%
ggplot(aes(fill=Grupo, y=valor, x=Ola)) + 
  geom_bar(position="dodge", stat="identity")+
xlab("")+
  ylab("RPM (%)")+
scale_fill_hue(c=100)+labs(fill="")
```


```{r}
EE=cbind(as.vector(table(I1w)),
         as.vector(table(NI1w)),
         as.vector(table(I2w)),
         as.vector(table(NI2w)))
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```

* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]

* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"		[`r round(RR.RR(EE)[3:4],3)`]






### Fetos muertos anteparto 

```{r}
I1w1=Casos1w$Feto.muerto.intraútero
I1w1[I1w1=="Sí"]="Muerto"
I1w1[I1w1=="No"]="Vivo"
I1w2=Casos1wGM$Feto.vivo
I1w2[I1w2=="Sí"]="Vivo"
I1w2[I1w2=="No"]="Muerto"
I1w=c(I1w1,I1w2)
n_I1wFT=length(I1w)
n_VI1w=as.vector(table(I1w))[2]

NI1w1=Controls1w$Feto.vivo...194
NI1w2=Controls1wGM$Feto.vivo...245
NI1w=c(NI1w1,NI1w2)
NI1w[NI1w=="Sí"]="Vivo"
NI1w[NI1w=="No"]="Muerto"
NI1w=factor(NI1w,levels=c("Muerto","Vivo"))
n_NI1wFT=length(NI1w)
n_VNI1w=as.vector(table(NI1w))[2]
#
#
I2w1=Casos2w$Feto.muerto.intraútero
I2w1[I2w1=="Sí"]="Muerto"
I2w1[I2w1=="No"]="Vivo"
I2w2=Casos2wGM$Feto.vivo
I2w2[I2w2=="Sí"]="Vivo"
I2w2[I2w2=="No"]="Muerto"
I2w=c(I2w1,I2w2)
n_I2wFT=length(I2w)
n_VI2w=as.vector(table(I2w))[2]

NI2w1=Controls2w$Feto.vivo...194
NI2w2=Controls2wGM$Feto.vivo...245
NI2w=c(NI2w1,NI2w2)
NI2w[NI2w=="Sí"]="Vivo"
NI2w[NI2w=="No"]="Muerto"
NI2w=factor(NI2w,levels=c("Muerto","Vivo"))
n_NI2wFT=length(NI2w)
n_VNI2w=as.vector(table(NI2w))[2]
```



```{r}
NA_I1w=length(I1w[is.na(I1w)])
NA_NI1w=length(NI1w[is.na(NI1w)])
NA_I2w=length(I2w[is.na(I2w)])
NA_NI2w=length(NI2w[is.na(NI2w)])
```


```{r}
EEExt=cbind(c(as.vector(table(I1w)),NA_I1w),
            round(100*c(as.vector(table(I1w)),NA_I1w)/n_I1wFT,1),
            c(as.vector(table(NI1w)),NA_NI1w),
            round(100*c(as.vector(table(NI1w)),NA_NI1w)/n_NI1wFT,1),
            c(as.vector(table(I2w)),NA_I2w),
            round(100*c(as.vector(table(I2w)),NA_I2w)/n_I2wFT,1),
            c(as.vector(table(NI2w)),NA_NI2w),
            round(100*c(as.vector(table(NI2w)),NA_NI2w)/n_NI2wFT,1)
            )
colnames(EEExt)=ColumnesExt
rownames(EEExt)=c("Feto muerto anteparto", "Feto vivo","Pérdidas")
EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")
```


```{r 491,fig.cap="\\s"}
df =data.frame(
  Factor=c(rep("Infectadas 1a ola",length(I1w)), rep("No infectadas 1a ola",length(NI1w)),rep("Infectadas 2a ola",length(I2w)), rep("No infectadas 2a ola",length(NI2w))),
  Grupo=c(I1w,NI1w,I2w,NI2w )
)

Grupo=ordered(rep(c("Infectadas","No infectadas"), 2),levels=c("Infectadas","No infectadas"))
Ola=ordered(rep(base , each=2),levels=base)
valor=as.vector(100*prop.table(table(df)[c(1,3,2,4),2:1], margin=1))[1:4]
data=data.frame(Grupo,Ola,valor)


data %>%
ggplot(aes(fill=Grupo, y=valor, x=Ola)) + 
  geom_bar(position="dodge", stat="identity")+
xlab("")+
  ylab("RPM (%)")+
scale_fill_hue(c=100)+labs(fill="")
```


```{r}
EE=cbind(as.vector(table(I1w)),
         as.vector(table(NI1w)),
         as.vector(table(I2w)),
         as.vector(table(NI2w)))
Riesgos(EE) %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")

```

* RA: p-valor `r round(RA.RA(EE)[1],3)`, IC-95% para la diferencia "RA-en-la-1a-ola" menos  "RA-en-la-2a-ola"	[`r round(RA.RA(EE)[2:3],4)`]

* RR: p-valor `r round(RR.RR(EE)[2],3)`, IC-95% para el cociente "RR-en-la-1a-ola" dividido por  "RR-en-la-2a-ola"		[`r round(RR.RR(EE)[3:4],3)`]





## Comparación global: Hubo diferencias en el global entre la 1a ola y la 2a ola?



### Hábito tabáquico




```{r}
I1=Casos1w$FUMADORA_CAT
I2=Casos2w$FUMADORA_CAT
NI1=Controls1w$Fumadora_cat
NI2=Controls2w$Fumadora_cat
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)

ComparOlasGl(Tot1w,Tot2w,"Fumadora", "No fumadora")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot)$p.value,fisher.test(EEI)$p.value,fisher.test(EENI)$p.value)
```

* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

### Obesidad 




```{r}
I1=Casos1w$Obesidad
I2=Casos2w$Obesidad
NI1=Controls1w$Obesidad
NI2=Controls2w$Obesidad
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
Tot1w[Tot1w=="No"]=0
Tot1w[Tot1w=="Sí"]=1
Tot2w[Tot2w=="No"]=0
Tot2w[Tot2w=="Sí"]=1
ComparOlasGl(Tot1w,Tot2w,"Fumadora", "No fumadora")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot,workspace=2e8)$p.value,fisher.test(EEI,workspace=2e8)$p.value,fisher.test(EENI,workspace=2e8)$p.value)
```

* p-valor del test de  Fisher global $`r signif(FT[1],1)`$

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

### Hipertensión pregestacional




```{r}
I1=Casos1w$Hipertensión.pregestacional
I2=Casos2w$Hipertensión.pregestacional
NI1=Controls1w$Hipertensión.pregestacional
NI2=Controls2w$Hipertensión.pregestacional
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
Tot1w[Tot1w=="No"]=0
Tot1w[Tot1w=="Sí"]=1
Tot2w[Tot2w=="No"]=0
Tot2w[Tot2w=="Sí"]=1
ComparOlasGl(Tot1w,Tot2w,"HTA", "No HTA")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot)$p.value,fisher.test(EEI)$p.value,fisher.test(EENI)$p.value)
```

* p-valor del test de  Fisher global $`r signif(FT[1],1)`$

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

### Diabetes Mellitus 




```{r}
I1=Casos1w$DIABETES
I2=Casos2w$DIABETES
NI1=Controls1w$Diabetes
NI2=Controls2w$Diabetes
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
Tot1w[Tot1w=="No"]=0
Tot1w[Tot1w=="Sí"]=1
Tot2w[Tot2w=="No"]=0
Tot2w[Tot2w=="Sí"]=1
ComparOlasGl(Tot1w,Tot2w,"DM", "No DM")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot)$p.value,fisher.test(EEI)$p.value,fisher.test(EENI)$p.value)
```

* p-valor del test de  Fisher global $`r signif(FT[1],1)`$

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

### Enfermedades cardiacas crónicas 




```{r}
I1=Casos1w$Enfermedad.cardiaca.crónica
I2=Casos2w$Enfermedad.cardiaca.crónica
NI1=Controls1w$ENF.CARDIACA.TODO
NI2=Controls2w$ENF.CARDIACA.TODO
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
Tot1w[Tot1w=="No"]=0
Tot1w[Tot1w=="Sí"]=1
Tot2w[Tot2w=="No"]=0
Tot2w[Tot2w=="Sí"]=1

ComparOlasGl(Tot1w,Tot2w,"ECC", "No ECC")
```

```{r}

EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot)$p.value,fisher.test(EEI)$p.value,fisher.test(EENI)$p.value)
```

* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

### Enfermedades pulmonares crónicas (incluyendo asma)




```{r}
INA1w=Casos1w$Enfermedad.pulmonar.crónica.no.asma
NINA1w=Controls1w$Enfermedad.pulmonar.crónica.no.asma
NINA1w[NINA1w==0]="No"
NINA1w[NINA1w==1]="Sí"
IA1w=Casos1w$Diagnóstico.clínico.de.Asma
NIA1w=Controls1w$Diagnóstico.clínico.de.Asma
NIA1w[NIA1w==0]="No"
NIA1w[NIA1w==1]="Sí"


I1=rep(NA,n_I1)
for (i in 1:n_I1){I1[i]=max(INA1w[i],IA1w[i],na.rm=TRUE)}
NI1=rep(NA,n_NI1)
for (i in 1:n_NI1){NI1[i]=max(NINA1w[i],NIA1w[i],na.rm=TRUE)}
NI1[NI1==-Inf]=NA


INA2w=Casos2w$Enfermedad.pulmonar.crónica.no.asma
NINA2w=Controls2w$Enfermedad.pulmonar.crónica.no.asma
NINA2w[NINA2w==0]="No"
NINA2w[NINA2w==1]="Sí"
IA2w=Casos2w$Diagnóstico.clínico.de.Asma
NIA2w=Controls2w$Diagnóstico.clínico.de.Asma
NIA2w[NIA2w==0]="No"
NIA2w[NIA2w==1]="Sí"

I2=rep(NA,n_I2)
for (i in 1:n_I2){I2[i]=max(INA2w[i],IA2w[i],na.rm=TRUE)}
NI2=rep(NA,n_NI2)
for (i in 1:n_NI2){NI2[i]=max(NINA2w[i],NIA2w[i],na.rm=TRUE)}
NI2[NI2==-Inf]=NA

Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
ComparOlasGl(Tot1w,Tot2w,"EPC", "No EPC")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot)$p.value,fisher.test(EEI)$p.value,fisher.test(EENI)$p.value)
```

* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

### Paridad




```{r}
I1=Casos1w$NULIPARA
I2=Casos2w$NULIPARA
NI1=Controls1w$Nuliparous
NI2=Controls2w$Nuliparous
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
ComparOlasGl(Tot1w,Tot2w,"Nulipara", "Multipara")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot)$p.value,fisher.test(EEI)$p.value,fisher.test(EENI)$p.value)
```

* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

### Gestación múltiple




```{r}
I1=Casos1w$Gestación.Múltiple
I2=Casos2w$Gestación.Múltiple
NI1=Controls1w$Gestación.Múltiple
NI2=Controls2w$Gestación.Múltiple
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
Tot1w[Tot1w=="No"]=0
Tot1w[Tot1w=="Sí"]=1
Tot2w[Tot2w=="No"]=0
Tot2w[Tot2w=="Sí"]=1

ComparOlasGl(Tot1w,Tot2w,"Gestación múltiple", "Gestación única")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot)$p.value,fisher.test(EEI)$p.value,fisher.test(EENI)$p.value)
```

* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`



### Diabetes gestacional 




```{r}
I1=Casos1w$Diabetes.gestacional
I2=Casos2w$Diabetes.gestacional
NI1=Controls1w$Diabetes.gestacional
NI2=Controls2w$Diabetes.gestacional
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
Tot1w[Tot1w=="No"]=0
Tot1w[Tot1w=="Sí"]=1
Tot2w[Tot2w=="No"]=0
Tot2w[Tot2w=="Sí"]=1
ComparOlasGl(Tot1w,Tot2w,"DG", "DG")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot)$p.value,fisher.test(EEI)$p.value,fisher.test(EENI)$p.value)
```

* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

### Hipertensión gestacional 




```{r}
I1=Casos1w$Hipertensión.gestacional
I2=Casos2w$Hipertensión.gestacional
NI1=Controls1w$Hipertensión.gestacional
NI2=Controls2w$Hipertensión.gestacional
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
Tot1w[Tot1w=="No"]=0
Tot1w[Tot1w=="Sí"]=1
Tot2w[Tot2w=="No"]=0
Tot2w[Tot2w=="Sí"]=1

ComparOlasGl(Tot1w,Tot2w,"HG", "HG")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot)$p.value,fisher.test(EEI)$p.value,fisher.test(EENI)$p.value)
```

* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`


### Preeclampsia 




```{r}
I1=Casos1w$PREECLAMPSIA_ECLAMPSIA_TOTAL
I2=Casos2w$PREECLAMPSIA_ECLAMPSIA_TOTAL
NI1=Controls1w$PREECLAMPSIA
NI2=Controls2w$PREECLAMPSIA
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
ComparOlasGl(Tot1w,Tot2w,"PE", "PE")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot)$p.value,fisher.test(EEI)$p.value,fisher.test(EENI)$p.value)
```

* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

### Preeclampsia grave

```{r}
n_PI1=sum(Casos1w$PREECLAMPSIA_ECLAMPSIA_TOTAL)
n_PNI1=sum(Controls1w$PREECLAMPSIA)
n_PI2=sum(Casos2w$PREECLAMPSIA_ECLAMPSIA_TOTAL)
n_PNI2=sum(Controls2w$PREECLAMPSIA)

I1=Casos1w[Casos1w$PREECLAMPSIA_ECLAMPSIA_TOTAL==1,]$Preeclampsia.grave_HELLP_ECLAMPSIA
I2=Casos2w[Casos2w$PREECLAMPSIA_ECLAMPSIA_TOTAL==1,]$Preeclampsia.grave_HELLP_ECLAMPSIA
I1=as.numeric(factor(I1,labels=0:1))-1
I2=as.numeric(factor(I2,labels=0:1))-1

NI1.1=Controls1w[Controls1w$PREECLAMPSIA==1,]$preeclampsia_severa
NI1.2=Controls1w[Controls1w$PREECLAMPSIA==1,]$Preeclampsia.grave.No.HELLP 
NI1=rep(NA,n_PNI1)
for (i in 1:n_PNI1){NI1[i]=max(NI1.1[i],NI1.2[i],na.rm=TRUE)}
NI2.1=Controls2w[Controls2w$PREECLAMPSIA==1,]$preeclampsia_severa
NI2.2=Controls2w[Controls2w$PREECLAMPSIA==1,]$Preeclampsia.grave.No.HELLP 
NI2=rep(NA,n_PNI2)
for (i in 1:n_PNI2){NI2[i]=max(NI2.1[i],NI2.2[i],na.rm=TRUE)}
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
n_1=length(Tot1w)
n_2=length(Tot2w)
NA_1=length(Tot1w[is.na(Tot1w)])
NA_2=length(Tot2w[is.na(Tot2w)])

EEExt=cbind(c(as.vector(table(Tot1w))[2:1],NA_1),
            round(100*c(as.vector(table(Tot1w))[2:1],NA_1)/n_1,1),
            c(as.vector(table(Tot2w))[2:1],NA_2),
            round(100*c(as.vector(table(Tot2w))[2:1],NA_2)/n_2,1)
            )
colnames(EEExt)=ColumnesOnes
rownames(EEExt)=c("PE con CG", "PE sin CG","Pérdidas")
EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot)$p.value,fisher.test(EEI)$p.value,fisher.test(EENI)$p.value)
```

* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`



### Prematurez 


```{r}
I1=Casos1w$PREMATURO
I2=Casos2w$PREMATURO
NI1=Controls1w$Preterm.deliveries
NI2=Controls2w$Preterm.deliveries
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
ComparOlasGl(Tot1w,Tot2w,"Prematuro", "A término")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot)$p.value,fisher.test(EEI)$p.value,fisher.test(EENI)$p.value)
```


* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

### Eventos hemorrágicos


```{r}
I1=Casos1w$EVENTOS_HEMORRAGICOS_TOTAL
I2=Casos2w$EVENTOS_HEMORRAGICOS_TOTAL
NI1=Controls1w$eventos_hemorragicos
NI2=Controls2w$eventos_hemorragicos
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
ComparOlasGl(Tot1w,Tot2w,"Eventos hemorrágicos", "No eventos hemorrágicos")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot)$p.value,fisher.test(EEI)$p.value,fisher.test(EENI)$p.value)
```


* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`


### Eventos trombóticos


```{r}
I1=factor(Casos1w$EVENTOS_TROMBO_TOTALES,levels=0:1)
I2=factor(Casos2w$EVENTOS_TROMBO_TOTALES,levels=0:1)
NI1a=Controls1w$DVT
NI1b=Controls1w$PE
NI1=rep(NA,length(NI1a))
for (i in 1:length(NI1a)){NI1[i]=max(NI1a[i],NI1b[i],na.rm=TRUE)}
NI1=factor(NI1,levels=0:1)
NI2a=Controls2w$DVT
NI2b=Controls2w$PE
NI2=rep(NA,length(NI2a))
for (i in 1:length(NI2a)){NI2[i]=max(NI2a[i],NI2b[i],na.rm=TRUE)}
NI2=factor(NI2,levels=0:1)
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
ComparOlasGl(Tot1w,Tot2w,"Eventos trombóticos", "No eventos trombóticos")
```

```{r}

EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot)$p.value,fisher.test(EEI)$p.value,fisher.test(EENI)$p.value)
```


* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

### Hemorragias anteparto


```{r}
I1=Casos1w$Hemorragia.postparto
I1.sino=I1
I1.sino[!is.na(I1.sino)& I1.sino!="No"]="Sí"
I1=ordered(I1,levels=names(table(I1))[c(4,2,3,1)])
I2=Casos2w$Hemorragia.postparto
I2.sino=I2
I2.sino[!is.na(I2.sino)& I2.sino!="No"]="Sí"
I2=ordered(I2,levels=names(table(I2))[c(4,2,3,1)])


NI1=Controls1w$Hemorragia.postparto
NI1.sino=NI1
NI1.sino[!is.na(NI1.sino)& NI1.sino!="No"]="Sí"
NI1=ordered(NI1,levels=names(table(NI1))[c(4,2,3,1)])
NI2=Controls2w$Hemorragia.postparto
NI2.sino=NI2
NI2.sino[!is.na(NI2.sino)& NI2.sino!="No"]="Sí"
NI2=ordered(NI2,levels=names(table(NI2))[c(4,2,3,1)])

Tot1w=c(I1.sino,NI1.sino)
Tot2w=c(I2.sino,NI2.sino)
ComparOlasGl(Tot1w,Tot2w,"HPP", "No HPP")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1.sino)),as.vector(table(I2.sino)))
EENI=cbind(as.vector(table(NI1.sino)),as.vector(table(NI2.sino)))
FT=c(fisher.test(EETot,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EEI,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EENI,simulate.p.value=TRUE,B=10000)$p.value)
```


* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`



### Anomalías congénitas





```{r}
I1=Casos1w$Diagnóstico.de.malformación.ecográfica._.semana.20._
I2=Casos2w$Diagnóstico.de.malformación.ecográfica._.semana.20._
I1[I1=="No"]=0
I2[I2=="No"]=0
I1[I1=="Sí"]=1
I2[I2=="Sí"]=1
NI1=Controls1w$Diagnóstico.de.malformación.ecográfica._.semana.20._
NI2=Controls2w$Diagnóstico.de.malformación.ecográfica._.semana.20._
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
ComparOlasGl(Tot1w,Tot2w,"Anomalías congénitas", "No anomalías congénitas")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EEI,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EENI,simulate.p.value=TRUE,B=10000)$p.value)
```


* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

### Embarazos con feto muerto anteparto



```{r}
I1=Casos1w$Feto.muerto.intraútero
I1[I1=="Sí"]=1
I1[I1=="No"]=0
I2=Casos2w$Feto.muerto.intraútero
I2[I2=="Sí"]=1
I2[I2=="No"]=0
I1=factor(I1,levels=0:1)
I2=factor(I2,levels=0:1)


NI1a=Controls1w$Feto.vivo...194
NI1a[NI1a=="Sí"]=0
NI1a[NI1a=="No"]=1
NI1b=Controls1w$Feto.vivo...245
NI1b[NI1b=="Sí"]=0
NI1b[NI1b=="No"]=1
NI1=NI1a
for (i in 1:length(NI1a)){NI1[i]=max(NI1a[i],NI1b[i],na.rm=TRUE)}
NI1=factor(NI1,levels=0:1)

NI2a=Controls2w$Feto.vivo...194
NI2a[NI2a=="Sí"]=0
NI2a[NI2a=="No"]=1
NI2b=Controls2w$Feto.vivo...245
NI2b[NI2b=="Sí"]=0
NI2b[NI2b=="No"]=1
NI2=NI2a
for (i in 1:length(NI2a)){NI2[i]=max(NI2a[i],NI2b[i],na.rm=TRUE)}
NI2=factor(NI2,levels=0:1)
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)

ComparOlasGl(Tot1w,Tot2w,"Algún feto muerto anteparto", "Ningún feto muerto anteparto")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot)$p.value,fisher.test(EEI)$p.value,fisher.test(EENI)$p.value)
#FT
```


* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`


###  Inicios de parto


```{r}
I1=Casos1w$Inicio.de.parto
I2=Casos2w$Inicio.de.parto
NI1=Controls1w$Inicio.de.parto
NI1[NI1=="Cesárea programada"]="Cesárea"
NI2=Controls2w$Inicio.de.parto
NI2[NI2=="Cesárea programada"]="Cesárea"
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
n_1=length(Tot1w)
n_2=length(Tot2w)
NA_1=length(Tot1w[is.na(Tot1w)])
NA_2=length(Tot2w[is.na(Tot2w)])
EEExt=cbind(c(as.vector(table(Tot1w))[c(2,3,1)],NA_1),
            round(100*c(as.vector(table(Tot1w))[c(2,3,1)],NA_1)/n_1,1),
            c(as.vector(table(Tot2w))[c(2,3,1)],NA_2),
            round(100*c(as.vector(table(Tot2w))[c(2,3,1)],NA_2)/n_2,1)
            )
colnames(EEExt)=ColumnesOnes
rownames(EEExt)=c( "Espontáneo",   "Inducido", "Cesárea","Pérdidas")
EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")


EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(chisq.test(EETot)$p.value,chisq.test(EEI)$p.value,chisq.test(EENI)$p.value)
#FT
```






* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

#### Espontáneos

```{r}
FT=c(fisher.test(rbind(EETot[2,],colSums(EETot[-2,])))$p.value,
fisher.test(rbind(EEI[2,],colSums(EEI[-2,])))$p.value,
fisher.test(rbind(EENI[2,],colSums(EENI[-2,])))$p.value)
```



* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`



#### Inducidos

```{r}
FT=c(fisher.test(rbind(EETot[3,],colSums(EETot[-3,])))$p.value,
fisher.test(rbind(EEI[3,],colSums(EEI[-3,])))$p.value,
fisher.test(rbind(EENI[3,],colSums(EENI[-3,])))$p.value)
```



* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`


#### Cesáreas programadas

```{r}
FT=c(fisher.test(rbind(EETot[1,],colSums(EETot[-1,])))$p.value,
fisher.test(rbind(EEI[1,],colSums(EEI[-1,])))$p.value,
fisher.test(rbind(EENI[1,],colSums(EENI[-1,])))$p.value)
```



* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`



###  Tipos de parto


```{r}
I1.In=Casos1w$Inicio.de.parto
I1=Casos1w$Tipo.de.parto
I1[I1.In=="Cesárea"]="Cesárea programada"
I1[I1=="Cesárea"]="Cesárea urgente"
#table(I1)

I2.In=Casos2w$Inicio.de.parto
I2=Casos2w$Tipo.de.parto
I2[I2.In=="Cesárea"]="Cesárea programada"
I2[I2=="Cesárea"]="Cesárea urgente"
#table(I2)

NI1.In=Controls1w$Inicio.de.parto
NI1=Controls1w$Tipo.de.parto
NI1[NI1.In=="Cesárea programada"]="Cesárea programada"
NI1[NI1=="Cesárea"]="Cesárea urgente"
#table(NI1)


NI2.In=Controls2w$Inicio.de.parto
NI2=Controls2w$Tipo.de.parto
NI2[NI2.In=="Cesárea programada"]="Cesárea programada"
NI2[NI2=="Cesárea"]="Cesárea urgente"
#table(NI2)

Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
n_1=length(Tot1w)
n_2=length(Tot2w)
NA_1=length(Tot1w[is.na(Tot1w)])
NA_2=length(Tot2w[is.na(Tot2w)])
EEExt=cbind(c(as.vector(table(Tot1w))[c(3,4,1,2)],NA_1),
            round(100*c(as.vector(table(Tot1w))[c(3,4,1,2)],NA_1)/n_1,1),
            c(as.vector(table(Tot2w))[c(3,4,1,2)],NA_2),
            round(100*c(as.vector(table(Tot2w))[c(3,4,1,2)],NA_2)/n_2,1)
            )
colnames(EEExt)=ColumnesOnes
rownames(EEExt)=c("Eutócico", "Instrumental", "Cesárea programada", "Cesárea urgente", "Pérdidas")
EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")


EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(chisq.test(EETot)$p.value,chisq.test(EEI)$p.value,chisq.test(EENI)$p.value)

```




* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

#### Eutócicos

```{r}
FT=c(fisher.test(rbind(EETot[3,],colSums(EETot[-3,])))$p.value,
fisher.test(rbind(EEI[3,],colSums(EEI[-3,])))$p.value,
fisher.test(rbind(EENI[3,],colSums(EENI[-3,])))$p.value)
```


* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

#### Instrumentales

```{r}
FT=c(fisher.test(rbind(EETot[4,],colSums(EETot[-4,])))$p.value,
fisher.test(rbind(EEI[4,],colSums(EEI[-4,])))$p.value,
fisher.test(rbind(EENI[4,],colSums(EENI[-4,])))$p.value)
```


* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

#### Cesáreas urgentes

```{r}
FT=c(fisher.test(rbind(EETot[2,],colSums(EETot[-2,])))$p.value,
fisher.test(rbind(EEI[2,],colSums(EEI[-2,])))$p.value,
fisher.test(rbind(EENI[2,],colSums(EENI[-2,])))$p.value)
```


* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

### Retraso del crecimiento


```{r}
I1=Casos1w$Defecto.del.crecimiento.fetal..en.tercer.trimestre._.CIR._.
I1[I1=="No"]=0
I1[I1=="Sí"]=1
I2=Casos2w$Defecto.del.crecimiento.fetal..en.tercer.trimestre._.CIR._.
I2[I2=="No"]=0
I2[I2=="Sí"]=1
NI1=Controls1w$Defecto.del.crecimiento.fetal..en.tercer.trimestre._.CIR._.
NI2=Controls2w$Defecto.del.crecimiento.fetal..en.tercer.trimestre._.CIR._.
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
ComparOlasGl(Tot1w,Tot2w,"RCIU", "No RCIU")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EEI,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EENI,simulate.p.value=TRUE,B=10000)$p.value)
```


* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

### Ingreso materno en UCI


```{r}
I1=factor(Casos1w$UCI,levels=0:1)
I2=factor(Casos2w$UCI,levels=0:1)
NI1=factor(Controls1w$UCI...9,levels=0:1)
NI2=factor(Controls2w$UCI...9,levels=0:1)
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
ComparOlasGl(Tot1w,Tot2w,"UCI", "No UCI")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EEI,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EENI,simulate.p.value=TRUE,B=10000)$p.value)
```


* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`



### Rotura prematura de membranas


```{r}
I1=Casos1w$Bolsa.rota.anteparto
I2=Casos2w$Bolsa.rota.anteparto
NI1=Controls1w$Bolsa.rota.anteparto
NI2=Controls2w$Bolsa.rota.anteparto
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
ComparOlasGl(Tot1w,Tot2w,"RPM", "No RPM")
```

```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EEI,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EENI,simulate.p.value=TRUE,B=10000)$p.value)
```


* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`



### Ingreso neonatal en UCIN 


```{r}
I1=c(Casos1w[Casos1w$Feto.muerto.intraútero=="No",]$Ingreso.en.UCIN,Casos1wGM[Casos1wGM$Feto.vivo=="Sí",]$Ingreso.en.UCI)
I2=c(Casos2w[Casos2w$Feto.muerto.intraútero=="No",]$Ingreso.en.UCIN,Casos2wGM[Casos2wGM$Feto.vivo=="Sí",]$Ingreso.en.UCI)
NI1=c(Controls1w[Controls1w$Feto.vivo...194=="Sí",]$Ingreso.en.UCI...213,Controls1wGM[Controls1wGM$Feto.vivo...245=="Sí",]$Ingreso.en.UCI...260)
NI2=c(Controls2w[Controls2w$Feto.vivo...194=="Sí",]$Ingreso.en.UCI...213,Controls2wGM[Controls2wGM$Feto.vivo...245=="Sí",]$Ingreso.en.UCI...260)
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
n_1=length(Tot1w)
n_2=length(Tot2w)
NA_1=length(Tot1w[is.na(Tot1w)])
NA_2=length(Tot2w[is.na(Tot2w)])
EEExt=cbind(c(as.vector(table(Tot1w))[2:1],NA_1),
            round(100*c(as.vector(table(Tot1w))[2:1],NA_1)/n_1,1),
            c(as.vector(table(Tot2w))[2:1],NA_2),
            round(100*c(as.vector(table(Tot2w))[2:1],NA_2)/n_2,1)
            )
colnames(EEExt)=ColumnesOnes
rownames(EEExt)=c("UCIN", "No UCIN","Pérdidas")
EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")


EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EEI,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EENI,simulate.p.value=TRUE,B=10000)$p.value)
```


* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

### Apgar


```{r}
I1=c(Casos1w$APGAR.5...126,Casos1wGM$APGAR.5...150)
I2=c(Casos2w$APGAR.5...126,Casos2wGM$APGAR.5...150)
I2[I2==19]=NA
NI1=c(Controls1w$APGAR.5...200,Controls1wGM$APGAR.5...249)
NI2=c(Controls2w$APGAR.5...200,Controls2wGM$APGAR.5...249)

I1=cut(I1,breaks=c(-1,7,20),labels=c("0-7","8-10"))
I2=cut(I2,breaks=c(-1,7,20),labels=c("0-7","8-10"))
NI1=cut(NI1,breaks=c(-1,7,20),labels=c("0-7","8-10"))
NI2=cut(NI2,breaks=c(-1,7,20),labels=c("0-7","8-10"))
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
n_1=length(Tot1w)
n_2=length(Tot2w)
NA_1=length(Tot1w[is.na(Tot1w)])
NA_2=length(Tot2w[is.na(Tot2w)])
EEExt=cbind(c(as.vector(table(Tot1w)),NA_1),
            round(100*c(as.vector(table(Tot1w)),NA_1)/n_1,1),
            c(as.vector(table(Tot2w)),NA_2),
            round(100*c(as.vector(table(Tot2w)),NA_2)/n_2,1)
            )
colnames(EEExt)=ColumnesOnes
rownames(EEExt)=c("Apgar.5≤7", "Apgar.5≥8","Pérdidas")
EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")


EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1)),as.vector(table(I2)))
EENI=cbind(as.vector(table(NI1)),as.vector(table(NI2)))
FT=c(fisher.test(EETot,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EEI,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EENI,simulate.p.value=TRUE,B=10000)$p.value)
```


* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

### Edad gestacional al parto

```{r}
I1=Casos1w$EG_TOTAL_PARTO
I2=Casos2w$EG_TOTAL_PARTO
NI1=Controls1w$EDAD_GEST 
NI2=Controls2w$EDAD_GEST 
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
n_1=length(Tot1w)
n_2=length(Tot2w)
```


```{r}
Dades=rbind(c(round(min(Tot1w,na.rm=TRUE),1),round(max(Tot1w,na.rm=TRUE),1), round(mean(Tot1w,na.rm=TRUE),1),round(median(Tot1w,na.rm=TRUE),1),round(quantile(Tot1w,c(0.25,0.75),na.rm=TRUE),1), round(sd(Tot1w,na.rm=TRUE),1)),
            c(round(min(Tot2w,na.rm=TRUE),1),round(max(Tot2w,na.rm=TRUE),1), round(mean(Tot2w,na.rm=TRUE),1),round(median(Tot2w,na.rm=TRUE),1),round(quantile(Tot2w,c(0.25,0.75),na.rm=TRUE),1),round(sd(Tot2w,na.rm=TRUE),1)))

colnames(Dades)=c("Edad gest. mínima","Edad gest. máxima","Edad gest. media", "Edad gest. mediana", "1er cuartil", "3er cuartil", "Desv. típica")
rownames(Dades)=c("1a ola", "2a ola")

Dades %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")




```



```{r 424,fig.cap="\\s"}
data =data.frame(
  name=c( rep("1a ola",length(Tot1w)), rep("2a ola",length(Tot2w))),
  Edades=c( Tot1w,Tot2w ))


data %>%
  ggplot( aes(x=name, y=Edades, fill=name)) +
    geom_violin(width=1) +
    geom_boxplot(width=0.1, color="black", alpha=0.2,outlier.fill="black",
               outlier.size=1) +
    theme(
      legend.position="none",
      plot.title=element_text(size=11)
    ) +
    xlab("")+
  ylab("Edades gestacionales (semanas)")+
 scale_fill_manual(values=c("#CD9600", "#7CAE00"))

```


```{r}
FK=c(fligner.test(list(Tot1w, Tot2w))$p.value,fligner.test(list(I1,I2))$p.value,fligner.test(list(NI1,NI2))$p.value)
TT=c(t.test(Tot1w, Tot2w,var.equal=TRUE)$p.value,t.test(I1,I2,var.equal=TRUE)$p.value,t.test(NI1,NI2,var.equal=TRUE)$p.value)
```

* Ajuste a normal: test de Shapiro-Wilk, p-valor en la 1a ola $`r  signif(shapiro.test(Tot1w)$p.value,1)`$; p-valor en la 2a ola $`r  signif(shapiro.test(Tot2w)$p.value,1)`$.

* p-valor del test t para las edades gestacionales medias globales: p-valor `r round(TT[1],3)`


* p-valor del test t para las edades gestacionales medias de las infectadas: p-valor `r round(TT[2],3)`


* p-valor del test t para las edades gestacionales medias de las no infectadas: p-valor `r round(TT[3],3)`





### Peso de neonatos al nacimiento


```{r}
I1=c(Casos1w[Casos1w$Feto.muerto.intraútero=="No",]$Peso._gramos_...125,Casos1wGM[Casos1wGM$Feto.vivo=="Sí",]$Peso._gramos_...148)
NI1=c(Controls1w[Controls1w$Feto.vivo...194=="Sí",]$Peso._gramos_...198,Controls1wGM[Controls1wGM$Feto.vivo...245=="Sí",]$Peso._gramos_...247)
I2=c(Casos2w[Casos2w$Feto.muerto.intraútero=="No",]$Peso._gramos_...125,Casos2wGM[Casos2wGM$Feto.vivo=="Sí",]$Peso._gramos_...148)
NI2=c(Controls2w[Controls2w$Feto.vivo...194=="Sí",]$Peso._gramos_...198,Controls2wGM[Controls2wGM$Feto.vivo...245=="Sí",]$Peso._gramos_...247)
Tot1w=c(I1,NI1)
Tot2w=c(I2,NI2)
n_1=length(Tot1w)
n_2=length(Tot2w)
```


```{r}
Dades=rbind(c(round(min(Tot1w,na.rm=TRUE),1),round(max(Tot1w,na.rm=TRUE),1), round(mean(Tot1w,na.rm=TRUE),1),round(median(Tot1w,na.rm=TRUE),1),round(quantile(Tot1w,c(0.25,0.75),na.rm=TRUE),1), round(sd(Tot1w,na.rm=TRUE),1)),
            c(round(min(Tot2w,na.rm=TRUE),1),round(max(Tot2w,na.rm=TRUE),1), round(mean(Tot2w,na.rm=TRUE),1),round(median(Tot2w,na.rm=TRUE),1),round(quantile(Tot2w,c(0.25,0.75),na.rm=TRUE),1),round(sd(Tot2w,na.rm=TRUE),1)))

colnames(Dades)=c("Peso mínimo","Peso máximo","Peso medio", "Peso mediano", "1er cuartil", "3er cuartil", "Desv. típica")
rownames(Dades)=c("1a ola", "2a ola")

Dades %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")




```



```{r 425,fig.cap="\\s"}
data =data.frame(
  name=c( rep("1a ola",length(Tot1w)), rep("2a ola",length(Tot2w))),
  Pesos=c( Tot1w,Tot2w ))


data %>%
  ggplot( aes(x=name, y=Pesos, fill=name)) +
    geom_violin(width=1) +
    geom_boxplot(width=0.1, color="black", alpha=0.2,outlier.fill="black",
               outlier.size=1) +
    theme(
      legend.position="none",
      plot.title=element_text(size=11)
    ) +
    xlab("")+
  ylab("Pesos (gramos)")+
 scale_fill_manual(values=c("#CD9600", "#7CAE00"))

```


```{r}
FK=c(fligner.test(list(Tot1w, Tot2w))$p.value,fligner.test(list(I1,I2))$p.value,fligner.test(list(NI1,NI2))$p.value)
TT=c(t.test(Tot1w, Tot2w,var.equal=TRUE)$p.value,t.test(I1,I2,var.equal=TRUE)$p.value,t.test(NI1,NI2,var.equal=TRUE)$p.value)
```

* Ajuste a normal: test de Shapiro-Wilk, p-valor en la 1a ola $`r  signif(shapiro.test(Tot1w)$p.value,1)`$; p-valor en la 2a ola $`r  signif(shapiro.test(Tot2w)$p.value,1)`$.

* p-valor del test t para los pesos medios globales: p-valor `r round(TT[1],3)`


* p-valor del test t para los pesos medios de las infectadas: p-valor `r round(TT[2],3)`


* p-valor del test t para los pesos medios de las no infectadas: p-valor `r round(TT[3],3)`



```{r}
I1w=cut(I1,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)
I2w=cut(I2,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)
NI1w=cut(NI1,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)
NI2w=cut(NI2,breaks=c(0,2500,10000),labels=c(1,0),right=FALSE)

Tot1w=c(I1w,NI1w)
Tot2w=c(I2w,NI2w)

n_1w=length(Tot1w)
n_2w=length(Tot2w)
NA_1=length(Tot1w[is.na(Tot1w)])
NA_2=length(Tot2w[is.na(Tot2w)])
EEExt=cbind(c(as.vector(table(Tot1w)),NA_1),
            round(100*c(as.vector(table(Tot1w)),NA_1)/n_1w,1),
            c(as.vector(table(Tot2w)),NA_2),
            round(100*c(as.vector(table(Tot2w)),NA_2)/n_2w,1)
            )
colnames(EEExt)=ColumnesOnes
rownames(EEExt)=c("Bajo peso", "No bajo peso","Pérdidas")
EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")
```


```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1w)),as.vector(table(I2w)))
EENI=cbind(as.vector(table(NI1w)),as.vector(table(NI2w)))
FT=c(fisher.test(EETot,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EEI,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EENI,simulate.p.value=TRUE,B=10000)$p.value)
```


* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`





### Fetos muertos anteparto 

```{r}
I1w1=Casos1w$Feto.muerto.intraútero
I1w1[I1w1=="Sí"]="Muerto"
I1w1[I1w1=="No"]="Vivo"
I1w2=Casos1wGM$Feto.vivo
I1w2[I1w2=="Sí"]="Vivo"
I1w2[I1w2=="No"]="Muerto"
I1w=c(I1w1,I1w2)
n_I1wFT=length(I1w)
n_VI1w=as.vector(table(I1w))[2]

NI1w1=Controls1w$Feto.vivo...194
NI1w2=Controls1wGM$Feto.vivo...245
NI1w=c(NI1w1,NI1w2)
NI1w[NI1w=="Sí"]="Vivo"
NI1w[NI1w=="No"]="Muerto"
NI1w=factor(NI1w,levels=c("Muerto","Vivo"))
n_NI1wFT=length(NI1w)
n_VNI1w=as.vector(table(NI1w))[2]
#
#
I2w1=Casos2w$Feto.muerto.intraútero
I2w1[I2w1=="Sí"]="Muerto"
I2w1[I2w1=="No"]="Vivo"
I2w2=Casos2wGM$Feto.vivo
I2w2[I2w2=="Sí"]="Vivo"
I2w2[I2w2=="No"]="Muerto"
I2w=c(I2w1,I2w2)
n_I2wFT=length(I2w)
n_VI2w=as.vector(table(I2w))[2]

NI2w1=Controls2w$Feto.vivo...194
NI2w2=Controls2wGM$Feto.vivo...245
NI2w=c(NI2w1,NI2w2)
NI2w[NI2w=="Sí"]="Vivo"
NI2w[NI2w=="No"]="Muerto"
NI2w=factor(NI2w,levels=c("Muerto","Vivo"))
n_NI2wFT=length(NI2w)
n_VNI2w=as.vector(table(NI2w))[2]
```


```{r}
Tot1w=c(I1w,NI1w)
Tot1w[Tot1w==2]="Vivo"
Tot1w[Tot1w==1]="Muerto"

Tot2w=c(I2w,NI2w)
Tot2w[Tot2w==2]="Vivo"

n_1w=length(Tot1w)
n_2w=length(Tot2w)
NA_1=length(Tot1w[is.na(Tot1w)])
NA_2=length(Tot2w[is.na(Tot2w)])
EEExt=cbind(c(as.vector(table(Tot1w)),NA_1),
            round(100*c(as.vector(table(Tot1w)),NA_1)/n_1w,1),
            c(as.vector(table(Tot2w)),NA_2),
            round(100*c(as.vector(table(Tot2w)),NA_2)/n_2w,1)
            )
colnames(EEExt)=ColumnesOnes
rownames(EEExt)=c("Feto muerto anteparto", "Feto vivo","Pérdidas")
EEExt %>%
  kbl() %>%
  kable_styling() %>%     
  scroll_box(width="100%", box_css="border: 0px;")
```


```{r}
EETot=cbind(as.vector(table(Tot1w)),as.vector(table(Tot2w)))
EEI=cbind(as.vector(table(I1w)),as.vector(table(I2w)))
EENI=cbind(as.vector(table(NI1w)),as.vector(table(NI2w)))
FT=c(fisher.test(EETot,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EEI,simulate.p.value=TRUE,B=10000)$p.value,fisher.test(EENI,simulate.p.value=TRUE,B=10000)$p.value)
```


* p-valor del test de  Fisher global `r round(FT[1],3)`

* p-valor del test de  Fisher para infectadas `r round(FT[2],3)`

* p-valor del test de  Fisher para no infectadas `r round(FT[3],3)`

